<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.2">Jekyll</generator><link href="https://mafulong.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://mafulong.github.io/" rel="alternate" type="text/html" /><updated>2025-07-13T22:05:00+08:00</updated><id>https://mafulong.github.io/feed.xml</id><title type="html">Fulongã®blog</title><subtitle>Fulongã®blog</subtitle><author><name>Fulong Ma</name></author><entry><title type="html">ä»¥å¤ªåŠæŠ€æœ¯</title><link href="https://mafulong.github.io/2025/07/13/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%8A%80%E6%9C%AF/" rel="alternate" type="text/html" title="ä»¥å¤ªåŠæŠ€æœ¯" /><published>2025-07-13T00:00:00+08:00</published><updated>2025-07-13T00:00:00+08:00</updated><id>https://mafulong.github.io/2025/07/13/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%8A%80%E6%9C%AF</id><content type="html" xml:base="https://mafulong.github.io/2025/07/13/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%8A%80%E6%9C%AF/">&lt;h2 id=&quot;ä»¥å¤ªåŠæŠ€æœ¯&quot;&gt;ä»¥å¤ªåŠæŠ€æœ¯&lt;/h2&gt;

&lt;h2 id=&quot;ä»¥å¤ªåŠ&quot;&gt;ä»¥å¤ªåŠ&lt;/h2&gt;

&lt;p&gt;ä»¥å¤ªåŠï¼ˆEthereumï¼‰æ˜¯ä¸€ä¸ªæ”¯æŒæ™ºèƒ½åˆçº¦çš„åŒºå—é“¾å¹³å°ï¼Œå®ƒä¸æ¯”ç‰¹å¸æœ€å¤§çš„ä¸åŒæ˜¯ï¼Œä»¥å¤ªåŠé€šè¿‡ä¸€ä¸ªè™šæ‹Ÿæœºï¼ˆEVMï¼‰å¯ä»¥è¿è¡Œæ™ºèƒ½åˆçº¦ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥å¤ªåŠæ˜¯&lt;a href=&quot;https://vitalik.ca/&quot;&gt;Vitalik Buterin&lt;/a&gt;ï¼ˆç»´å¡”åˆ©å…‹Â·å¸ƒç‰¹æ—ï¼Œäººç§°Vç¥ï¼‰åœ¨2013å¹´æå‡ºçš„æ¦‚å¿µï¼ŒVitalikæœ€æ—©å‚ä¸äº†æ¯”ç‰¹å¸ç¤¾åŒºçš„å¼€å‘ï¼Œå¹¶å¸Œæœ›æ¯”ç‰¹å¸æŠŠåŠŸèƒ½å—é™çš„è„šæœ¬æ‰©å±•æˆå›¾çµå®Œå…¨çš„ç¼–ç¨‹ç¯å¢ƒï¼Œä½†æ²¡æœ‰å¾—åˆ°æ¯”ç‰¹å¸å¼€å‘ç¤¾åŒºçš„è®¤åŒï¼Œäºæ˜¯ä»–å†³å®šå¦èµ·ç‚‰ç¶ï¼Œæ‰“é€ ä¸€ä¸ªæ–°çš„åŒºå—é“¾å¹³å°ï¼Œç›®æ ‡æ˜¯è¿è¡Œå»ä¸­å¿ƒåŒ–çš„ç¨‹åºã€‚&lt;/p&gt;

&lt;p&gt;ä»¥å¤ªåŠä»2015å¹´æ­£å¼å¯åŠ¨å¹¶è¿è¡Œï¼ŒæœŸé—´ç»å†è¿‡DAOæ”»å‡»é€ æˆçš„ç¡¬åˆ†å‰ã€‚å’Œæ¯”ç‰¹å¸ç±»ä¼¼ï¼Œä»¥å¤ªåŠä¹Ÿé€šè¿‡PoWè¿›è¡ŒæŒ–çŸ¿ï¼Œåæ”¹ä¸ºPoSæŒ–çŸ¿ï¼Œå…¶æŒ–å‡ºçš„å¹³å°å¸å«ä»¥å¤ªå¸ï¼ˆEtherï¼‰ï¼Œç›®å‰æ¯ä¸ªåŒºå—å¥–åŠ±æ˜¯2 Etherï¼Œçº¦13~15ç§’å·¦å³å‡ºä¸€ä¸ªå—ã€‚&lt;/p&gt;

&lt;p&gt;å’Œæ¯”ç‰¹å¸ç›¸æ¯”ï¼Œä»¥å¤ªåŠåœ¨ä»¥ä¸‹å‡ ç‚¹ä¸Šæœ‰æ‰€ä¸åŒï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;è´¦æˆ·æ¨¡å‹&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸ä½¿ç”¨çš„&lt;a href=&quot;https://liaoxuefeng.com/books/blockchain/bitcoin/utxo/index.html&quot;&gt;UTXOæ¨¡å‹&lt;/a&gt;æ˜¯ä¸€ç§å¯¹å¼€å‘å‹å¥½ã€æ˜“äºå®ç°æ¸…ç»“ç®—çš„æ¨¡å‹ï¼Œä½†å¯¹ç”¨æˆ·ä¸å‹å¥½ï¼Œå› ä¸ºæ™®é€šç”¨æˆ·æ‰€è®¤çŸ¥çš„è´¦æˆ·æ˜¯ä¸€ä¸ªè´¦å·ã€å¯¹åº”ä½™é¢å˜åŠ¨çš„æ¨¡å‹ã€‚ä»¥å¤ªåŠçš„è´¦æˆ·æ¨¡å‹å’Œæ¯”ç‰¹å¸ä¸åŒï¼Œå®ƒå°±æ˜¯ä½™é¢æ¨¡å‹ï¼Œå³äº¤æ˜“å¼•å‘è´¦æˆ·ä½™é¢çš„å˜åŠ¨ï¼Œè¿™ä¸ä¼ ç»Ÿé‡‘èè´¦æˆ·ä¸€è‡´ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æ™ºèƒ½åˆçº¦&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä»æ¯”ç‰¹å¸çš„&lt;a href=&quot;https://liaoxuefeng.com/books/blockchain/bitcoin/pay/index.html&quot;&gt;å¯ç¼–ç¨‹æ”¯ä»˜åŸç†&lt;/a&gt;å¯çŸ¥ï¼Œä»»ä½•æ”¯ä»˜å®é™…ä¸Šéƒ½æ˜¯åœ¨æ‰§è¡Œæ¯”ç‰¹å¸è„šæœ¬ï¼Œåªæœ‰è„šæœ¬æˆåŠŸæ‰§è¡Œï¼Œæ”¯ä»˜æ‰èƒ½æˆåŠŸã€‚&lt;/p&gt;

&lt;p&gt;ä»¥å¤ªåŠçš„äº¤æ˜“ä¸ä¹‹ç±»ä¼¼ï¼Œå¹¶ä¸”æ›´è¿›ä¸€æ­¥ï¼Œå®ƒå®ç°äº†ä¸€ä¸ªå›¾çµå®Œå¤‡çš„è„šæœ¬è¯­è¨€ï¼Œè¿è¡Œåœ¨EVMï¼ˆEthereum Virtual Machineï¼Œä»¥å¤ªåŠè™šæ‹Ÿæœºï¼‰ä¸­ï¼Œä»»ä½•äººéƒ½å¯ä»¥ç¼–å†™åˆæ³•çš„è„šæœ¬æ¥æ‰§è¡Œä»»æ„é€»è¾‘ï¼ˆæœ‰å¾ˆå¤šé™åˆ¶ï¼‰ï¼Œä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ç§æ–°çš„ä»£å¸ï¼ŒæŠµæŠ¼è´·æ¬¾ç­‰ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;è´¦æˆ·&quot;&gt;è´¦æˆ·&lt;/h2&gt;

&lt;p&gt;ä»¥å¤ªåŠè´¦æˆ·è´Ÿè´£å­˜å‚¨ç”¨æˆ·çš„ä»¥å¤ªåŠä½™é¢ã€‚å¯¹å¤§å¤šæ•°æ™®é€šç”¨æˆ·æ¥è¯´ï¼Œä»¥å¤ªåŠè´¦æˆ·å’Œé“¶è¡Œè´¦æˆ·éå¸¸ç±»ä¼¼ï¼Œé€šå¸¸åªéœ€è¦ä¸€ä¸ªè´¦æˆ·å³å¯ã€‚&lt;/p&gt;

&lt;p&gt;ç¡®åˆ‡åœ°è¯´ï¼Œä»¥å¤ªåŠè´¦æˆ·åˆ†ä¸ºå¤–éƒ¨è´¦æˆ·å’Œåˆçº¦è´¦æˆ·ä¸¤ç±»ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¤–éƒ¨è´¦æˆ·ï¼šå³æ™®é€šç”¨æˆ·ç”¨ç§é’¥æ§åˆ¶çš„è´¦æˆ·ï¼›&lt;/li&gt;
  &lt;li&gt;åˆçº¦è´¦æˆ·ï¼šä¸€ç§æ‹¥æœ‰åˆçº¦ä»£ç çš„è´¦æˆ·ï¼Œå®ƒä¸å±äºä»»ä½•äººï¼Œä¹Ÿæ²¡æœ‰ç§é’¥ä¸ä¹‹å¯¹åº”ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æœ¬èŠ‚æˆ‘ä»¬ä»…è®¨è®ºæ™®é€šç”¨æˆ·ä½¿ç”¨çš„å¤–éƒ¨è´¦æˆ·ã€‚&lt;/p&gt;

&lt;p&gt;å’Œæ¯”ç‰¹å¸ç±»ä¼¼ï¼Œä¸€ä¸ªä»¥å¤ªåŠè´¦æˆ·å°±æ˜¯ä¸€ä¸ªå…¬é’¥å“ˆå¸Œåå¾—åˆ°çš„åœ°å€ï¼Œå®ƒæ˜¯ç”±ä¸€ä¸ªç§é’¥æ¨å¯¼å‡ºå¯¹åº”çš„å…¬é’¥ï¼Œç„¶åå†è®¡ç®—å‡ºåœ°å€ã€‚å…¶ä¸­ï¼Œç§é’¥ä¸å…¬é’¥ç®—æ³•ä¸æ¯”ç‰¹å¸å®Œå…¨ç›¸åŒï¼Œå‡ä¸ºsecp256k1æ¤­åœ†æ›²çº¿ï¼Œä½†å’Œæ¯”ç‰¹å¸ä¸åŒçš„æ˜¯ï¼Œä»¥å¤ªåŠé‡‡ç”¨éå‹ç¼©å…¬é’¥ï¼Œç„¶åç›´æ¥å¯¹å…¬é’¥åškeccak256å“ˆå¸Œï¼Œå¾—åˆ°32å­—èŠ‚çš„å“ˆå¸Œå€¼ï¼Œå–å20å­—èŠ‚åŠ ä¸Š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x&lt;/code&gt;å‰ç¼€å³ä¸ºåœ°å€&lt;/p&gt;

&lt;p&gt;å› ä¸ºä»¥å¤ªåŠå’Œæ¯”ç‰¹å¸çš„éå¯¹ç§°åŠ å¯†ç®—æ³•æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œä¸åŒçš„ä»…ä»…æ˜¯å…¬é’¥å’Œåœ°å€çš„è¡¨ç¤ºæ ¼å¼ï¼Œå› æ­¤ï¼Œæ¯”ç‰¹å¸çš„HDé’±åŒ…ä½“ç³»ä¹Ÿå®Œå…¨é€‚ç”¨äºä»¥å¤ªåŠã€‚ç”¨æˆ·é€šè¿‡ä¸€å¥—åŠ©è®°è¯ï¼Œæ—¢å¯ä»¥ç®¡ç†æ¯”ç‰¹å¸é’±åŒ…ï¼Œä¹Ÿå¯ä»¥ç®¡ç†ä»¥å¤ªåŠé’±åŒ…ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥å¤ªåŠé’±åŒ…çš„æ´¾ç”Ÿè·¯å¾„æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/44&apos;/60&apos;/0&apos;/0/0&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å› ä¸ºä»¥å¤ªåŠé‡‡ç”¨è´¦æˆ·ä½™é¢æ¨¡å‹ï¼Œé€šå¸¸æƒ…å†µä¸‹ä¸€ä¸ªä»¥å¤ªåŠåœ°å€å·²å¤Ÿç”¨ã€‚å¦‚æœè¦ç”Ÿæˆå¤šä¸ªåœ°å€ï¼Œå¯ç»§ç»­æ´¾ç”Ÿ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/44&apos;/60&apos;/0&apos;/0/1&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/44&apos;/60&apos;/0&apos;/0/2&lt;/code&gt;ç­‰ã€‚&lt;/p&gt;

&lt;h2 id=&quot;åŒºå—ç»“æ„&quot;&gt;åŒºå—ç»“æ„&lt;/h2&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„åŒºå—é“¾æ˜¯ç”±PoWä¿è¯æ¯ä¸ªåŒºå—éƒ½æŒ‡å‘å‰ä¸€ä¸ªåŒºå—ï¼Œè€Œåœ¨æ¯ä¸€ä¸ªåŒºå—å†…éƒ¨ï¼Œç”±ä¸€ä¸ªç‹¬ç«‹çš„Merkle Treeæ¥ä¿è¯æ‰€æœ‰äº¤æ˜“çš„ä¸å¯ç¯¡æ”¹ã€‚ç”¨æˆ·çš„æ¯”ç‰¹å¸æ˜¯ä»¥UTXOçš„æ–¹å¼å­˜å‚¨çš„ï¼Œå› æ­¤ï¼Œæ¯”ç‰¹å¸çš„äº¤æ˜“å°±æ˜¯ä¸æ–­åœ°æ¶ˆè€—ç°æœ‰çš„UTXOï¼Œå¹¶äº§ç”Ÿæ–°çš„UTXOã€‚&lt;/p&gt;

&lt;p&gt;è€Œä»¥å¤ªåŠé‡‡ç”¨çš„æ˜¯è´¦æˆ·æ¨¡å‹ï¼Œå¦‚æœå°æ˜çš„è´¦æˆ·åœ¨æŸä¸ªåŒºå—çš„èµ„äº§æ˜¯1 ETHï¼Œå½“å°æ˜ç»™å°çº¢è½¬è´¦0.2 ETHåï¼Œåˆ¨é™¤æ‰‹ç»­è´¹ï¼Œä»–çš„è´¦æˆ·è¿˜å‰©ä¸‹çº¦0.8 ETHã€‚ç”±äºå°æ˜çš„è´¦æˆ·åœ°å€ä¸å˜ï¼Œæ‰€ä»¥ï¼Œä»¥å¤ªåŠçš„åŒºå—ç»“æ„å¿…é¡»èƒ½åœ¨æ¯ä¸ªåŒºå—æŒç»­åœ°è·Ÿè¸ªå¹¶è®°å½•å°æ˜çš„è´¦æˆ·ä½™é¢å˜åŠ¨ã€‚å› æ­¤ï¼Œå’Œæ¯”ç‰¹å¸ç›¸æ¯”ï¼Œä»¥å¤ªåŠçš„åŒºå—æ•°æ®ç»“æ„æ›´åŠ å¤æ‚ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ä»¥å¤ªåŠçš„æ ¸å¿ƒæ•°æ®ç»“æ„æ˜¯ä»¥Merkle Patricia Treeè®°å½•çš„ä¸–ç•ŒçŠ¶æ€ï¼Œæ¯ä¸ªåŒºå—é€šè¿‡æ‰“åŒ…æ–°çš„äº¤æ˜“ï¼Œä»è€Œå¯¼è‡´ä¸–ç•ŒçŠ¶æ€çš„å˜åŒ–ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;h3 id=&quot;merkle-patricia-tree&quot;&gt;Merkle Patricia Tree&lt;/h3&gt;

&lt;p&gt;ä»¥å¤ªåŠå­˜å‚¨è´¦æˆ·æ•°æ®çš„æ•°æ®ç»“æ„æ˜¯MPTï¼šMerkle Patricia Treeï¼Œå®ƒæ˜¯ä¸€ç§æ”¹è¿›çš„Merkle Treeã€‚å½“MPTçš„æ¯ä¸ªå¶å­ç»“ç‚¹çš„å€¼ç¡®å®šåï¼Œè®¡ç®—å‡ºçš„Root Hashå°±æ˜¯å®Œå…¨ç¡®å®šçš„ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¬¬ä¸€ä¸ªåŒºå—ä¸­ï¼Œ4ä¸ªè´¦æˆ·çš„ä½™é¢ç¡®å®šåï¼Œå³å¯ç¡®å®š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Root1&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;â”Œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”
           Root1
â”‚          â”Œâ”€â”€â”€â”          â”‚
           â”‚   â”‚
â”‚          â””â”€â”€â”€â”˜          â”‚
             â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”      â”‚
       â”‚           â”‚
â”‚    â”Œâ”€â”€â”€â”       â”Œâ”€â”€â”€â”    â”‚
     â”‚   â”‚       â”‚   â”‚
â”‚    â””â”€â”€â”€â”˜       â””â”€â”€â”€â”˜    â”‚
       â”‚           â”‚
â”‚   â”Œâ”€â”€â”´â”€â”€â”     â”Œâ”€â”€â”´â”€â”€â”   â”‚
    â”‚     â”‚     â”‚     â”‚
â”‚ â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”‚
  â”‚5.5â”‚ â”‚0.2â”‚ â”‚1.7â”‚ â”‚9.0â”‚
â”‚ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â”‚
 â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ç¬¬äºŒä¸ªåŒºå—ä¸­ï¼Œå¦‚æœå‘ç”Ÿäº†è½¬è´¦ï¼Œå°†è®¡ç®—å‡ºä¸€ä¸ªæ–°çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Root2&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æ¯ä¸€ä¸ªåŒºå—é€šè¿‡Root Hashå°†å®Œå…¨ç¡®å®šæ‰€æœ‰è´¦æˆ·çš„çŠ¶æ€ï¼Œæ‰€ä»¥ï¼Œä»å…¨å±€çœ‹ï¼Œä»¥å¤ªåŠå°±æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œæ¯ä¸ªåŒºå—é€šè¿‡è®°å½•ä¸€ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;stateRoot&lt;/code&gt;æ¥è¡¨ç¤ºä¸€ä¸ªæ–°çŠ¶æ€ã€‚å¦‚æœç»™å®šæŸä¸ªåŒºå—çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;stateRoot&lt;/code&gt;ï¼Œæˆ‘ä»¬è‚¯å®šèƒ½å®Œå…¨ç¡®å®šæ‰€æœ‰è´¦æˆ·çš„æ‰€æœ‰ä½™é¢ç­‰ä¿¡æ¯ã€‚å› æ­¤ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;stateRoot&lt;/code&gt;å°±è¢«ç§°ä¸ºå½“å‰çš„ä¸–ç•ŒçŠ¶æ€ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰çš„åŒå­¦å¯èƒ½ä¼šæ€è€ƒï¼Œå¦‚æœç¬¬ä¸€ä¸ªåŒºå—åªæœ‰å‡ ä¸ªè´¦æˆ·ï¼Œéšç€è´¦æˆ·çš„å¢åŠ ï¼Œå¦‚æœæœ‰æ•°ç™¾ä¸‡ä¸ªè´¦æˆ·ï¼Œåˆ°åé¢å²‚ä¸æ˜¯åŒºå—å­˜å‚¨çš„æ•°æ®é‡ä¼šè¶Šæ¥è¶Šå¤§ï¼Ÿ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å®é™…ä¸Šï¼Œæ¯ä¸ªåŒºå—çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;stateRoot&lt;/code&gt;è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªå®Œå…¨çŠ¶æ€çš„é€»è¾‘æ ‘ï¼Œä½†æ¯ä¸ªåŒºå—è®°å½•çš„æ•°æ®åªåŒ…æ‹¬ä¿®æ”¹çš„éƒ¨åˆ†ï¼Œå¦‚æœæˆ‘ä»¬è§‚å¯Ÿç¬¬äºŒä¸ªåŒºå—çš„æ ‘ï¼Œå®ƒå®é™…ä¸Šåªè®°å½•ä¿®æ”¹çš„ä¸¤ä¸ªè´¦æˆ·ï¼Œä»¥åŠä¸¤ä¸ªè´¦æˆ·å› ä¿®æ”¹åå¯¼è‡´çš„ä¸Šå±‚è·¯å¾„çš„Hashå‘ç”Ÿçš„å˜åŒ–&lt;/strong&gt;&lt;/p&gt;

&lt;h3 id=&quot;è´¦æˆ·æ•°æ®&quot;&gt;è´¦æˆ·æ•°æ®&lt;/h3&gt;

&lt;p&gt;ä¸€ä¸ªä»¥å¤ªåŠè´¦æˆ·ç”±4éƒ¨åˆ†æ•°æ®æ„æˆï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;nonce&lt;/li&gt;
  &lt;li&gt;balance&lt;/li&gt;
  &lt;li&gt;storageRoot&lt;/li&gt;
  &lt;li&gt;codeHash&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…¶ä¸­ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nonce&lt;/code&gt;æ˜¯ä¸€ä¸ªé€’å¢çš„æ•´æ•°ï¼Œæ¯å‘é€ä¸€æ¬¡äº¤æ˜“ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nonce&lt;/code&gt;é€’å¢&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1&lt;/code&gt;ï¼Œå› æ­¤ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nonce&lt;/code&gt;è®°å½•çš„å°±æ˜¯äº¤æ˜“æ¬¡æ•°ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;balance&lt;/code&gt;è®°å½•çš„å°±æ˜¯è´¦æˆ·ä½™é¢ï¼Œä»¥&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;wei&lt;/code&gt;ä¸ºå•ä½ï¼Œ1 Etherç­‰äº1018weiã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä¸€ä¸ªè´¦æˆ·æ˜¯åˆçº¦è´¦æˆ·ï¼Œåˆ™&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;storageRoot&lt;/code&gt;å­˜å‚¨åˆçº¦ç›¸å…³çš„çŠ¶æ€æ•°æ®ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;codeHash&lt;/code&gt;å­˜å‚¨åˆçº¦ä»£ç çš„Hashã€‚å¯¹äºå¤–éƒ¨è´¦æˆ·ï¼Œè¿™ä¸¤éƒ¨åˆ†æ•°æ®éƒ½æ˜¯ç©ºã€‚&lt;/p&gt;

&lt;h3 id=&quot;äº¤æ˜“&quot;&gt;äº¤æ˜“&lt;/h3&gt;

&lt;p&gt;ä»¥å¤ªåŠçš„äº¤æ˜“éœ€è¦æ¶ˆè€—Gasï¼Œè€ŒGasä»·æ ¼å’Œå®é™…æ¶ˆè€—çš„æ•°é‡å†³å®šäº†ä¸€ä¸ªäº¤æ˜“å®é™…æ¶ˆè€—çš„Etherï¼Œå³äº¤æ˜“æˆæœ¬ã€‚&lt;/p&gt;

&lt;p&gt;åˆçº¦äº¤æ˜“æ— æ³•ç²¾ç¡®åœ°ç¡®å®šGasæ•°é‡ï¼Œåªèƒ½é¢„ä¼°å¹¶ç»™å‡ºGas Limitã€‚&lt;/p&gt;

&lt;h4 id=&quot;åŸºæœ¬æµç¨‹&quot;&gt;åŸºæœ¬æµç¨‹&lt;/h4&gt;

&lt;p&gt;åœ¨æ¯”ç‰¹å¸ä¸­ï¼Œäº¤æ˜“å°±æ˜¯æ¶ˆè€—å·²æœ‰UTXOï¼Œå¹¶é€šè¿‡æ‰§è¡Œè„šæœ¬äº§ç”Ÿæ–°çš„UTXOï¼Œå…¶ä¸­éšå«çš„æ–°æ—§å·®é¢å³ä¸ºçŸ¿å·¥æ‰‹ç»­è´¹ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ä»¥å¤ªåŠä¸­ï¼Œäº¤æ˜“ä¹Ÿéœ€è¦æ‰‹ç»­è´¹ï¼Œæ‰‹ç»­è´¹è¢«ç§°ä¸ºGasï¼ˆæ±½æ²¹ï¼‰ï¼Œå®ƒçš„è®¡ç®—æ¯”æ¯”ç‰¹å¸è¦å¤æ‚å¾—å¤šã€‚&lt;/p&gt;

&lt;p&gt;ä»¥å¤ªåŠé™¤äº†æœ€åŸºæœ¬çš„è½¬è´¦ï¼šå³ä»ä¸€ä¸ªè´¦æˆ·æ”¯ä»˜Etheråˆ°å¦ä¸€ä¸ªè´¦æˆ·ï¼Œè¿˜æ”¯æŒæ‰§è¡Œåˆçº¦ä»£ç ã€‚åˆçº¦ä»£ç æ˜¯å›¾çµå®Œå¤‡çš„ç¼–ç¨‹è¯­è¨€ï¼Œé€šè¿‡EVMï¼ˆä»¥å¤ªåŠè™šæ‹Ÿæœºï¼‰æ‰§è¡Œã€‚å¦‚æœæŸä¸ªåˆçº¦ç¼–å†™äº†ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œé‚£ä¹ˆæ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œè¯¥åˆçº¦ä»£ç ï¼Œå²‚ä¸æ˜¯æ°¸è¿œæ— æ³•ç»“æŸï¼Ÿ&lt;/p&gt;

&lt;p&gt;ä¸ºäº†ä¿è¯åˆçº¦ä»£ç çš„å¯é æ‰§è¡Œï¼Œä»¥å¤ªåŠç»™æ¯ä¸€ä¸ªè™šæ‹ŸæœºæŒ‡ä»¤éƒ½æ ‡è®°äº†ä¸€ä¸ªGasåŸºæœ¬è´¹ç”¨ï¼Œç§°ä¸ºgasUsedã€‚ä¾‹å¦‚ï¼ŒåŠ å‡è®¡ç®—çš„è´¹ç”¨æ˜¯3ï¼Œè®¡ç®—SHA3çš„è´¹ç”¨æ˜¯30ï¼Œè¾“å‡ºæ—¥å¿—çš„è´¹ç”¨æ˜¯375ï¼Œå†™å…¥å­˜å‚¨çš„è´¹ç”¨é«˜è¾¾20000ã€‚æ€»çš„æ¥è¯´ï¼Œæ¶ˆè€—CPUæ¯”æ¶ˆè€—å­˜å‚¨ä¾¿å®œï¼Œç®€å•è®¡ç®—æ¯”å¤æ‚è®¡ç®—ä¾¿å®œï¼Œè¯»å–æ¯”å†™å…¥ä¾¿å®œã€‚&lt;/p&gt;

&lt;p&gt;é™¤äº†gasUsedå¤–ï¼Œç”¨æˆ·è¿˜éœ€è¦æä¾›ä¸€ä¸ªgasPriceï¼Œä»¥Gweiï¼ˆ1Gwei=109Weiï¼‰ä¸ºå•ä½ã€‚é€šè¿‡ç«ä»·å¾—åˆ°ä¸€ä¸ªçŸ¿å·¥æ„¿æ„æ¥å—çš„gasPriceã€‚å¦‚æœä¸€ä¸ªäº¤æ˜“æ¶ˆè€—äº†120000çš„gasUsedï¼Œè€ŒgasPriceæ˜¯50 Gweiï¼Œåˆ™äº¤æ˜“è´¹ç”¨æ˜¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-plain&quot;&gt;120000 x 50 Gwei = 6000000 Gwei = 0.006 Ether
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½†æ˜¯åœ¨æ‰§è¡Œä»£ç çš„æ—¶å€™ï¼Œå­˜åœ¨æ¡ä»¶åˆ¤æ–­ã€å¾ªç¯ç­‰è¯­å¥ï¼ŒåŒä¸€æ®µä»£ç ï¼Œæ‰§è¡Œçš„ç»“æœä¹Ÿå¯èƒ½ä¸åŒï¼Œå› æ­¤ï¼Œäº‹å‰é¢„è®¡ä¸€ä¸ªåˆçº¦æ‰§è¡Œè¦èŠ±è´¹å¤šå°‘Gasï¼Œä¸ç°å®ã€‚&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ä»¥å¤ªåŠè§„å®šï¼Œä¸€ç¬”äº¤æ˜“ï¼Œå…ˆç»™å‡ºgasPriceå’ŒgasLimitï¼Œå¦‚æœæ‰§è¡Œå®Œæˆåæœ‰å‰©ä½™ï¼Œå‰©ä½™çš„é€€è¿˜ï¼Œå¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­æ¶ˆè€—æ®†å°½ï¼Œé‚£ä¹ˆäº¤æ˜“æ‰§è¡Œå¤±è´¥ï¼Œä½†å·²æ‰§è¡Œçš„Gasä¸ä¼šé€€ã€‚&lt;/p&gt;

&lt;p&gt;å¤ªå¤æ‚äº†æ˜¯ä¸æ˜¯ï¼Ÿæˆ‘ä»¬è¿˜æ˜¯ä¸¾ä¸ªä¾‹å­ã€‚&lt;/p&gt;

&lt;p&gt;å‡å®šæŸä¸ªè´¦æˆ·æƒ³æ‰§è¡Œä¸€ç¬”äº¤æ˜“ï¼Œä»–ç»™å‡ºgasPriceä¸º50 Gweiï¼Œé¢„ä¼°gasUsedçº¦120000ï¼Œè®¾å®šgasLimitä¸º150000ï¼Œåˆ™é¢„æ”¯ä»˜çš„Etherä¸ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-plain&quot;&gt;150000 x 50 Gwei = 7500000 Gwei = 0.0075 Ether
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æœè´¦æˆ·çš„Etherä½™é¢ä¸è¶³0.0075ï¼Œåˆ™è¯¥äº¤æ˜“æ ¹æœ¬æ— æ³•å‘é€ã€‚å¦‚æœè´¦æˆ·ä½™é¢ç­‰äºæˆ–è¶…è¿‡0.0075ï¼Œä¾‹å¦‚ä½™é¢ä¸º0.008ï¼Œåˆ™çŸ¿å·¥å¯ä»¥å°†è¯¥äº¤æ˜“æ‰“åŒ…ã€‚å‡è®¾å®é™…æ‰§è¡Œæ¶ˆè€—çš„gasUsedä¸º120000ï¼Œåˆ™äº¤æ˜“è´¹ç”¨0.006ï¼Œè´¦æˆ·å‰©ä½™0.002ã€‚&lt;/p&gt;

&lt;p&gt;å¾ˆå°‘æœ‰äº¤æ˜“èƒ½å‡†ç¡®é¢„ä¼°gasUsedï¼Œåªæœ‰æ ‡å‡†è½¬è´¦äº¤æ˜“æ˜¯21000ï¼Œå› æ­¤ï¼Œæ ‡å‡†çš„è½¬è´¦äº¤æ˜“gasLimitå¯ä»¥è®¾ç½®ä¸º21000ï¼ˆå³æ°å¥½æ¶ˆè€—å®Œæ¯•æ— å‰©ä½™ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;Gas Priceæ˜¯å…¨ç½‘ç”¨æˆ·ç«ä»·äº§ç”Ÿçš„ï¼Œå®ƒæ—¶åˆ»åœ¨æ³¢åŠ¨ã€‚å¦‚æœäº¤æ˜“å°‘ï¼ŒGas Priceå°†ä¸‹é™ï¼Œå¦‚æœäº¤æ˜“å¤šï¼Œç½‘ç»œæ‹¥å µï¼Œåˆ™Gas Priceå°†ä¸Šå‡ã€‚ä»¥å¤ªåŠçš„Gasä»·æ ¼å¯ä»¥åœ¨&lt;a href=&quot;https://etherscan.io/gastracker&quot;&gt;Etherscan&lt;/a&gt;è·Ÿè¸ªã€‚&lt;/p&gt;

&lt;h4 id=&quot;äº¤æ˜“å›æ‰§&quot;&gt;äº¤æ˜“å›æ‰§&lt;/h4&gt;

&lt;p&gt;ä»¥å¤ªåŠåŒºå—ä¸ºæ¯ä¸€ç¬”äº¤æ˜“éƒ½ä¼šäº§ç”Ÿä¸€ç¬”å›æ‰§ï¼ˆReciptï¼‰ï¼Œè¡¨ç¤ºäº¤æ˜“çš„æœ€ç»ˆçŠ¶æ€ã€‚ä¸€ä¸ªå›æ‰§ä¿¡æ¯ä¸»è¦åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;statusï¼šæ‰§è¡Œç»“æœï¼Œ1è¡¨ç¤ºæˆåŠŸï¼Œ0è¡¨ç¤ºå¤±è´¥ï¼›&lt;/li&gt;
  &lt;li&gt;gasUsedï¼šå·²æ¶ˆè€—çš„Gasæ•°é‡ï¼›&lt;/li&gt;
  &lt;li&gt;txHashï¼šäº¤æ˜“Hashï¼›&lt;/li&gt;
  &lt;li&gt;logsï¼šäº¤æ˜“äº§ç”Ÿçš„æ—¥å¿—ï¼›&lt;/li&gt;
  &lt;li&gt;â€¦â€¦&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;è½¬è´¦äº¤æ˜“&quot;&gt;è½¬è´¦äº¤æ˜“&lt;/h4&gt;

&lt;p&gt;è½¬è´¦äº¤æ˜“æ˜¯æŒ‡ä¸¤ä¸ªå¤–éƒ¨è´¦å·è½¬ç§»Etherï¼Œæˆ‘ä»¬ä»¥äº¤æ˜“&lt;a href=&quot;https://etherscan.io/tx/0xb94087cdaa291e595ba02e846864cb9f5b681ca10efe2a91eb626d11101c4ad7&quot;&gt;0xb940â€¦4ad7&lt;/a&gt;ä¸ºä¾‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Transaction Hash: 0xb940â€¦4ad7ï¼Œè¿™æ˜¯äº¤æ˜“Hashï¼Œå³äº¤æ˜“çš„å”¯ä¸€æ ‡è¯†ï¼›&lt;/li&gt;
  &lt;li&gt;Status: Successï¼Œè¡¨ç¤ºäº¤æ˜“æˆåŠŸï¼›&lt;/li&gt;
  &lt;li&gt;From: 0x0FFfâ€¦bBc4ï¼Œäº¤æ˜“çš„å‘é€æ–¹ï¼›&lt;/li&gt;
  &lt;li&gt;To: 0x5b2aâ€¦5a46ï¼Œäº¤æ˜“çš„æ¥æ”¶æ–¹ï¼›&lt;/li&gt;
  &lt;li&gt;Value: 1.6912 Etherï¼Œäº¤æ˜“å‘é€çš„Etherï¼›&lt;/li&gt;
  &lt;li&gt;Gas Price: 82 Gweiï¼ŒGasçš„ä»·æ ¼ï¼›&lt;/li&gt;
  &lt;li&gt;Gas Limit: 21,000ï¼Œè½¬è´¦äº¤æ˜“æ°å¥½æ¶ˆè€—21000Gasï¼Œå› æ­¤æ€»æ˜¯21000ï¼›&lt;/li&gt;
  &lt;li&gt;Usage by Txn: 21,000 (100%)ï¼Œæ¶ˆè€—çš„Gaså æ¯”ï¼Œè¿™é‡Œæ°å¥½å…¨éƒ¨æ¶ˆè€—å®Œï¼›&lt;/li&gt;
  &lt;li&gt;Nonceï¼š0ï¼Œå‘é€æ–¹çš„nonceï¼Œ0è¡¨ç¤ºç¬¬1ç¬”äº¤æ˜“ï¼›&lt;/li&gt;
  &lt;li&gt;Input Data: 0xï¼Œå› ä¸ºæ˜¯è½¬è´¦äº¤æ˜“ï¼Œæ²¡æœ‰è¾“å…¥æ•°æ®ï¼Œå› æ­¤ä¸ºç©ºã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;åˆçº¦äº¤æ˜“&quot;&gt;åˆçº¦äº¤æ˜“&lt;/h4&gt;

&lt;p&gt;åˆçº¦äº¤æ˜“å°±æ˜¯æŒ‡ä¸€ä¸ªå¤–éƒ¨è´¦å·è°ƒç”¨æŸä¸ªåˆçº¦çš„æŸä¸ªpublicå‡½æ•°ã€‚æˆ‘ä»¬ä»¥äº¤æ˜“&lt;a href=&quot;https://etherscan.io/tx/0x8affd7588219529b5b4652abd4bd9a2ad5b7aec1490d62ca359ae56a6c3c8cd0&quot;&gt;0x8affâ€¦8cd0&lt;/a&gt;ä¸ºä¾‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;From: 0x2329â€¦BA3aï¼Œäº¤æ˜“çš„å‘èµ·æ–¹ï¼Œè¯¥åœ°å€ä¸€å®šæ˜¯å¤–éƒ¨è´¦æˆ·ï¼›&lt;/li&gt;
  &lt;li&gt;To: 0x7a25â€¦488Dï¼Œäº¤æ˜“çš„æ¥æ”¶æ–¹ï¼Œè¿™é‡Œåœ°å€æ˜¯ä¸€ä¸ªåˆçº¦åœ°å€ï¼›&lt;/li&gt;
  &lt;li&gt;Value: 4.5 Etherï¼Œå³å‘åˆçº¦å‘é€4.5 Etherï¼›&lt;/li&gt;
  &lt;li&gt;Gas Limit: 152,533ï¼Œè¿™æ˜¯äº¤æ˜“å‘èµ·å‰è®¾å®šçš„æœ€å¤§Gasï¼›&lt;/li&gt;
  &lt;li&gt;Usage by Txn: 125,290 (82.14%)ï¼Œè¿™æ˜¯äº¤æ˜“å®é™…æ¶ˆè€—çš„Gasï¼›&lt;/li&gt;
  &lt;li&gt;Input Data: 0x7ff36ab5â€¦ï¼Œè¿™æ˜¯äº¤æ˜“çš„è¾“å…¥æ•°æ®ï¼Œå…¶ä¸­åŒ…å«äº†è°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œä»¥åŠä¼ é€’çš„å‚æ•°ï¼Œè§£ç åå¯çŸ¥è°ƒç”¨å‡½æ•°æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;swapExactETHForTokens&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¯è§ï¼Œè½¬è´¦äº¤æ˜“çš„Gasè´¹ç”¨æ˜¯å›ºå®šçš„ï¼Œè€Œåˆçº¦äº¤æ˜“åªèƒ½é¢„ä¼°ï¼Œå…·ä½“è´¹ç”¨ä»¥å®é™…æ‰§è¡Œåæ¶ˆè€—çš„ä¸ºå‡†ã€‚&lt;/p&gt;

&lt;h4 id=&quot;ä»€ä¹ˆæ˜¯-nonce&quot;&gt;ä»€ä¹ˆæ˜¯ nonceï¼Ÿ&lt;/h4&gt;

&lt;blockquote&gt;
  &lt;p&gt;åœ¨ä»¥å¤ªåŠä¸­ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nonce&lt;/code&gt; æ˜¯ä¸€ä¸ªè´¦æˆ·å·²ç»å‘é€çš„äº¤æ˜“æ•°é‡ï¼Œæˆ–è¯´è¯¥è´¦æˆ·çš„äº¤æ˜“â€œè®¡æ•°å™¨â€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å®ƒæ˜¯æ¯ä¸ªè´¦æˆ·ï¼ˆåŒ…æ‹¬æ™®é€šè´¦æˆ·å’Œåˆçº¦è´¦æˆ·ï¼‰éƒ½ç»´æŠ¤çš„ä¸€ä¸ªæ•°å­—ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ™®é€šåœ°å€ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nonce = è¯¥åœ°å€å·²ç»å‘å‡ºçš„äº¤æ˜“æ•°é‡&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;åˆçº¦åœ°å€éƒ¨ç½²æ—¶ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nonce = éƒ¨ç½²è€…åœ°å€å·²å‘å‡ºçš„äº¤æ˜“æ•°é‡&lt;/code&gt;ï¼Œç”¨äºç”Ÿæˆåˆçº¦åœ°å€&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;nonce çš„ä¸¤ä¸ªå…³é”®ç”¨é€”ï¼š&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ğŸ“¦ é˜²æ­¢äº¤æ˜“é‡æ”¾æ”»å‡»ï¼ˆReplay Attackï¼‰&lt;/li&gt;
&lt;/ol&gt;

&lt;ul&gt;
  &lt;li&gt;æ¯ç¬”äº¤æ˜“éƒ½å¿…é¡»å¸¦ä¸€ä¸ªå”¯ä¸€çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nonce&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;å¦‚æœä½ é‡å¤å¹¿æ’­ä¸€æ¨¡ä¸€æ ·çš„äº¤æ˜“ï¼ˆåŒä¸€ä¸ª nonceï¼‰ï¼Œç½‘ç»œä¼šæ‹’ç»&lt;/li&gt;
  &lt;li&gt;ç¡®ä¿æ¯ç¬”äº¤æ˜“å”¯ä¸€ä¸”æœ‰åºï¼Œä¸èƒ½è¢«å¤åˆ¶ä¼ªé€ &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;ol&gt;
  &lt;li&gt;ğŸ—ï¸ ç¡®å®šæ–°éƒ¨ç½²çš„åˆçº¦åœ°å€&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å½“ä½ éƒ¨ç½²ä¸€ä¸ªæ–°æ™ºèƒ½åˆçº¦æ—¶ï¼Œ&lt;strong&gt;åˆçº¦åœ°å€ä¸æ˜¯éšæœºçš„&lt;/strong&gt;ï¼Œè€Œæ˜¯ç”±ä¸‹é¢è¿™ä¸ªå…¬å¼ç¡®å®šï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;åˆçº¦åœ°å€ = keccak256(rlp_encode([éƒ¨ç½²è€…åœ°å€, éƒ¨ç½²è€…çš„ nonce])) çš„æœ€å 20 å­—èŠ‚
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;æ‰€ä»¥ï¼Œä¸åŒ nonce éƒ¨ç½²å‡ºæ¥çš„åˆçº¦åœ°å€ä¹Ÿä¸åŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;æ™ºèƒ½åˆçº¦&quot;&gt;æ™ºèƒ½åˆçº¦&lt;/h3&gt;

&lt;h4 id=&quot;æ™ºèƒ½åˆçº¦-1&quot;&gt;æ™ºèƒ½åˆçº¦&lt;/h4&gt;

&lt;p&gt;ä»¥å¤ªåŠç›¸æ¯”æ¯”ç‰¹å¸çš„ä¸€ä¸ªé‡å¤§åˆ›æ–°å°±æ˜¯å®ƒæ”¯æŒæ™ºèƒ½åˆçº¦ï¼ˆSmart Contractï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;æ‰€è°“æ™ºèƒ½åˆçº¦ï¼Œå°±æ˜¯ä¸€ç§è¿è¡Œåœ¨åŒºå—é“¾ä¸Šçš„ç¨‹åºã€‚å’Œæ™®é€šç¨‹åºä¸åŒçš„æ˜¯ï¼Œæ™ºèƒ½åˆçº¦è¦ä¿è¯åœ¨åŒºå—é“¾ç½‘ç»œçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸­è¿è¡Œçš„ç»“æœå®Œå…¨ç›¸åŒï¼Œè¿™æ ·æ‰èƒ½ä½¿ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥éªŒè¯æŒ–çŸ¿äº§å‡ºèŠ‚ç‚¹ç”Ÿæˆçš„åŒºå—é‡Œï¼Œæ™ºèƒ½åˆçº¦æ‰§è¡Œçš„ç»“æœå¯¹ä¸å¯¹ã€‚&lt;/p&gt;

&lt;p&gt;å› æ­¤ï¼Œä»¥å¤ªåŠæä¾›äº†ä¸€ä¸ªEVMï¼ˆEthereum Virtual Machineï¼‰è™šæ‹Ÿæœºæ¥æ‰§è¡Œæ™ºèƒ½åˆçº¦çš„å­—èŠ‚ç ï¼Œå¹¶ä¸”ï¼Œå’Œæ™®é€šç¨‹åºç›¸æ¯”ï¼Œä¸ºäº†æ¶ˆé™¤ç¨‹åºè¿è¡Œçš„ä¸ç¡®å®šæ€§ï¼Œæ™ºèƒ½åˆçº¦æœ‰å¾ˆå¤šé™åˆ¶ï¼Œä¾‹å¦‚ï¼Œä¸æ”¯æŒæµ®ç‚¹è¿ç®—ï¼ˆå› ä¸ºæµ®ç‚¹æ•°æœ‰ä¸åŒçš„è¡¨ç¤ºæ–¹æ³•ï¼Œä¸åŒæ¶æ„çš„CPUè¿è¡Œçš„æµ®ç‚¹è®¡ç®—ç²¾åº¦éƒ½ä¸åŒï¼‰ï¼Œä¸æ”¯æŒéšæœºæ•°ï¼Œä¸æ”¯æŒä»å¤–éƒ¨è¯»å–è¾“å…¥ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;ç±»ä¼¼äºJavaæºç è¢«ç¼–è¯‘ä¸ºJVMå¯æ‰§è¡Œçš„å­—èŠ‚ç ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ä¸€ç§é«˜çº§è¯­è¨€æ¥ç¼–å†™æ™ºèƒ½åˆçº¦ï¼Œç„¶åç¼–è¯‘æˆEVMçš„å­—èŠ‚ç ã€‚æœ€å¸¸ç”¨çš„å¼€å‘æ™ºèƒ½åˆçº¦çš„è¯­è¨€æ˜¯ä»¥å¤ªåŠä¸“é—¨ä¸ºå…¶å®šåˆ¶çš„&lt;a href=&quot;https://docs.soliditylang.org/&quot;&gt;Solidity&lt;/a&gt;è¯­è¨€ï¼Œåç»­æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»Solidityçš„ç”¨æ³•ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ªæ™ºèƒ½åˆçº¦è¢«ç¼–è¯‘åå°±æ˜¯ä¸€æ®µEVMå­—èŠ‚ç ï¼Œå°†å®ƒéƒ¨ç½²åœ¨ä»¥å¤ªåŠçš„åŒºå—é“¾æ—¶ï¼Œä¼šæ ¹æ®éƒ¨ç½²è€…çš„åœ°å€å’Œè¯¥åœ°å€çš„nonceåˆ†é…ä¸€ä¸ªåˆçº¦åœ°å€ï¼Œåˆçº¦åœ°å€å’Œè´¦æˆ·åœ°å€çš„æ ¼å¼æ˜¯æ²¡æœ‰åŒºåˆ«çš„ï¼Œä½†åˆçº¦åœ°å€æ²¡æœ‰ç§é’¥ï¼Œä¹Ÿå°±æ²¡æœ‰äººèƒ½ç›´æ¥æ“ä½œè¯¥åœ°å€çš„åˆçº¦æ•°æ®ã€‚è¦è°ƒç”¨åˆçº¦ï¼Œå”¯ä¸€çš„æ–¹æ³•æ˜¯è°ƒç”¨åˆçº¦çš„å…¬å…±å‡½æ•°ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¹Ÿæ˜¯åˆçº¦çš„ä¸€ä¸ªé™åˆ¶ï¼šåˆçº¦ä¸èƒ½ä¸»åŠ¨æ‰§è¡Œï¼Œå®ƒåªèƒ½è¢«å¤–éƒ¨è´¦æˆ·å‘èµ·è°ƒç”¨ã€‚å¦‚æœä¸€ä¸ªåˆçº¦è¦å®šæœŸæ‰§è¡Œï¼Œé‚£åªèƒ½ç”±çº¿ä¸‹æœåŠ¡å™¨å®šæœŸå‘èµ·åˆçº¦è°ƒç”¨ã€‚&lt;/p&gt;

&lt;p&gt;æ­¤å¤–ï¼Œåˆçº¦ä½œä¸ºåœ°å€ï¼Œå¯ä»¥æ¥æ”¶Etherï¼Œä¹Ÿå¯ä»¥å‘é€Etherã€‚åˆçº¦å†…éƒ¨ä¹Ÿå¯ä»¥å­˜å‚¨æ•°æ®ã€‚åˆçº¦çš„æ•°æ®å­˜å‚¨åœ¨åˆçº¦åœ°å€å…³è”çš„å­˜å‚¨ä¸Šï¼Œè¿™å°±ä½¿å¾—åˆçº¦å…·æœ‰äº†çŠ¶æ€ï¼Œå¯ä»¥å®ç°æ¯”è¾ƒå¤æ‚çš„é€»è¾‘ï¼ŒåŒ…æ‹¬å­˜æ¬¾ã€å–æ¬¾ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;åˆçº¦åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥è°ƒç”¨å…¶ä»–å·²éƒ¨ç½²çš„åˆçº¦ï¼Œå‰ææ˜¯çŸ¥é“å…¶ä»–åˆçº¦çš„åœ°å€å’Œå‡½æ•°ç­¾åï¼Œè¿™å°±å¤§å¤§æ‰©å±•äº†åˆçº¦çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåˆçº¦å¯ä»¥è°ƒç”¨å¦ä¸€ä¸ªå€Ÿè´·åˆçº¦çš„å€Ÿæ¬¾æ–¹æ³•ï¼Œå†è°ƒç”¨äº¤æ˜“åˆçº¦ï¼Œæœ€åå†è°ƒç”¨è¿˜æ¬¾æ–¹æ³•ï¼Œå®ç°æ‰€è°“çš„â€œé—ªç”µè´·â€ï¼ˆå³åœ¨ä¸€ä¸ªåˆçº¦è°ƒç”¨ä¸­å®ç°å€Ÿæ¬¾-äº¤æ˜“-è¿˜æ¬¾ï¼‰åŠŸèƒ½ã€‚å¤šä¸ªåˆçº¦çš„åµŒå¥—è°ƒç”¨ä¹Ÿä½¿å¾—å› ä¸ºä»£ç ç¼–å†™çš„æ¼æ´å¯¼è‡´é»‘å®¢æ”»å‡»çš„å¯èƒ½æ€§å¤§å¤§å¢åŠ ã€‚ä¸ºäº†é¿å…æ¼æ´ï¼Œç¼–å†™åˆçº¦æ—¶éœ€è¦æ›´åŠ å°å¿ƒã€‚&lt;/p&gt;

&lt;h4 id=&quot;å°ç»“&quot;&gt;å°ç»“&lt;/h4&gt;

&lt;p&gt;ä»¥å¤ªåŠé€šè¿‡EVMè™šæ‹Ÿæœºæ‰§è¡Œæ™ºèƒ½åˆçº¦ä»£ç ï¼›&lt;/p&gt;

&lt;p&gt;åˆçº¦è¢«éƒ¨ç½²åå°†è‡ªåŠ¨è·å¾—ä¸€ä¸ªåœ°å€ï¼Œå¹¶å¯åƒå¤–éƒ¨è´¦æˆ·ä¸€æ ·å­˜å–Etherï¼Œè¿˜å¯ä»¥å­˜å‚¨çŠ¶æ€æ•°æ®ï¼›&lt;/p&gt;

&lt;p&gt;åˆçº¦åªèƒ½è¢«åŠ¨åœ°è¢«å¤–éƒ¨è´¦æˆ·è°ƒç”¨ï¼Œä½†åœ¨æ‰§è¡Œæ—¶å¯ä»¥è°ƒç”¨å…¶ä»–åˆçº¦çš„å…¬å…±å‡½æ•°ã€‚&lt;/p&gt;</content><author><name>Fulong Ma</name></author><category term="Web3" /><category term="Web3" /><summary type="html">ä»¥å¤ªåŠæŠ€æœ¯</summary></entry><entry><title type="html">æ¯”ç‰¹å¸ç»“æŸ</title><link href="https://mafulong.github.io/2025/07/13/%E6%AF%94%E7%89%B9%E5%B8%81%E6%8A%80%E6%9C%AF/" rel="alternate" type="text/html" title="æ¯”ç‰¹å¸ç»“æŸ" /><published>2025-07-13T00:00:00+08:00</published><updated>2025-07-13T00:00:00+08:00</updated><id>https://mafulong.github.io/2025/07/13/%E6%AF%94%E7%89%B9%E5%B8%81%E6%8A%80%E6%9C%AF</id><content type="html" xml:base="https://mafulong.github.io/2025/07/13/%E6%AF%94%E7%89%B9%E5%B8%81%E6%8A%80%E6%9C%AF/">&lt;h2 id=&quot;åŒºå—é“¾å…¥é—¨2&quot;&gt;åŒºå—é“¾å…¥é—¨2&lt;/h2&gt;

&lt;p&gt;å»–é›ªå³°çš„åŒºå—é“¾ç¬”è®°ã€‚ &lt;a href=&quot;https://liaoxuefeng.com/books/blockchain/bitcoin/basic/index.html&quot;&gt;å‚è€ƒ&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;æ•°å­—è´§å¸-vs-ç”µå­è´§å¸&quot;&gt;æ•°å­—è´§å¸ vs. ç”µå­è´§å¸&lt;/h3&gt;

&lt;p&gt;ç”µå­è´§å¸æœ¬è´¨ä¸Šä»ç„¶æ˜¯æ³•å¸ï¼Œå®ƒä»ç„¶æ˜¯ç”±å¤®è¡Œå‘è¡Œï¼Œåªæ˜¯ä»¥è®¡ç®—æœºæŠ€æœ¯æŠŠè´§å¸ä»¥å®ä½“çº¸å¸å½¢å¼çš„æµé€šå˜æˆäº†é“¶è¡Œè®¡ç®—æœºç³»ç»Ÿçš„å­˜æ¬¾ã€‚å’Œçº¸å¸ç›¸æ¯”ï¼Œç”µå­è´§å¸å…·æœ‰æ›´é«˜çš„æµåŠ¨æ€§ã€‚æˆ‘ä»¬æ¯å¤©ä½¿ç”¨çš„ç½‘ä¸Šé“¶è¡Œã€æ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ç­‰ï¼Œéƒ½æ˜¯è¿™ç§æ–¹å¼ã€‚&lt;/p&gt;

&lt;p&gt;è€Œæ¯”ç‰¹å¸ä½œä¸ºä¸€ç§æ•°å­—è´§å¸ï¼Œå®ƒå’Œç”µå­è´§å¸ä¸åŒçš„æ˜¯ï¼Œæ¯”ç‰¹å¸ä¸éœ€è¦ä¸€ä¸ªç±»ä¼¼é“¶è¡Œçš„ä¸­å¤®ä¿¡ä»»æœºæ„ï¼Œå°±å¯ä»¥é€šè¿‡å…¨çƒP2Pç½‘ç»œè¿›è¡Œå‘è¡Œå’Œæµé€šï¼Œè¿™ä¸€ç‚¹å¬ä¸Šå»æœ‰ç‚¹ä¸å¯æ€è®®ï¼Œä½†æ¯”ç‰¹å¸æ­£æ˜¯ä¸€ç§é€šè¿‡å¯†ç å­¦ç†è®ºå»ºç«‹çš„ä¸å¯ä¼ªé€ çš„è´§å¸ç³»ç»Ÿã€‚&lt;/p&gt;

&lt;h3 id=&quot;æ¯”ç‰¹å¸è§£å†³çš„é—®é¢˜&quot;&gt;æ¯”ç‰¹å¸è§£å†³çš„é—®é¢˜&lt;/h3&gt;

&lt;p&gt;æ¯”ç‰¹å¸åˆ™æ˜¯é€šè¿‡åŒºå—é“¾æŠ€æœ¯ï¼ŒæŠŠæ•´ä¸ªè´¦æœ¬å…¨éƒ¨å…¬å¼€ï¼Œäººæ‰‹ä¸€ä»½ï¼Œå…¨ç½‘ç›¸åŒï¼Œå› æ­¤ï¼Œä¿®æ”¹è´¦æœ¬ä¸ä¼šè¢«å…¶ä»–äººæ‰¿è®¤ã€‚æ¯”ç‰¹å¸çš„åŒºå—é“¾å°±æ˜¯ä¸€ç§å­˜å‚¨äº†å…¨éƒ¨è´¦æœ¬çš„é“¾å¼æ•°æ®åº“ï¼Œé€šè¿‡ä¸€ç³»åˆ—å¯†ç å­¦ç†è®ºè¿›è¡Œé˜²ç¯¡æ”¹ï¼Œé˜²åŒèŠ±ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸è§£å†³çš„æ˜¯ç°é‡‘ç”µå­åŒ–åæ— éœ€ä¸­å¤®ä¿¡ä»»æœºæ„çš„äº¤æ˜“é—®é¢˜ï¼Œå³M0å¦‚ä½•é€šè¿‡ç½‘ç»œè¿›è¡Œä»·å€¼ä¼ è¾“ã€‚æˆ‘ä»¬å·²ç»ä¹ æƒ¯äº†é€šè¿‡äº’è”ç½‘å¯¹æ•°å­—åŒ–çš„æ–°é—»ã€éŸ³ä¹ã€è§†é¢‘è¿›è¡Œä¿¡æ¯ä¼ è¾“ï¼Œå› ä¸ºä¿¡æ¯ä¼ è¾“çš„æœ¬è´¨æ˜¯å¤åˆ¶ï¼Œä½†ç°å®ä¸–ç•Œçš„ç°é‡‘å¯ä¸èƒ½å¤åˆ¶ã€‚æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬å¦‚ä½•æŠŠ100å…ƒç°é‡‘é€šè¿‡ç½‘ç»œå‘é€ç»™å¦ä¸€ä¸ªäººï¼ŒåŒæ—¶ç¡®ä¿äº¤æ˜“å‰åä¸¤ä¸ªäººçš„ç°é‡‘æ€»é¢ä¿æŒä¸å˜ã€‚æ‰€ä»¥ï¼Œä¸­æœ¬èªçš„ç™½çš®ä¹¦æŠŠæ¯”ç‰¹å¸å®šä¹‰ä¸ºâ€œç‚¹å¯¹ç‚¹çš„ç”µå­ç°é‡‘ç³»ç»Ÿâ€ã€‚&lt;/p&gt;

&lt;p&gt;åŒºå—é“¾æ˜¯ç”±ä¸€ä¸ªä¸€ä¸ªåŒºå—æ„æˆçš„æœ‰åºé“¾è¡¨ï¼Œæ¯ä¸€ä¸ªåŒºå—éƒ½è®°å½•äº†ä¸€ç³»åˆ—äº¤æ˜“ï¼Œå¹¶ä¸”ï¼Œæ¯ä¸ªåŒºå—éƒ½æŒ‡å‘å‰ä¸€ä¸ªåŒºå—ï¼Œä»è€Œå½¢æˆä¸€ä¸ªé“¾æ¡ï¼š&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸ç½‘ç»œä¸­æ˜¯&lt;strong&gt;æ¯æ¬¡ç”Ÿæˆä¸€ä¸ªæ–°åŒºå—&lt;/strong&gt;ï¼Œæ–°åŒºå—ä¸­ä¼šæ‰“åŒ…&lt;strong&gt;å¤šç¬”äº¤æ˜“ä¿¡æ¯&lt;/strong&gt;ï¼Œ&lt;/p&gt;

&lt;h2 id=&quot;åŒºå—é“¾åŸç†&quot;&gt;åŒºå—é“¾åŸç†&lt;/h2&gt;

&lt;h4 id=&quot;-äº¤æ˜“ä¿¡æ¯çš„æ¥æºå†…å­˜æ± mempool&quot;&gt;âœ… äº¤æ˜“ä¿¡æ¯çš„æ¥æºï¼š&lt;strong&gt;å†…å­˜æ± ï¼ˆMempoolï¼‰&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;ä»€ä¹ˆæ˜¯å†…å­˜æ± ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å½“ç”¨æˆ·ï¼ˆæˆ–é’±åŒ…ã€äº¤æ˜“æ‰€ï¼‰å‘èµ·ä¸€ç¬”äº¤æ˜“ï¼Œä¾‹å¦‚ä»ä¸€ä¸ªåœ°å€å‘é€ BTC åˆ°å¦ä¸€ä¸ªåœ°å€ï¼Œè¿™ç¬”äº¤æ˜“ä¼šé¦–å…ˆè¢«å¹¿æ’­åˆ°æ¯”ç‰¹å¸ç½‘ç»œï¼Œç„¶åï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç½‘ç»œä¸­çš„èŠ‚ç‚¹ä¼šæ¥æ”¶åˆ°è¿™ç¬”äº¤æ˜“&lt;/li&gt;
  &lt;li&gt;èŠ‚ç‚¹ä¼šå…ˆå¯¹å…¶è¿›è¡ŒéªŒè¯ï¼ˆç­¾åæ˜¯å¦æœ‰æ•ˆã€ä½™é¢æ˜¯å¦å¤Ÿç­‰ï¼‰&lt;/li&gt;
  &lt;li&gt;éªŒè¯æ— è¯¯åï¼Œè¿™ç¬”äº¤æ˜“å°±è¢«åŠ å…¥åˆ°&lt;strong&gt;å†…å­˜æ± ï¼ˆMempoolï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;-æŒ–çŸ¿æ—¶å¦‚ä½•ç”ŸæˆåŒºå—&quot;&gt;âœ… æŒ–çŸ¿æ—¶å¦‚ä½•ç”ŸæˆåŒºå—ï¼Ÿ&lt;/h4&gt;

&lt;p&gt;çŸ¿å·¥åˆ›å»ºæ–°åŒºå—æ—¶ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;ä»å†…å­˜æ± ä¸­é€‰æ‹©äº¤æ˜“&lt;/strong&gt;ï¼ˆä¼˜å…ˆé€‰æ‹©æ‰‹ç»­è´¹é«˜çš„ï¼‰&lt;/li&gt;
  &lt;li&gt;å°†è¿™äº›äº¤æ˜“æ‰“åŒ…æˆä¸€ä¸ªå€™é€‰åŒºå—ï¼ˆç§°ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;block template&lt;/code&gt;ï¼‰&lt;/li&gt;
  &lt;li&gt;è¿›è¡Œå·¥ä½œé‡è¯æ˜ï¼ˆProof of Workï¼Œè§£é¢˜ï¼‰&lt;/li&gt;
  &lt;li&gt;è°å…ˆè§£å‡ºå“ˆå¸Œï¼Œè°å°±&lt;strong&gt;ç”Ÿæˆæ–°åŒºå—&lt;/strong&gt;ï¼Œå¹¿æ’­ç»™å…¨ç½‘&lt;/li&gt;
  &lt;li&gt;å…¶ä»–èŠ‚ç‚¹éªŒè¯åŒºå—ï¼Œæ²¡é—®é¢˜å°±æ¥å—è¯¥åŒºå—ï¼Œå¹¶åŠ å…¥åŒºå—é“¾ä¸­&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h5 id=&quot;-æ¯ä¸ªåŒºå—è‡³å°‘åŒ…å«ä¸¤ç¬”äº¤æ˜“&quot;&gt;âœ… æ¯ä¸ªåŒºå—è‡³å°‘åŒ…å«ä¸¤ç¬”äº¤æ˜“ï¼š&lt;/h5&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;Coinbase äº¤æ˜“&lt;/strong&gt;ï¼šçŸ¿å·¥çš„å¥–åŠ±äº¤æ˜“ï¼ˆåŒ…æ‹¬åŒºå—å¥–åŠ±å’Œæ‰€æœ‰äº¤æ˜“çš„æ‰‹ç»­è´¹ï¼‰&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç”¨æˆ·äº¤æ˜“&lt;/strong&gt;ï¼šä» Mempool ä¸­æ‰“åŒ…è¿›æ¥çš„æ™®é€šäº¤æ˜“&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&quot;æƒ…å†µä¸¤ä¸ªçŸ¿å·¥åŒæ—¶æŒ–å‡ºåŒºå—äº§ç”ŸçŸ­æš‚åˆ†å‰&quot;&gt;æƒ…å†µï¼šä¸¤ä¸ªçŸ¿å·¥åŒæ—¶æŒ–å‡ºåŒºå—ï¼Œäº§ç”Ÿã€ŒçŸ­æš‚åˆ†å‰ã€&lt;/h5&gt;

&lt;p&gt;å‡è®¾å½“å‰é“¾åˆ°é«˜åº¦ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N&lt;/code&gt;ï¼Œç°åœ¨ä¸¤ä¸ªçŸ¿å·¥åˆ†åˆ«å‡ ä¹åŒæ—¶æŒ–å‡ºä¸‹ä¸€ä¸ªæ–°åŒºå—ã€‚ å› ä¸ºç½‘ç»œä¼ æ’­å»¶è¿Ÿï¼Œä¸æ˜¯æ‰€æœ‰èŠ‚ç‚¹éƒ½ç«‹åˆ»çœ‹åˆ°åŒä¸€ä¸ªåŒºå—&lt;/p&gt;

&lt;h5 id=&quot;ï¸-è§£å†³æœºåˆ¶æœ€é•¿é“¾åŸåˆ™longest-chain-rule&quot;&gt;âš™ï¸ è§£å†³æœºåˆ¶ï¼š&lt;strong&gt;æœ€é•¿é“¾åŸåˆ™ï¼ˆLongest Chain Ruleï¼‰&lt;/strong&gt;&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;æ¯”ç‰¹å¸è§„å®šï¼š&lt;strong&gt;æ‰€æœ‰èŠ‚ç‚¹åªæ‰¿è®¤ã€Œå·¥ä½œé‡æœ€å¤šï¼ˆæœ€é•¿ï¼‰ã€çš„é“¾ä¸ºä¸»é“¾ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;åˆ†å‰å¦‚ä½•è¢«è§£å†³&quot;&gt;åˆ†å‰å¦‚ä½•è¢«è§£å†³ï¼Ÿ&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ä¸¤æ¡é“¾å¹¶å­˜æ—¶ï¼Œç½‘ç»œä¸­éƒ¨åˆ†èŠ‚ç‚¹æ”¯æŒ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N+1a&lt;/code&gt;ï¼Œå¦ä¸€éƒ¨åˆ†æ”¯æŒ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N+1b&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ä¸‹ä¸€è½®ï¼Œå‡è®¾æŸä¸ªçŸ¿å·¥åœ¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N+1a&lt;/code&gt; çš„é“¾ä¸ŠæŒ–å‡ºäº† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N+2a&lt;/code&gt;ï¼Œå¹¶æˆåŠŸå¹¿æ’­ç»™å¤§å¤šæ•°èŠ‚ç‚¹ï¼š&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mathematica
   
   
CopyEdit
     åŒºå— N
      /  \
åŒºå— N+1a åŒºå— N+1b
     |
 åŒºå— N+2a
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ‰€æœ‰èŠ‚ç‚¹çœ‹åˆ° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N+2a&lt;/code&gt; åå‘ç°è¿™æ¡é“¾ã€Œæ›´é•¿ã€ï¼Œå°±&lt;strong&gt;åˆ‡æ¢åˆ°è¿™ä¸ªåˆ†æ”¯&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N+1b&lt;/code&gt; å°±æˆä¸º&lt;strong&gt;å­¤å—ï¼ˆorphan blockï¼‰&lt;/strong&gt;ï¼Œè¢«ä¸¢å¼ƒ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h5 id=&quot;-å­¤å—orphan-block&quot;&gt;ğŸ’¡ å­¤å—ï¼ˆOrphan Blockï¼‰&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;æ˜¯è¢«ç½‘ç»œçŸ­æš‚æ¥å—ä½†æœ€ç»ˆè¢«æŠ›å¼ƒçš„åŒºå—&lt;/li&gt;
  &lt;li&gt;å…¶ä¸­çš„äº¤æ˜“ &lt;strong&gt;ä¸ä¼šä¸¢å¤±&lt;/strong&gt;ï¼Œè€Œæ˜¯é‡æ–°å›åˆ° Mempool&lt;/li&gt;
  &lt;li&gt;è¿™äº›äº¤æ˜“å¯èƒ½ä¼šè¢«é‡æ–°æ‰“åŒ…è¿›åç»­åŒºå—ä¸­&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;-ä¸¾ä¸ªä¾‹å­&quot;&gt;ğŸ§  ä¸¾ä¸ªä¾‹å­ï¼š&lt;/h5&gt;

&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;AçŸ¿å·¥å’ŒBçŸ¿å·¥åˆ†åˆ«åœ¨åŒ—äº¬å’Œçº½çº¦ï¼Œå‡ ä¹åŒæ—¶æŒ–å‡ºåŒºå—é«˜åº¦ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;850,000&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Açš„åŒºå—ä¼ æ’­åˆ°äºšæ´²å¿«ä¸€äº›ï¼ŒBçš„ä¼ æ’­åˆ°ç¾æ´²å¿«&lt;/li&gt;
  &lt;li&gt;æŸçŸ¿å·¥åœ¨æ¥æ”¶åˆ° A çš„åŒºå—åæˆåŠŸæŒ–å‡ºäº† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;850,001&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;è¿™æ ·æ•´ä¸ªç½‘ç»œæœ€ç»ˆé€‰æ‹©äº†ä»¥ A ä¸ºä¸»çš„é“¾ï¼ŒBçš„é“¾è¢«å›æ»š&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;-åˆæ­¥å¹¿æ’­å¹¶æ‰“åŒ…--æœ€ç»ˆç¡®è®¤&quot;&gt;âœ… åˆæ­¥å¹¿æ’­å¹¶æ‰“åŒ… â‰  æœ€ç»ˆç¡®è®¤&lt;/h4&gt;

&lt;p&gt;åœ¨æ¯”ç‰¹å¸ä¸­ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä½ çš„äº¤æ˜“è¢«æ‰“åŒ…è¿›æŸä¸ªåŒºå— âœ…ï¼Œ&lt;strong&gt;å¹¶ä¸ä»£è¡¨æœ€ç»ˆäº¤æ˜“æˆåŠŸ&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;å¦‚æœè¿™ä¸ªåŒºå—åæ¥è¢«æŠ›å¼ƒï¼ˆå› ä¸ºå‘ç”Ÿåˆ†å‰ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªäº¤æ˜“å°±&lt;strong&gt;ç­‰äºæ²¡å‘ç”Ÿè¿‡&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;è¿™æ—¶äº¤æ˜“ä¼šå›åˆ°å†…å­˜æ± ï¼ˆMempoolï¼‰ä¸­ç­‰å¾…é‡æ–°æ‰“åŒ…&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;åœ¨åŒºå—é“¾åˆ†å‰å‘ç”Ÿæ—¶ï¼Œäº¤æ˜“æ˜¯å¦æˆåŠŸï¼Œè¦çœ‹å®ƒæ˜¯å¦æœ€ç»ˆå‡ºç°åœ¨ä¸»é“¾ä¸­ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;-åˆ†å‰ä¸­äº¤æ˜“å¯èƒ½ç»å†&quot;&gt;ğŸ” åˆ†å‰ä¸­äº¤æ˜“å¯èƒ½ç»å†ï¼š&lt;/h4&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;çŠ¶æ€&lt;/th&gt;
      &lt;th&gt;è¯´æ˜&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;è¢«æŸä¸ªåŒºå—æ‰“åŒ…&lt;/td&gt;
      &lt;td&gt;æš‚æ—¶è¿›å…¥é“¾ä¸­ï¼Œä½†å¯èƒ½è¢«åˆ†å‰æ‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;åŒºå—è¢«å­¤ç«‹ï¼ˆorphanedï¼‰&lt;/td&gt;
      &lt;td&gt;æ‰€æœ‰äº¤æ˜“è§†ä¸ºæœªç¡®è®¤ï¼Œå›åˆ° Mempool&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;è¢«æ–°ä¸»é“¾é‡æ–°æ‰“åŒ…&lt;/td&gt;
      &lt;td&gt;å†æ¬¡ç­‰å¾…ç¡®è®¤ï¼Œæ‰ç®—æœ€ç»ˆæˆåŠŸ&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;-æ‰€ä»¥ä¸ºä»€ä¹ˆæˆ‘ä»¬è¯´äº¤æ˜“è¦æœ‰ç¡®è®¤æ•°&quot;&gt;ğŸ“Š æ‰€ä»¥ä¸ºä»€ä¹ˆæˆ‘ä»¬è¯´äº¤æ˜“è¦æœ‰ã€Œç¡®è®¤æ•°ã€ï¼Ÿ&lt;/h4&gt;

&lt;p&gt;æ¯”ç‰¹å¸äº¤æ˜“é€šå¸¸è¯´ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;â€œå»ºè®®ç­‰ &lt;strong&gt;6 ä¸ªç¡®è®¤&lt;/strong&gt;ï¼Œå†è®¤ä¸ºäº¤æ˜“æ˜¯æœ€ç»ˆä¸å¯é€†çš„â€&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ç¡®è®¤æ•°æ˜¯æŒ‡ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æŸäº¤æ˜“æ‰€åœ¨åŒºå—ä¹‹ååˆè¢«å¤šå°‘ä¸ªåŒºå—æ‰€ç¡®è®¤&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ç¡®è®¤æ•°&lt;/th&gt;
      &lt;th&gt;å®‰å…¨æ€§è¯´æ˜&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;ä»…åœ¨ Mempoolï¼Œè¿˜æ²¡è¢«æ‰“åŒ…&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;åˆšè¢«æ‰“åŒ…ï¼Œå¯èƒ½ä¼šè¢«åˆ†å‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2~3&lt;/td&gt;
      &lt;td&gt;å®‰å…¨æ€§é€æ¸æé«˜&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;6+&lt;/td&gt;
      &lt;td&gt;åŸºæœ¬ä¸å¯é€†ï¼ˆ99.999% å®‰å…¨ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h5 id=&quot;-ä¸ºä»€ä¹ˆè¶Šå¤šç¡®è®¤è¶Šå®‰å…¨&quot;&gt;ğŸ’¡ ä¸ºä»€ä¹ˆè¶Šå¤šç¡®è®¤è¶Šå®‰å…¨ï¼Ÿ&lt;/h5&gt;

&lt;p&gt;å› ä¸ºè¦ã€Œå›æ»šã€ä½ çš„äº¤æ˜“ï¼Œæ”»å‡»è€…å¿…é¡»ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;å›æ»šåŒºå— N æ‰€åœ¨çš„æ•´æ¡é“¾&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;å¹¶ä»åŒºå— N å¼€å§‹æŒ–å‡ºä¸€ä¸ª&lt;strong&gt;æ¯”ç°åœ¨ä¸»é“¾è¿˜é•¿çš„æ–°é“¾&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;è¿™éœ€è¦æ¶ˆè€—å¤§é‡ç®—åŠ›ï¼ˆPoWï¼‰&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&quot;-æ”»å‡»æˆæœ¬éšç€ç¡®è®¤æ•°æŒ‡æ•°çº§ä¸Šå‡&quot;&gt;ğŸ“ˆ æ”»å‡»æˆæœ¬éšç€ç¡®è®¤æ•°æŒ‡æ•°çº§ä¸Šå‡&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ç¡®è®¤æ•° = 1&lt;/strong&gt;ï¼šæ”»å‡»è€…åªéœ€è¦è¶…è¿‡ç½‘ç»œ 50% ç®—åŠ›ä¸€ç‚¹ç‚¹ï¼Œå°±æœ‰è¾ƒé«˜æˆåŠŸç‡&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç¡®è®¤æ•° = 6&lt;/strong&gt;ï¼šæ”»å‡»è€…éœ€è¦æé«˜ç®—åŠ›å’Œè¿æ°”ï¼Œåœ¨çŸ­æ—¶é—´å†…æŒ–å‡º 6 ä¸ªæ–°åŒºå—èµ¶ä¸Šä¸»é“¾&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç¡®è®¤æ•° &amp;gt; 6&lt;/strong&gt;ï¼šæ”»å‡»æˆæœ¬å·²ç»æ¥è¿‘ä¸å¯èƒ½ï¼Œé™¤éæ”»å‡»è€…æŒæ¡æ¥è¿‘å…¨çƒä¸€åŠçš„æ¯”ç‰¹å¸ç®—åŠ›&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;-å¦‚æœçœŸçš„æŒç»­åˆ†å‰ä¼šæ€æ ·&quot;&gt;ğŸ” å¦‚æœçœŸçš„æŒç»­åˆ†å‰ï¼Œä¼šæ€æ ·ï¼Ÿ&lt;/h5&gt;

&lt;p&gt;è¿™ç§æƒ…å†µé€šå¸¸åªåœ¨ä»¥ä¸‹æ¡ä»¶ä¸‹å‡ºç°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ¶æ„æ”»å‡»ï¼ˆå¦‚æ‹¥æœ‰è¶…è¿‡ 50% ç®—åŠ›çš„æ”»å‡»è€…ï¼‰&lt;/li&gt;
  &lt;li&gt;ç½‘ç»œä¸¥é‡åˆ†åŒºï¼ˆpartitioningï¼‰&lt;/li&gt;
  &lt;li&gt;å…±è¯†æœºåˆ¶è¢«ç¯¡æ”¹ï¼ˆå¦‚åè®®æ¼æ´ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½†ä¸€æ—¦è¿™æ ·å‘ç”Ÿï¼Œæ•´ä¸ªæ¯”ç‰¹å¸ç”Ÿæ€å°±ä¼šï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å‡ºç°é“¾é‡ç»„ï¼ˆreorgï¼‰&lt;/li&gt;
  &lt;li&gt;å¼•å‘é‡å¤§å…±è¯†å±æœº&lt;/li&gt;
  &lt;li&gt;å¼€å‘è€…/ç¤¾åŒºå¯èƒ½ä¼šé€šè¿‡ç¡¬åˆ†å‰ä¿®å¤&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;-è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯åŒºå—é«˜åº¦block-height&quot;&gt;ğŸ“š è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯â€œåŒºå—é«˜åº¦â€ï¼ˆBlock Heightï¼‰&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;åŒºå—é«˜åº¦æ˜¯ç”¨æ¥è¡¨ç¤ºæŸä¸ªåŒºå—åœ¨æ•´ä¸ªåŒºå—é“¾ä¸­çš„&lt;strong&gt;ä½ç½®ç¼–å·&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;åˆ›ä¸–åŒºå—ï¼ˆç¬¬ä¸€ä¸ªåŒºå—ï¼ŒGenesis Blockï¼‰çš„é«˜åº¦æ˜¯ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;æ¯æ–°æŒ–å‡ºä¸€ä¸ªåŒºå—ï¼Œé«˜åº¦å°± +1&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;é¡¹ç›®&lt;/th&gt;
      &lt;th&gt;å«ä¹‰&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;åŒºå—é«˜åº¦ 851,768&lt;/td&gt;
      &lt;td&gt;æ˜¯æ¯”ç‰¹å¸é“¾ä¸Šçš„ç¬¬ 851,768 ä¸ªåŒºå—&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ä½œç”¨&lt;/td&gt;
      &lt;td&gt;ç”¨äºå®šä½ã€æ£€ç´¢ã€è¿½è¸ªã€éªŒè¯äº¤æ˜“å†å²ç­‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;å¦‚ä½•æŸ¥çœ‹&lt;/td&gt;
      &lt;td&gt;åŒºå—æµè§ˆå™¨ï¼ˆå¦‚ mempool.spaceï¼‰&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;å¸¸ç”¨å“ˆå¸Œç®—æ³•&quot;&gt;å¸¸ç”¨å“ˆå¸Œç®—æ³•&lt;/h3&gt;

&lt;p&gt;å¸¸ç”¨çš„å“ˆå¸Œç®—æ³•ä»¥åŠå®ƒä»¬çš„è¾“å‡ºé•¿åº¦å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;å“ˆå¸Œç®—æ³•&lt;/th&gt;
      &lt;th&gt;è¾“å‡ºé•¿åº¦(bit)&lt;/th&gt;
      &lt;th&gt;è¾“å‡ºé•¿åº¦(å­—èŠ‚)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;MD5&lt;/td&gt;
      &lt;td&gt;128 bit&lt;/td&gt;
      &lt;td&gt;16 bytes&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;RipeMD160&lt;/td&gt;
      &lt;td&gt;160 bits&lt;/td&gt;
      &lt;td&gt;20 bytes&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;SHA-1&lt;/td&gt;
      &lt;td&gt;160 bits&lt;/td&gt;
      &lt;td&gt;20 bytes&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;SHA-256&lt;/td&gt;
      &lt;td&gt;256 bits&lt;/td&gt;
      &lt;td&gt;32 bytes&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;SHA-512&lt;/td&gt;
      &lt;td&gt;512 bits&lt;/td&gt;
      &lt;td&gt;64 bytes&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;æ¯”ç‰¹å¸ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•æœ‰ä¸¤ç§ï¼šSHA-256å’ŒRipeMD160&lt;/p&gt;

&lt;p&gt;SHA-256çš„ç†è®ºç¢°æ’æ¦‚ç‡æ˜¯ï¼šå°è¯•2çš„130æ¬¡æ–¹çš„éšæœºè¾“å…¥ï¼Œæœ‰99.8%çš„æ¦‚ç‡ç¢°æ’ã€‚æ³¨æ„2130æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ•°å­—ï¼Œå¤§çº¦æ˜¯1361ä¸‡äº¿äº¿äº¿äº¿ã€‚ä»¥ç°æœ‰çš„è®¡ç®—æœºçš„è®¡ç®—èƒ½åŠ›ï¼Œæ˜¯ä¸å¯èƒ½åœ¨çŸ­æœŸå†…ç ´è§£çš„ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸ä½¿ç”¨ä¸¤ç§å“ˆå¸Œç®—æ³•ï¼Œä¸€ç§æ˜¯å¯¹æ•°æ®è¿›è¡Œä¸¤æ¬¡SHA-256è®¡ç®—ï¼Œè¿™ç§ç®—æ³•åœ¨æ¯”ç‰¹å¸åè®®ä¸­é€šå¸¸è¢«ç§°ä¸ºhash256æˆ–è€…dhashã€‚&lt;/p&gt;

&lt;p&gt;å¦ä¸€ç§ç®—æ³•æ˜¯å…ˆè®¡ç®—SHA-256ï¼Œå†è®¡ç®—RipeMD160ï¼Œè¿™ç§ç®—æ³•åœ¨æ¯”ç‰¹å¸åè®®ä¸­é€šå¸¸è¢«ç§°ä¸ºhash160ã€‚&lt;/p&gt;

&lt;h3 id=&quot;åŒºå—é“¾ä¸å¯ç¯¡æ”¹ç‰¹æ€§&quot;&gt;åŒºå—é“¾ä¸å¯ç¯¡æ”¹ç‰¹æ€§&lt;/h3&gt;

&lt;h3 id=&quot;merkle-hash&quot;&gt;Merkle Hash&lt;/h3&gt;

&lt;p&gt;åœ¨åŒºå—çš„å¤´éƒ¨ï¼Œæœ‰ä¸€ä¸ªMerkle Hashå­—æ®µï¼Œå®ƒè®°å½•äº†æœ¬åŒºå—æ‰€æœ‰äº¤æ˜“çš„Merkle Hashï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202507131010621.jpg&quot; alt=&quot;Merkle Hash&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Merkle Hashæ˜¯æŠŠä¸€ç³»åˆ—æ•°æ®çš„å“ˆå¸Œæ ¹æ®ä¸€ä¸ªç®€å•ç®—æ³•å˜æˆä¸€ä¸ªæ±‡æ€»çš„å“ˆå¸Œã€‚&lt;/p&gt;

&lt;p&gt;å‡è®¾ä¸€ä¸ªåŒºå—æœ‰4ä¸ªäº¤æ˜“ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªäº¤æ˜“æ•°æ®åšdhashï¼Œå¾—åˆ°4ä¸ªå“ˆå¸Œå€¼&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a1&lt;/code&gt;ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a2&lt;/code&gt;ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a3&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a4&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;a1 = dhash(tx1)
a2 = dhash(tx2)
a3 = dhash(tx3)
a4 = dhash(tx4)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ³¨æ„åˆ°å“ˆå¸Œå€¼ä¹Ÿå¯ä»¥çœ‹åšæ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥æŠŠ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a1&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a2&lt;/code&gt;æ‹¼èµ·æ¥ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a3&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a4&lt;/code&gt;æ‹¼èµ·æ¥ï¼Œå†è®¡ç®—å‡ºä¸¤ä¸ªå“ˆå¸Œå€¼&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b1&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b2&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚b1=dhash(a1+a2)â”‚               â”‚b2=dhash(a3+a4)â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–²                               â–²
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
       â”‚               â”‚               â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚a1=dhash(tx1)â”‚ â”‚a2=dhash(tx2)â”‚ â”‚a3=dhash(tx3)â”‚ â”‚a4=dhash(tx4)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æœ€åï¼ŒæŠŠ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b1&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b2&lt;/code&gt;è¿™ä¸¤ä¸ªå“ˆå¸Œå€¼æ‹¼èµ·æ¥ï¼Œè®¡ç®—å‡ºæœ€ç»ˆçš„å“ˆå¸Œå€¼ï¼Œè¿™ä¸ªå“ˆå¸Œå°±æ˜¯Merkle Hashï¼š&lt;/p&gt;

&lt;p&gt;å¦‚æœäº¤æ˜“çš„æ•°é‡ä¸æ°å¥½æ˜¯4ä¸ªæ€ä¹ˆåŠï¼Ÿä¾‹å¦‚ï¼Œåªæœ‰3ä¸ªäº¤æ˜“æ—¶ï¼Œç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªäº¤æ˜“çš„å“ˆå¸Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a1&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a2&lt;/code&gt;å¯ä»¥æ‹¼èµ·æ¥ç®—å‡º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b1&lt;/code&gt;ï¼Œç¬¬ä¸‰ä¸ªäº¤æ˜“åªèƒ½ç®—å‡ºä¸€ä¸ªå“ˆå¸Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a3&lt;/code&gt;ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°±æŠŠa3ç›´æ¥å¤åˆ¶ä¸€ä»½ï¼Œç®—å‡º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b2&lt;/code&gt;ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½æœ€ç»ˆè®¡ç®—å‡ºMerkle Hashï¼š&lt;/p&gt;

&lt;p&gt;å¦‚æœæœ‰5ä¸ªäº¤æ˜“ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a5&lt;/code&gt;è¢«å¤åˆ¶äº†ä¸€ä»½ï¼Œä»¥ä¾¿è®¡ç®—å‡º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b3&lt;/code&gt;ï¼Œéšå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b3&lt;/code&gt;ä¹Ÿè¢«å¤åˆ¶äº†ä¸€ä»½ï¼Œä»¥ä¾¿è®¡ç®—å‡º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;c2&lt;/code&gt;ã€‚æ€»ä¹‹ï¼Œåœ¨æ¯ä¸€å±‚è®¡ç®—ä¸­ï¼Œå¦‚æœæœ‰å•æ•°ï¼Œå°±æŠŠæœ€åä¸€ä»½æ•°æ®å¤åˆ¶ï¼Œæœ€åä¸€å®šèƒ½è®¡ç®—å‡ºMerkle Hashï¼š&lt;/p&gt;

&lt;p&gt;ä»Merkle Hashçš„è®¡ç®—æ–¹æ³•å¯ä»¥å¾—å‡ºç»“è®ºï¼šä¿®æ”¹ä»»æ„ä¸€ä¸ªäº¤æ˜“å“ªæ€•ä¸€ä¸ªå­—èŠ‚ï¼Œæˆ–è€…äº¤æ¢ä¸¤ä¸ªäº¤æ˜“çš„é¡ºåºï¼Œéƒ½ä¼šå¯¼è‡´Merkle HashéªŒè¯å¤±è´¥ï¼Œä¹Ÿå°±ä¼šå¯¼è‡´è¿™ä¸ªåŒºå—æœ¬èº«æ˜¯æ— æ•ˆçš„ï¼Œæ‰€ä»¥ï¼ŒMerkle Hashè®°å½•åœ¨åŒºå—å¤´éƒ¨ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ä¿è¯äº¤æ˜“è®°å½•æ°¸è¿œæ— æ³•ä¿®æ”¹ã€‚&lt;/p&gt;

&lt;h3 id=&quot;block-hash&quot;&gt;Block Hash&lt;/h3&gt;

&lt;p&gt;åŒºå—æœ¬èº«ç”¨Block Hashâ€”â€”ä¹Ÿå°±æ˜¯åŒºå—å“ˆå¸Œæ¥æ ‡è¯†ã€‚ä½†æ˜¯ï¼Œä¸€ä¸ªåŒºå—è‡ªå·±çš„åŒºå—å“ˆå¸Œå¹¶æ²¡æœ‰è®°å½•åœ¨åŒºå—å¤´éƒ¨ï¼Œè€Œæ˜¯é€šè¿‡è®¡ç®—åŒºå—å¤´éƒ¨çš„å“ˆå¸Œå¾—åˆ°çš„ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202507131010632.jpg&quot; alt=&quot;Block Hash&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åŒºå—å¤´éƒ¨çš„Prev Hashè®°å½•äº†ä¸Šä¸€ä¸ªåŒºå—çš„Block Hashï¼Œè¿™æ ·ï¼Œå¯ä»¥é€šè¿‡Prev Hashè¿½è¸ªåˆ°ä¸Šä¸€ä¸ªåŒºå—ã€‚&lt;/p&gt;

&lt;p&gt;ç”±äºä¸‹ä¸€ä¸ªåŒºå—çš„Prev Hashåˆä¼šæŒ‡å‘å½“å‰åŒºå—ï¼Œè¿™æ ·ï¼Œæ¯ä¸ªåŒºå—çš„Prev Hashéƒ½æŒ‡å‘è‡ªå·±çš„ä¸Šä¸€ä¸ªåŒºå—ï¼Œè¿™äº›åŒºå—ä¸²èµ·æ¥å°±å½¢æˆäº†åŒºå—é“¾ã€‚&lt;/p&gt;

&lt;p&gt;åŒºå—é“¾çš„ç¬¬ä¸€ä¸ªåŒºå—ï¼ˆåˆç§°åˆ›ä¸–åŒºå—ï¼‰å¹¶æ²¡æœ‰ä¸Šä¸€ä¸ªåŒºå—ï¼Œå› æ­¤ï¼Œå®ƒçš„Prev Hashè¢«è®¾ç½®ä¸º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;00000000...000&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä¸€ä¸ªæ¶æ„çš„æ”»å‡»è€…ä¿®æ”¹äº†ä¸€ä¸ªåŒºå—ä¸­çš„æŸä¸ªäº¤æ˜“ï¼Œé‚£ä¹ˆMerkle HashéªŒè¯å°±ä¸ä¼šé€šè¿‡ã€‚æ‰€ä»¥ï¼Œä»–åªèƒ½é‡æ–°è®¡ç®—Merkle Hashï¼Œç„¶åæŠŠåŒºå—å¤´çš„Merkle Hashä¹Ÿä¿®æ”¹äº†ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°ï¼Œè¿™ä¸ªåŒºå—æœ¬èº«çš„Block Hashå°±å˜äº†ï¼Œæ‰€ä»¥ï¼Œä¸‹ä¸€ä¸ªåŒºå—æŒ‡å‘å®ƒçš„é“¾æ¥å°±æ–­æ‰äº†ã€‚&lt;/p&gt;

&lt;p&gt;ç”±äºæ¯”ç‰¹å¸åŒºå—çš„å“ˆå¸Œå¿…é¡»æ»¡è¶³ä¸€ä¸ªéš¾åº¦å€¼ï¼Œå› æ­¤ï¼Œæ”»å‡»è€…å¿…é¡»å…ˆé‡æ–°è®¡ç®—è¿™ä¸ªåŒºå—çš„Block Hashï¼Œç„¶åï¼Œå†æŠŠåç»­æ‰€æœ‰åŒºå—å…¨éƒ¨é‡æ–°è®¡ç®—å¹¶ä¸”ä¼ªé€ å‡ºæ¥ï¼Œæ‰èƒ½å¤Ÿä¿®æ”¹æ•´ä¸ªåŒºå—é“¾ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨åé¢çš„æŒ–çŸ¿ä¸­ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œä¿®æ”¹ä¸€ä¸ªåŒºå—çš„æˆæœ¬å°±å·²ç»éå¸¸éå¸¸é«˜äº†ï¼Œè¦ä¿®æ”¹åç»­æ‰€æœ‰åŒºå—ï¼Œè¿™ä¸ªæ”»å‡»è€…å¿…é¡»æŒæ¡å…¨ç½‘51%ä»¥ä¸Šçš„ç®—åŠ›æ‰è¡Œï¼Œæ‰€ä»¥ï¼Œä¿®æ”¹åŒºå—é“¾çš„éš¾åº¦æ˜¯éå¸¸éå¸¸å¤§çš„ï¼Œå¹¶ä¸”ï¼Œç”±äºæ­£å¸¸çš„åŒºå—é“¾åœ¨ä¸æ–­å¢é•¿ï¼ŒåŒæ ·ä¸€ä¸ªåŒºå—ï¼Œä¿®æ”¹å®ƒçš„éš¾åº¦ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œä¸æ–­å¢åŠ ã€‚&lt;/p&gt;

&lt;h2 id=&quot;p2päº¤æ˜“åŸç†&quot;&gt;P2Päº¤æ˜“åŸç†&lt;/h2&gt;

&lt;h3 id=&quot;æ•°å­—ç­¾åç®—æ³•&quot;&gt;æ•°å­—ç­¾åç®—æ³•&lt;/h3&gt;

&lt;p&gt;å¸¸ç”¨çš„æ•°å­—ç­¾åç®—æ³•æœ‰ï¼šRSAç®—æ³•ï¼ŒDSAç®—æ³•å’ŒECDSAç®—æ³•ã€‚æ¯”ç‰¹å¸é‡‡ç”¨çš„ç­¾åç®—æ³•æ˜¯æ¤­åœ†æ›²çº¿ç­¾åç®—æ³•ï¼šECDSAï¼Œä½¿ç”¨çš„æ¤­åœ†æ›²çº¿æ˜¯ä¸€ä¸ªå·²ç»å®šä¹‰å¥½çš„æ ‡å‡†æ›²çº¿secp256k1ï¼š&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸é‡‡ç”¨çš„ECDSAç­¾åç®—æ³•éœ€è¦ä¸€ä¸ªç§é’¥å’Œå…¬é’¥ç»„æˆçš„ç§˜é’¥å¯¹ï¼šç§é’¥æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª1ï½2256çš„éšæœºæ•°ï¼Œå…¬é’¥æ˜¯ç”±ç§é’¥æ ¹æ®ECDSAç®—æ³•æ¨ç®—å‡ºæ¥çš„ï¼Œé€šè¿‡ç§é’¥å¯ä»¥å¾ˆå®¹æ˜“æ¨ç®—å‡ºå…¬é’¥ï¼Œæ‰€ä»¥ä¸å¿…ä¿å­˜å…¬é’¥ï¼Œä½†æ˜¯ï¼Œé€šè¿‡å…¬é’¥æ— æ³•åæ¨ç§é’¥ï¼Œåªèƒ½æš´åŠ›ç ´è§£ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„ç§é’¥æ˜¯ä¸€ä¸ªéšæœºçš„éå¸¸å¤§çš„256ä½æ•´æ•°ã€‚å®ƒçš„ä¸Šé™ï¼Œç¡®åˆ‡åœ°è¯´ï¼Œæ¯”2256è¦ç¨å¾®å°ä¸€ç‚¹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-plain&quot;&gt;0xFFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFE BAAE DCE6 AF48 A03B BFD2 5E8C D036 4140
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è€Œæ¯”ç‰¹å¸çš„å…¬é’¥æ˜¯æ ¹æ®ç§é’¥æ¨ç®—å‡ºçš„ä¸¤ä¸ª256ä½æ•´æ•°ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœç”¨é“¶è¡Œå¡ä½œæ¯”è¾ƒçš„è¯ï¼Œæ¯”ç‰¹å¸çš„å…¬é’¥ç›¸å½“äºé“¶è¡Œå¡å¡å·ï¼Œå®ƒæ˜¯ä¸¤ä¸ª256ä½æ•´æ•°ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://liaoxuefeng.com/books/blockchain/bitcoin/p2p/bitcoin-card.png&quot; alt=&quot;bitcoin-card&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„ç§é’¥ç›¸å½“äºé“¶è¡Œå¡å¯†ç ï¼Œå®ƒæ˜¯ä¸€ä¸ª256ä½æ•´æ•°ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-plain&quot;&gt;18E14A7B6A307F426A94F8114701E7C8E774E7F9A47E2C2035DB29A206321725
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ¯”ç‰¹å¸é’±åŒ…å®é™…ä¸Šå°±æ˜¯å¸®åŠ©ç”¨æˆ·ç®¡ç†ç§é’¥çš„è½¯ä»¶ã€‚å› ä¸ºæ¯”ç‰¹å¸çš„é’±åŒ…æ˜¯ç»™æ™®é€šç”¨æˆ·ä½¿ç”¨çš„ï¼Œå®ƒæœ‰å‡ ç§åˆ†ç±»ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æœ¬åœ°é’±åŒ…ï¼šæ˜¯æŠŠç§é’¥ä¿å­˜åœ¨æœ¬åœ°è®¡ç®—æœºç¡¬ç›˜ä¸Šçš„é’±åŒ…è½¯ä»¶ï¼Œå¦‚&lt;a href=&quot;https://electrum.org/&quot;&gt;Electrum&lt;/a&gt;ï¼›&lt;/li&gt;
  &lt;li&gt;æ‰‹æœºé’±åŒ…ï¼šå’Œæœ¬åœ°é’±åŒ…ç±»ä¼¼ï¼Œä½†å¯ä»¥ç›´æ¥åœ¨æ‰‹æœºä¸Šè¿è¡Œï¼Œå¦‚&lt;a href=&quot;https://bitpay.com/&quot;&gt;Bitpay&lt;/a&gt;ï¼›&lt;/li&gt;
  &lt;li&gt;åœ¨çº¿é’±åŒ…ï¼šæ˜¯æŠŠç§é’¥å§”æ‰˜ç»™ç¬¬ä¸‰æ–¹åœ¨çº¿æœåŠ¡å•†ä¿å­˜ï¼›&lt;/li&gt;
  &lt;li&gt;çº¸é’±åŒ…ï¼šæ˜¯æŒ‡æŠŠç§é’¥æ‰“å°å‡ºæ¥ä¿å­˜åœ¨çº¸ä¸Šï¼›&lt;/li&gt;
  &lt;li&gt;è„‘é’±åŒ…ï¼šæ˜¯æŒ‡æŠŠç§é’¥è®°åœ¨è‡ªå·±è„‘è¢‹é‡Œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¯¹å¤§å¤šæ•°æ™®é€šç”¨æˆ·æ¥è¯´ï¼Œæƒ³è¦è®°ä½ç§é’¥éå¸¸å›°éš¾ï¼Œæ‰€ä»¥&lt;em&gt;å¼ºçƒˆä¸å»ºè®®ä½¿ç”¨è„‘é’±åŒ…&lt;/em&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;äº¤æ˜“&quot;&gt;äº¤æ˜“&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://liaoxuefeng.com/books/blockchain/bitcoin/p2p/index.html#:~:text=%E5%85%AC%E9%92%A5%E5%AF%B9%E3%80%82-,%E4%BA%A4%E6%98%93,-%E6%88%91%E4%BB%AC%E5%86%8D%E6%9D%A5%E7%9C%8B&quot;&gt;å‚è€ƒ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è®°å½•åœ¨åŒºå—é“¾ä¸Šçš„äº¤æ˜“ã€‚æ¯ä¸ªåŒºå—éƒ½è®°å½•äº†è‡³å°‘ä¸€ç¬”äº¤æ˜“ï¼Œä¸€ç¬”äº¤æ˜“å°±æ˜¯æŠŠä¸€å®šé‡‘é¢çš„æ¯”ç‰¹å¸ä»ä¸€ä¸ªè¾“å…¥è½¬ç§»åˆ°ä¸€ä¸ªè¾“å‡º&lt;/p&gt;

&lt;p&gt;åœ¨å®é™…çš„äº¤æ˜“ä¸­ï¼Œè¾“å…¥æ¯”è¾“å‡ºè¦ç¨å¾®å¤§ä¸€ç‚¹ç‚¹ï¼Œè¿™ä¸ªå·®é¢å°±æ˜¯éšå«çš„äº¤æ˜“è´¹ç”¨ï¼Œäº¤æ˜“è´¹ç”¨ä¼šç®—å…¥å½“å‰åŒºå—çš„çŸ¿å·¥æ”¶å…¥ä¸­ä½œä¸ºçŸ¿å·¥å¥–åŠ±çš„ä¸€éƒ¨åˆ†ï¼š&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸å®é™…çš„äº¤æ˜“è®°å½•æ˜¯ç”±ä¸€ç³»åˆ—äº¤æ˜“æ„æˆï¼Œæ¯ä¸€ä¸ªäº¤æ˜“éƒ½åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥ï¼Œä»¥åŠä¸€ä¸ªæˆ–å¤šä¸ªè¾“å‡ºã€‚æœªèŠ±è´¹çš„è¾“å‡ºè¢«ç§°ä¸ºUTXOï¼šUnspent Transaction Outputã€‚&lt;/p&gt;

&lt;p&gt;å½“æˆ‘ä»¬è¦ç®€å•éªŒè¯æŸä¸ªäº¤æ˜“çš„æ—¶å€™ï¼Œä¾‹å¦‚ï¼Œå¯¹äºäº¤æ˜“&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;f36abd&lt;/code&gt;ï¼Œå®ƒè®°å½•çš„è¾“å…¥æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3f96ab&lt;/code&gt;ï¼Œç´¢å¼•å·æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1&lt;/code&gt;ï¼ˆç´¢å¼•å·ä»&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0&lt;/code&gt;å¼€å§‹ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0&lt;/code&gt;è¡¨ç¤ºç¬¬ä¸€ä¸ªè¾“å‡ºï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1&lt;/code&gt;è¡¨ç¤ºç¬¬äºŒä¸ªè¾“å‡ºï¼Œä»¥æ­¤ç±»æ¨ï¼‰ï¼Œæˆ‘ä»¬å°±æ ¹æ®&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3f96ab&lt;/code&gt;æ‰¾åˆ°å‰é¢å·²å‘ç”Ÿçš„äº¤æ˜“ï¼Œå†æ ¹æ®ç´¢å¼•å·æ‰¾åˆ°å¯¹åº”çš„è¾“å‡ºæ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0.5&lt;/code&gt;ä¸ªæ¯”ç‰¹å¸ï¼Œæ‰€ä»¥ï¼Œè¿™ç¬”äº¤æ˜“çš„è¾“å…¥æ€»è®¡æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0.5&lt;/code&gt;ä¸ªæ¯”ç‰¹å¸ï¼Œè¾“å‡ºåˆ†åˆ«æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0.4&lt;/code&gt;ä¸ªæ¯”ç‰¹å¸å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0.09&lt;/code&gt;ä¸ªæ¯”ç‰¹å¸ï¼Œéšå«çš„äº¤æ˜“è´¹ç”¨æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0.01&lt;/code&gt;ä¸ªæ¯”ç‰¹å¸ï¼š&lt;/p&gt;

&lt;h3 id=&quot;åœ°å€&quot;&gt;åœ°å€&lt;/h3&gt;

&lt;p&gt;è¦ç‰¹åˆ«æ³¨æ„ï¼Œæ¯”ç‰¹å¸çš„åœ°å€å¹¶ä¸æ˜¯å…¬é’¥ï¼Œè€Œæ˜¯å…¬é’¥çš„å“ˆå¸Œï¼Œå³ä»å…¬é’¥èƒ½æ¨å¯¼å‡ºåœ°å€ï¼Œä½†ä»åœ°å€ä¸èƒ½åæ¨å…¬é’¥ï¼Œå› ä¸ºå“ˆå¸Œå‡½æ•°æ˜¯å•å‘å‡½æ•°ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„å…¬é’¥æ˜¯æ ¹æ®ç§é’¥ç”±ECDSAç®—æ³•æ¨ç®—å‡ºæ¥çš„ï¼Œå…¬é’¥æœ‰å‹ç¼©å’Œéå‹ç¼©ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼Œå¯äº’ç›¸è½¬æ¢ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„åœ°å€æ˜¯å…¬é’¥å“ˆå¸Œçš„ç¼–ç ï¼Œå¹¶ä¸æ˜¯å…¬é’¥æœ¬èº«ï¼Œé€šè¿‡å…¬é’¥å¯æ¨å¯¼å‡ºåœ°å€ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æŒ–çŸ¿åŸç†&quot;&gt;æŒ–çŸ¿åŸç†&lt;/h2&gt;

&lt;p&gt;åœ¨æ¯”ç‰¹å¸çš„P2Pç½‘ç»œä¸­ï¼Œæœ‰ä¸€ç±»èŠ‚ç‚¹ï¼Œå®ƒä»¬æ—¶åˆ»ä¸åœåœ°è¿›è¡Œè®¡ç®—ï¼Œè¯•å›¾æŠŠæ–°çš„äº¤æ˜“æ‰“åŒ…æˆæ–°çš„åŒºå—å¹¶é™„åŠ åˆ°åŒºå—é“¾ä¸Šï¼Œè¿™ç±»èŠ‚ç‚¹å°±æ˜¯çŸ¿å·¥ã€‚å› ä¸ºæ¯æ‰“åŒ…ä¸€ä¸ªæ–°çš„åŒºå—ï¼Œæ‰“åŒ…è¯¥åŒºå—çš„çŸ¿å·¥å°±å¯ä»¥è·å¾—ä¸€ç¬”æ¯”ç‰¹å¸ä½œä¸ºå¥–åŠ±ã€‚æ‰€ä»¥ï¼Œæ‰“åŒ…æ–°åŒºå—å°±è¢«ç§°ä¸ºæŒ–çŸ¿ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„æŒ–çŸ¿åŸç†å°±æ˜¯ä¸€ç§å·¥ä½œé‡è¯æ˜æœºåˆ¶ã€‚å·¥ä½œé‡è¯æ˜POWæ˜¯è‹±æ–‡Proof of Workçš„ç¼©å†™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;pow&quot;&gt;PoW&lt;/h3&gt;

&lt;p&gt;è¦è®©è®¡ç®—æœºå®ç°å·¥ä½œé‡è¯æ˜ï¼Œå¿…é¡»æ‰¾åˆ°ä¸€ç§å·¥ä½œé‡ç®—æ³•ï¼Œè®©è®¡ç®—æœºæ— æ³•åœ¨çŸ­æ—¶é—´å†…ç®—å‡ºæ¥ã€‚è¿™ç§ç®—æ³•å°±æ˜¯å“ˆå¸Œç®—æ³•ã€‚&lt;/p&gt;

&lt;p&gt;é€šè¿‡æ”¹å˜åŒºå—å¤´éƒ¨çš„ä¸€ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nonce&lt;/code&gt;å­—æ®µçš„å€¼ï¼Œè®¡ç®—æœºå¯ä»¥è®¡ç®—å‡ºä¸åŒçš„åŒºå—å“ˆå¸Œå€¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202507131205860.jpg&quot; alt=&quot;è®¡ç®—åŒºå—å“ˆå¸Œ&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç›´åˆ°è®¡ç®—å‡ºæŸä¸ªç‰¹å®šçš„å“ˆå¸Œå€¼çš„æ—¶å€™ï¼Œè®¡ç®—ç»“æŸã€‚è¿™ä¸ªå“ˆå¸Œå’Œå…¶ä»–çš„å“ˆå¸Œç›¸æ¯”ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯å‰é¢æœ‰å¥½å‡ ä¸ª0ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-plain&quot;&gt;hash256(block data, nonce=0) = 291656f37cdcf493c4bb7b926e46fee5c14f9b76aff28f9d00f5cca0e54f376f
hash256(block data, nonce=1) = f7b2c15c4de7f482edee9e8db7287a6c5def1c99354108ef33947f34d891ea8d
hash256(block data, nonce=2) = b6eebc5faa4c44d9f5232631f39ddf4211443d819208da110229b644d2a99e12
hash256(block data, nonce=3) = 00aeaaf01166a93a2217fe01021395b066dd3a81daffcd16626c308c644c5246
hash256(block data, nonce=4) = 26d33671119c9180594a91a2f1f0eb08bdd0b595e3724050acb68703dc99f9b5
hash256(block data, nonce=5) = 4e8a3dcab619a7ce5c68e8f4abdc49f98de1a71e58f0ce9a0d95e024cce7c81a
hash256(block data, nonce=6) = 185f634d50b17eba93b260a911ba6dbe9427b72f74f8248774930c0d8588c193
hash256(block data, nonce=7) = 09b19f3d32e3e5771bddc5f0e1ee3c1bac1ba4a85e7b2cc30833a120e41272ed
...
hash256(block data, nonce=124709132) = 00000000fba7277ef31c8ecd1f3fef071cf993485fe5eab08e4f7647f47be95c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ¯”ç‰¹å¸æŒ–çŸ¿çš„å·¥ä½œé‡è¯æ˜åŸç†å°±æ˜¯ï¼Œä¸æ–­å°è¯•è®¡ç®—åŒºå—çš„å“ˆå¸Œï¼Œç›´åˆ°è®¡ç®—å‡ºä¸€ä¸ªç‰¹å®šçš„å“ˆå¸Œå€¼ï¼Œå®ƒæ¯”éš¾åº¦å€¼è¦å°ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å¯¹äºæ¯”ç‰¹å¸æŒ–çŸ¿æ¥è¯´ï¼Œå°±æ˜¯å…ˆç»™å®šä¸€ä¸ªéš¾åº¦å€¼ï¼Œç„¶åä¸æ–­å˜æ¢&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nonce&lt;/code&gt;ï¼Œè®¡ç®—Block Hashï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ¯”ç»™å®šéš¾åº¦å€¼ä½çš„Block Hashï¼Œå°±ç®—æˆåŠŸæŒ–çŸ¿ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ³¨æ„ï¼Œéš¾åº¦å€¼çš„&lt;em&gt;æ•°å€¼&lt;/em&gt;è¶Šå°ï¼Œè¯´æ˜å“ˆå¸Œå€¼å‰é¢çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0&lt;/code&gt;è¶Šå¤šï¼Œè®¡ç®—çš„éš¾åº¦è¶Šå¤§ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸ç½‘ç»œçš„éš¾åº¦æ˜¯ä¸æ–­å˜åŒ–çš„ï¼Œå®ƒçš„éš¾åº¦ä¿è¯å¤§çº¦æ¯10åˆ†é’Ÿäº§ç”Ÿä¸€ä¸ªåŒºå—ï¼Œè€Œéš¾åº¦å€¼åœ¨æ¯2015ä¸ªåŒºå—è°ƒæ•´ä¸€æ¬¡ï¼šå¦‚æœåŒºå—å¹³å‡ç”Ÿæˆæ—¶é—´å°äº10åˆ†é’Ÿï¼Œè¯´æ˜å…¨ç½‘ç®—åŠ›å¢åŠ ï¼Œéš¾åº¦ä¹Ÿä¼šå¢åŠ ï¼Œå¦‚æœåŒºå—å¹³å‡ç”Ÿæˆæ—¶é—´å¤§äº10åˆ†é’Ÿï¼Œè¯´æ˜å…¨ç½‘ç®—åŠ›å‡å°‘ï¼Œéš¾åº¦ä¹Ÿä¼šå‡å°‘ã€‚å› æ­¤ï¼Œéš¾åº¦éšç€å…¨ç½‘ç®—åŠ›çš„å¢å‡ä¼šåŠ¨æ€è°ƒæ•´ã€‚&lt;/p&gt;

&lt;p&gt;æ ¹æ®æ¯”ç‰¹å¸æ¯ä¸ªåŒºå—çš„éš¾åº¦å€¼å’Œäº§å‡ºæ—¶é—´ï¼Œå°±å¯ä»¥æ¨ç®—å‡ºæ•´ä¸ªæ¯”ç‰¹å¸ç½‘ç»œçš„å…¨ç½‘ç®—åŠ›ã€‚æ‰€ä»¥æ¯”ç‰¹å¸çš„å·¥ä½œé‡è¯æ˜è¢«é€šä¿—åœ°ç§°ä¹‹ä¸ºæŒ–çŸ¿ã€‚åœ¨åŒä¸€æ—¶é—´ï¼Œæ‰€æœ‰çŸ¿å·¥éƒ½åœ¨åŠªåŠ›è®¡ç®—ä¸‹ä¸€ä¸ªåŒºå—çš„å“ˆå¸Œã€‚è€ŒæŒ–çŸ¿éš¾åº¦å–å†³äºå…¨ç½‘æ€»ç®—åŠ›çš„ç™¾åˆ†æ¯”ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾å°æ˜æ‹¥æœ‰å…¨ç½‘æ€»ç®—åŠ›çš„ç™¾åˆ†ä¹‹ä¸€ï¼Œé‚£ä¹ˆä»–æŒ–åˆ°ä¸‹ä¸€ä¸ªåŒºå—çš„å¯èƒ½æ€§å°±æ˜¯1%ï¼Œæˆ–è€…è¯´ï¼Œæ¯æŒ–å‡º100ä¸ªåŒºå—ï¼Œå¤§çº¦æœ‰1ä¸ªå°±æ˜¯å°æ˜æŒ–çš„ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºä»€ä¹ˆåŒºå—å¯ä»¥å®‰å…¨å¹¿æ’­ï¼Ÿå› ä¸ºMerkle Hashé”å®šäº†è¯¥åŒºå—çš„æ‰€æœ‰äº¤æ˜“ï¼Œè€Œè¯¥åŒºå—çš„ç¬¬ä¸€ä¸ªcoinbaseäº¤æ˜“è¾“å‡ºåœ°å€æ˜¯è¯¥çŸ¿å·¥åœ°å€ã€‚æ¯ä¸ªçŸ¿å·¥åœ¨æŒ–çŸ¿æ—¶äº§ç”Ÿçš„åŒºå—æ•°æ®éƒ½æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥æ— æ³•çªƒå–åˆ«äººçš„å·¥ä½œé‡ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸æ€»é‡è¢«é™åˆ¶ä¸ºçº¦2100ä¸‡ä¸ªæ¯”ç‰¹å¸ï¼Œåˆå§‹æŒ–çŸ¿å¥–åŠ±ä¸ºæ¯ä¸ªåŒºå—50ä¸ªæ¯”ç‰¹å¸ï¼Œä»¥åæ¯4å¹´å‡åŠã€‚&lt;/p&gt;

&lt;h3 id=&quot;åˆ†å‰&quot;&gt;åˆ†å‰&lt;/h3&gt;

&lt;p&gt;å¦‚æœä¸¤ä¸ªçŸ¿å·¥åœ¨åŒä¸€æ—¶é—´å„è‡ªæ‰¾åˆ°äº†æœ‰æ•ˆåŒºå—ï¼Œæ³¨æ„ï¼Œè¿™ä¸¤ä¸ªåŒºå—æ˜¯ä¸åŒçš„ï¼Œå› ä¸ºcoinbaseäº¤æ˜“ä¸åŒï¼Œæ‰€ä»¥Merkle Hashä¸åŒï¼ŒåŒºå—å“ˆå¸Œä¹Ÿä¸åŒã€‚ä½†å®ƒä»¬åªè¦ç¬¦åˆéš¾åº¦å€¼ï¼Œå°±éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚è¿™ä¸ªæ—¶å€™ï¼Œç½‘ç»œä¸Šçš„å…¶ä»–çŸ¿å·¥åº”è¯¥æ¥æ”¶å“ªä¸ªåŒºå—å¹¶æ·»åŠ åˆ°åŒºå—é“¾çš„æœ«å°¾å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œéƒ½æœ‰å¯èƒ½ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯æœ€ç»ˆï¼Œæ€»æœ‰ä¸€ä¸ªåˆ†å‰é¦–å…ˆæŒ–åˆ°åç»­åŒºå—ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œç”±äºæ¯”ç‰¹å¸ç½‘ç»œé‡‡ç”¨æœ€é•¿åˆ†å‰çš„å…±è¯†ç®—æ³•ï¼Œç»¿è‰²åˆ†å‰èƒœå‡ºï¼Œè“è‰²åˆ†å‰è¢«åºŸå¼ƒï¼Œæ•´ä¸ªç½‘ç»œä¸Šçš„æ‰€æœ‰çŸ¿å·¥åˆä¼šç»§ç»­åœ¨æœ€é•¿çš„é“¾ä¸Šç»§ç»­æŒ–çŸ¿ã€‚&lt;/p&gt;

&lt;p&gt;ç”±äºåŒºå—é“¾è™½ç„¶æœ€ç»ˆä¼šä¿æŒæ•°æ®ä¸€è‡´ï¼Œä½†æ˜¯ï¼Œä¸€ä¸ªäº¤æ˜“å¯èƒ½è¢«æ‰“åŒ…åˆ°ä¸€ä¸ªåç»­è¢«å­¤ç«‹çš„åŒºå—ä¸­ã€‚æ‰€ä»¥ï¼Œè¦ç¡®è®¤ä¸€ä¸ªäº¤æ˜“è¢«æ°¸ä¹…è®°å½•åˆ°åŒºå—é“¾ä¸­ï¼Œéœ€è¦å¯¹äº¤æ˜“è¿›è¡Œç¡®è®¤ã€‚å¦‚æœåç»­çš„åŒºå—è¢«è¿½åŠ åˆ°åŒºå—é“¾ä¸Šï¼Œå®é™…ä¸Šå°±ä¼šå¯¹åŸæœ‰çš„äº¤æ˜“è¿›è¡Œç¡®è®¤ï¼Œå› ä¸ºé“¾è¶Šé•¿ï¼Œä¿®æ”¹çš„éš¾åº¦è¶Šå¤§ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç»è¿‡6ä¸ªåŒºå—ç¡®è®¤çš„äº¤æ˜“å‡ ä¹æ˜¯ä¸å¯èƒ½è¢«ä¿®æ”¹çš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;å¯ç¼–ç¨‹æ”¯ä»˜åŸç†&quot;&gt;å¯ç¼–ç¨‹æ”¯ä»˜åŸç†&lt;/h2&gt;

&lt;h3 id=&quot;é”å®šè„šæœ¬å’Œè§£é”è„šæœ¬&quot;&gt;é”å®šè„šæœ¬å’Œè§£é”è„šæœ¬&lt;/h3&gt;

&lt;p&gt;æ¯”ç‰¹å¸é‡‡ç”¨è„šæœ¬çš„æ–¹å¼è¿›è¡Œå¯ç¼–ç¨‹æ”¯ä»˜ï¼šé€šè¿‡æ‰§è¡Œè§£é”è„šæœ¬ç¡®è®¤æŸä¸ªUTXOçš„èµ„äº§å¯ä»¥è¢«ç§é’¥æŒæœ‰äººè½¬ç§»ç»™å…¶ä»–äººã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„æ”¯ä»˜å®é™…ä¸Šå¹¶ä¸æ˜¯ç›´æ¥æ”¯ä»˜åˆ°å¯¹æ–¹çš„åœ°å€ï¼Œè€Œæ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬çš„æ„æ€æ˜¯ï¼šè°èƒ½å¤Ÿæä¾›å¦å¤–ä¸€ä¸ªè„šæœ¬ï¼Œè®©è¿™ä¸¤ä¸ªè„šæœ¬èƒ½é¡ºåˆ©æ‰§è¡Œé€šè¿‡ï¼Œè°å°±èƒ½èŠ±æ‰è¿™ç¬”é’±ï¼š&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œæ¯”ç‰¹å¸äº¤æ˜“çš„è¾“å‡ºæ˜¯ä¸€ä¸ªé”å®šè„šæœ¬ï¼Œè€Œä¸‹ä¸€ä¸ªäº¤æ˜“çš„è¾“å…¥æ˜¯ä¸€ä¸ªè§£é”è„šæœ¬ã€‚å¿…é¡»æä¾›ä¸€ä¸ªè§£é”è„šæœ¬ï¼Œè®©é”å®šè„šæœ¬æ­£ç¡®è¿è¡Œï¼Œé‚£ä¹ˆè¯¥è¾“å…¥æœ‰æ•ˆï¼Œå°±å¯ä»¥èŠ±è´¹è¯¥è¾“å‡ºã€‚&lt;/p&gt;

&lt;p&gt;å½“å°æ˜ç»™å°çº¢æ”¯ä»˜ä¸€ç¬”æ¯”ç‰¹å¸æ—¶ï¼Œå®é™…ä¸Šå°æ˜åˆ›å»ºäº†ä¸€ä¸ªé”å®šè„šæœ¬ï¼Œè¯¥é”å®šè„šæœ¬ä¸­å¼•å…¥äº†å°çº¢çš„åœ°å€ã€‚è¦æƒ³é€šè¿‡è§£é”è„šæœ¬èŠ±è´¹è¯¥è¾“å‡ºï¼Œåªæœ‰æŒæœ‰å¯¹åº”ç§é’¥çš„å°çº¢æ‰èƒ½åˆ›å»ºæ­£ç¡®çš„è§£é”è„šæœ¬ï¼ˆå› ä¸ºè§£é”è„šæœ¬åŒ…å«çš„ç­¾ååªæœ‰å°çº¢çš„ç§é’¥æ‰èƒ½åˆ›å»ºï¼‰ï¼Œå› æ­¤ï¼Œå°çº¢äº‹å®ä¸Šæ‹¥æœ‰äº†èŠ±è´¹è¯¥è¾“å‡ºçš„æƒåˆ©ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨é’±åŒ…è½¯ä»¶åˆ›å»ºçš„äº¤æ˜“éƒ½æ˜¯æ ‡å‡†çš„æ”¯ä»˜è„šæœ¬ï¼Œä½†æ˜¯ï¼Œæ¯”ç‰¹å¸çš„äº¤æ˜“æœ¬è´¨æ˜¯æˆåŠŸæ‰§è¡Œè§£é”è„šæœ¬å’Œé”å®šè„šæœ¬ï¼Œæ‰€ä»¥ï¼Œå¯ä»¥ç¼–å†™å„ç§ç¬¦åˆæ¡ä»¶çš„è„šæœ¬ã€‚æ¯”å¦‚ï¼Œæœ‰äººåˆ›å»ºäº†ä¸€ä¸ªäº¤æ˜“ï¼Œå®ƒçš„é”å®šè„šæœ¬åƒè¿™æ ·ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-plain&quot;&gt;OP_HASH256
      DATA 6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000000
  OP_EQUAL
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æœ‰ç‚¹åƒä¸€ä¸ªæ•°å­¦è°œé¢˜ã€‚å®ƒçš„æ„æ€æ˜¯è¯´ï¼Œè°èƒ½å¤Ÿæä¾›ä¸€ä¸ªæ•°æ®ï¼Œå®ƒçš„hash256ç­‰äº&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;6fe28c0a...&lt;/code&gt;ï¼Œè°å°±å¯ä»¥èŠ±è´¹è¿™ç¬”è¾“å‡ºã€‚æ‰€ä»¥ï¼Œè§£é”è„šæœ¬å®é™…ä¸Šåªéœ€è¦æä¾›ä¸€ä¸ªæ­£ç¡®çš„æ•°æ®ï¼Œå°±å¯ä»¥èŠ±è´¹è¿™ç¬”è¾“å‡ºã€‚ç‚¹&lt;a href=&quot;https://btc.com/a4bfa8ab6435ae5f25dae9d89e4eb67dfa94283ca751f393c1ddc5a837bbc31b&quot;&gt;è¿™é‡Œ&lt;/a&gt;æŸ¥çœ‹è°èŠ±è´¹äº†è¯¥è¾“å‡ºã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„è„šæœ¬é€šè¿‡ä¸åŒçš„æŒ‡ä»¤è¿˜å¯ä»¥å®ç°æ›´çµæ´»çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œå¤šé‡ç­¾åå¯ä»¥è®©ä¸€ç¬”äº¤æ˜“åªæœ‰åœ¨å¤šæ•°äººåŒæ„çš„æƒ…å†µä¸‹æ‰èƒ½å¤Ÿè¿›è¡Œã€‚æœ€å¸¸è§çš„å¤šé‡ç­¾åè„šæœ¬å¯ä»¥æä¾›3ä¸ªç­¾åï¼Œåªè¦ä»»æ„ä¸¤ä¸ªç­¾åè¢«éªŒè¯æˆåŠŸï¼Œè¿™ç¬”äº¤æ˜“å°±å¯ä»¥æˆåŠŸã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-plain&quot;&gt;FROM: UTXO Hash#index
AMOUNT: 10.5 btc
TO: P2SH: OP_2 pk1 pk2 pk3 OP_3 OP_CHECKMULTISIG
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œ3ä¸ªäººä¸­ï¼Œåªè¦ä»»æ„ä¸¤ä¸ªäººåŒæ„ç”¨ä»–ä»¬çš„ç§é’¥æä¾›ç­¾åï¼Œå°±å¯ä»¥å®Œæˆäº¤æ˜“ã€‚è¿™ç§æ–¹å¼ä¹Ÿå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢ä¸¢å¤±ç§é’¥çš„é£é™©ã€‚3ä¸ªäººä¸­å¦‚æœåªæœ‰ä¸€ä¸ªäººä¸¢å¤±äº†ç§é’¥ï¼Œä»ç„¶å¯ä»¥ä¿è¯è¿™ç¬”è¾“å‡ºæ˜¯å¯ä»¥è¢«èŠ±è´¹çš„ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„è„šæœ¬ä¸å«æ¡ä»¶åˆ¤æ–­ã€å¾ªç¯ç­‰å¤æ‚ç»“æ„ã€‚ä¸Šè¿°è„šæœ¬å°±æ˜¯å¯¹è¾“å…¥çš„ä¸¤ä¸ªæ•°æ®è§†ä½œç­¾åå’Œå…¬é’¥ï¼Œç„¶åå…ˆéªŒè¯å…¬é’¥å“ˆå¸Œæ˜¯å¦ä¸åœ°å€ç›¸åŒï¼Œå†æ ¹æ®å…¬é’¥éªŒè¯ç­¾åï¼Œè¿™ç§æ ‡å‡†è„šæœ¬ç§°ä¹‹ä¸ºP2PKHï¼ˆPay to Public Key Hashï¼‰è„šæœ¬ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å¤šé‡ç­¾å&quot;&gt;å¤šé‡ç­¾å&lt;/h3&gt;

&lt;p&gt;ç”±æ¯”ç‰¹å¸çš„ç­¾åæœºåˆ¶å¯çŸ¥ï¼Œå¦‚æœä¸¢å¤±äº†ç§é’¥ï¼Œæ²¡æœ‰ä»»ä½•åŠæ³•å¯ä»¥èŠ±è´¹å¯¹åº”åœ°å€çš„èµ„é‡‘ã€‚&lt;/p&gt;

&lt;p&gt;è¿™æ ·å°±ä½¿å¾—å› ä¸ºä¸¢å¤±ç§é’¥å¯¼è‡´èµ„é‡‘ä¸¢å¤±çš„é£é™©ä¼šå¾ˆé«˜ã€‚ä¸ºäº†é¿å…ä¸€ä¸ªç§é’¥çš„ä¸¢å¤±å¯¼è‡´åœ°å€çš„èµ„é‡‘ä¸¢å¤±ï¼Œæ¯”ç‰¹å¸å¼•å…¥äº†å¤šé‡ç­¾åæœºåˆ¶ï¼Œå¯ä»¥å®ç°åˆ†æ•£é£é™©çš„åŠŸèƒ½ã€‚&lt;/p&gt;

&lt;p&gt;å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯å‡è®¾Nä¸ªäººåˆ†åˆ«æŒæœ‰Nä¸ªç§é’¥ï¼Œåªè¦å…¶ä¸­Mä¸ªäººåŒæ„ç­¾åå°±å¯ä»¥åŠ¨ç”¨æŸä¸ªâ€œè”åˆåœ°å€â€çš„èµ„é‡‘ã€‚&lt;/p&gt;

&lt;p&gt;å‘é€ç»™å¤šé‡ç­¾ååœ°å€çš„äº¤æ˜“åˆ›å»ºçš„æ˜¯P2SHè„šæœ¬ï¼Œè€ŒèŠ±è´¹å¤šé‡ç­¾ååœ°å€çš„èµ„é‡‘éœ€è¦çš„è„šæœ¬å°±æ˜¯Mä¸ªç­¾å+Redeem Scriptã€‚&lt;/p&gt;

&lt;p&gt;æ³¨æ„ï¼šä»å¤šé‡ç­¾åçš„åœ°å€æœ¬èº«å¹¶æ— æ³•å¾—çŸ¥è¯¥å¤šé‡ç­¾åä½¿ç”¨çš„å…¬é’¥ï¼Œä»¥åŠM-Nçš„å…·ä½“æ•°å€¼ã€‚å¿…é¡»å°†Redeem Scriptå…¬ç¤ºç»™æ¯ä¸ªç§é’¥æŒæœ‰äººï¼Œæ‰èƒ½å¤ŸéªŒè¯å¤šé‡ç­¾ååœ°å€æ˜¯å¦æ­£ç¡®ï¼ˆå³åŒ…å«äº†æ‰€æœ‰äººçš„å…¬é’¥ï¼Œä»¥åŠæ­£ç¡®çš„M-Næ•°å€¼ï¼‰ã€‚è¦èŠ±è´¹å¤šé‡ç­¾ååœ°å€çš„èµ„é‡‘ï¼Œé™¤äº†Mä¸ªç§é’¥ç­¾åå¤–ï¼Œå¿…é¡»è¦æœ‰Redeem Scriptï¼ˆå¯ç”±æ‰€æœ‰äººçš„å…¬é’¥æ„é€ ï¼‰ã€‚åªæœ‰ç­¾åï¼Œæ²¡æœ‰Redeem Scriptæ˜¯ä¸èƒ½æ„é€ å‡ºè§£é”è„šæœ¬æ¥èŠ±è´¹èµ„é‡‘çš„ã€‚å› æ­¤ï¼Œä¿å­˜å¤šé‡ç­¾ååœ°å€çš„é’±åŒ…å¿…é¡»åŒæ—¶ä¿å­˜Redeem Scriptã€‚&lt;/p&gt;

&lt;p&gt;åˆ©ç”¨å¤šé‡ç­¾åï¼Œå¯ä»¥å®ç°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;1-2ï¼Œä¸¤äººåªè¦æœ‰ä¸€äººåŒæ„å³å¯ä½¿ç”¨èµ„é‡‘ï¼›&lt;/li&gt;
  &lt;li&gt;2-2ï¼Œä¸¤äººå¿…é¡»éƒ½åŒæ„æ‰å¯ä½¿ç”¨èµ„é‡‘ï¼›&lt;/li&gt;
  &lt;li&gt;2-3ï¼Œ3äººå¿…é¡»è‡³å°‘ä¸¤äººåŒæ„æ‰å¯ä½¿ç”¨èµ„é‡‘ï¼›&lt;/li&gt;
  &lt;li&gt;4-7ï¼Œ7äººä¸­å¤šæ•°äººåŒæ„æ‰å¯ä½¿ç”¨èµ„é‡‘ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æœ€å¸¸è§çš„å¤šé‡ç­¾åæ˜¯2-3ç±»å‹ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæä¾›åœ¨çº¿é’±åŒ…çš„æœåŠ¡ï¼Œä¸ºäº†é˜²æ­¢æœåŠ¡å•†ç›—å–ç”¨æˆ·çš„èµ„é‡‘ï¼Œå¯ä»¥ä½¿ç”¨2-3ç±»å‹çš„å¤šé‡ç­¾ååœ°å€ï¼ŒæœåŠ¡å•†æŒæœ‰1ä¸ªç§é’¥ï¼Œç”¨æˆ·æŒæœ‰ä¸¤ä¸ªç§é’¥ï¼Œä¸€ä¸ªä½œä¸ºå¸¸è§„ä½¿ç”¨ï¼Œä¸€ä¸ªä½œä¸ºåº”æ€¥ä½¿ç”¨ã€‚è¿™æ ·ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œç”¨æˆ·åªéœ€ä½¿ç”¨å¸¸è§„ç§é’¥å³å¯é…åˆæœåŠ¡å•†å®Œæˆæ­£å¸¸äº¤æ˜“ï¼ŒæœåŠ¡å•†å› ä¸ºåªæŒæœ‰1ä¸ªç§é’¥ï¼Œå› æ­¤æ— æ³•ç›—å–ç”¨æˆ·èµ„é‡‘ã€‚å¦‚æœæœåŠ¡å•†å€’é—­æˆ–è€…è¢«é»‘å®¢æ”»å‡»ï¼Œç”¨æˆ·å¯ä½¿ç”¨è‡ªå·±æŒæ¡çš„ä¸¤ä¸ªç§é’¥è½¬ç§»èµ„é‡‘ã€‚&lt;/p&gt;

&lt;p&gt;å¤§å‹æœºæ„çš„æ¯”ç‰¹å¸é€šå¸¸éƒ½ä½¿ç”¨å¤šé‡ç­¾ååœ°å€ä»¥ä¿è¯å®‰å…¨ã€‚&lt;/p&gt;

&lt;p&gt;åˆ©ç”¨å¤šé‡ç­¾åï¼Œå¯ä»¥ä½¿å¾—ç§é’¥ä¸¢å¤±çš„é£é™©è¢«åˆ†æ•£åˆ°Nä¸ªäººæ‰‹ä¸­ï¼Œå¹¶ä¸”ï¼Œé¿å…äº†å°‘æ•°äººçªƒå–èµ„é‡‘çš„é—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„å¤šé‡ç­¾åæœ€å¤šå…è®¸15ä¸ªç§é’¥å‚ä¸ç­¾åï¼Œå³å¯å®ç°1-2è‡³15-15çš„ä»»æ„ç»„åˆï¼ˆ1â©½Mâ©½Nâ©½15ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;å¤šé‡ç­¾åå¯ä»¥å®ç°Nä¸ªäººæŒæœ‰ç§é’¥ï¼Œå…¶ä¸­Mä¸ªäººåŒæ„å³å¯èŠ±è´¹èµ„é‡‘çš„åŠŸèƒ½ã€‚&lt;/p&gt;

&lt;p&gt;å¤šé‡ç­¾åé™ä½äº†å•ä¸ªç§é’¥ä¸¢å¤±çš„é£é™©ã€‚&lt;/p&gt;

&lt;p&gt;æ”¯ä»˜æ¯”ç‰¹å¸åˆ°ä¸€ä¸ªå¤šé‡ç­¾ååœ°å€å®é™…ä¸Šæ˜¯åˆ›å»ºä¸€ä¸ªP2SHè¾“å‡ºã€‚&lt;/p&gt;

&lt;h2 id=&quot;utxoæ¨¡å‹&quot;&gt;UTXOæ¨¡å‹&lt;/h2&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„åŒºå—é“¾ç”±ä¸€ä¸ªä¸ªåŒºå—ä¸²è”æ„æˆï¼Œè€Œæ¯ä¸ªåŒºå—åˆåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªäº¤æ˜“ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬è§‚å¯Ÿä»»ä½•ä¸€ä¸ªäº¤æ˜“ï¼Œå®ƒæ€»æ˜¯ç”±è‹¥å¹²ä¸ªè¾“å…¥ï¼ˆInputï¼‰å’Œè‹¥å¹²ä¸ªè¾“å‡ºï¼ˆOutputï¼‰æ„æˆï¼Œä¸€ä¸ªInputæŒ‡å‘çš„æ˜¯å‰é¢åŒºå—çš„æŸä¸ªOutputï¼Œåªæœ‰Coinbaseäº¤æ˜“ï¼ˆçŸ¿å·¥å¥–åŠ±çš„é“¸å¸äº¤æ˜“ï¼‰æ²¡æœ‰è¾“å…¥ï¼Œåªæœ‰å‡­ç©ºè¾“å‡ºã€‚æ‰€ä»¥ï¼Œä»»ä½•äº¤æ˜“ï¼Œæ€»æ˜¯å¯ä»¥ç”±Inputæº¯æºåˆ°Coinbaseäº¤æ˜“ã€‚&lt;/p&gt;

&lt;p&gt;è¿™äº›äº¤æ˜“çš„Inputå’ŒOutputæ€»æ˜¯å¯ä»¥ä¸²è”èµ·æ¥ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Block #1     â”‚     â”‚Block #2     â”‚     â”‚Block #3     â”‚     â”‚Block #4     â”‚
â”‚â”Œâ”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”â”‚     â”‚â”Œâ”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”â”‚     â”‚â”Œâ”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”â”‚     â”‚â”Œâ”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”â”‚
â”‚â”‚CBâ”‚50.0â”‚OUTâ”œâ”¼â”€â”€â”  â”‚â”‚CBâ”‚50.0â”‚OUTâ”œâ”¼â”€â”€â”  â”‚â”‚CBâ”‚50.0â”‚OUTâ”œâ”¼â”€â”€â”  â”‚â”‚CBâ”‚50.0â”‚OUTâ”‚â”‚
â”‚â””â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”˜â”‚  â”‚  â”‚â””â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”˜â”‚  â”‚  â”‚â””â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”˜â”‚  â”‚  â”‚â””â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”˜â”‚
â”‚             â”‚  â”‚  â”‚â”Œâ”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”â”‚  â”‚  â”‚â”Œâ”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”â”‚  â”‚  â”‚â”Œâ”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”â”‚
â”‚             â”‚  â”‚  â”‚â”‚  â”‚8.70â”‚OUTâ”œâ”¼â”€â”€â”¼â”€â”€â–¶â”‚INâ”‚    â”‚   â”‚â”‚  â””â”€â”€â–¶â”‚INâ”‚25.0â”‚OUTâ”‚â”‚
â”‚             â”‚  â””â”€â”€â–¶â”‚INâ”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”¤â”‚  â”‚  â”‚â”œâ”€â”€â”¤58.7â”‚OUTâ”‚â”‚     â”‚â”œâ”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”¤â”‚
â”‚             â”‚     â”‚â”‚  â”‚41.3â”‚OUTâ”œâ”¼â”€â”â””â”€â”€â–¶â”‚INâ”‚    â”‚   â”‚â”‚  â”Œâ”€â”€â–¶â”‚INâ”‚66.3â”‚OUTâ”‚â”‚
â”‚             â”‚     â”‚â””â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”˜â”‚ â”‚   â”‚â””â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”˜â”‚  â”‚  â”‚â””â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿˜æ²¡æœ‰è¢«ä¸‹ä¸€ä¸ªäº¤æ˜“èŠ±è´¹çš„Outputè¢«ç§°ä¸ºUTXOï¼šUnspent TX Outputï¼Œå³æœªèŠ±è´¹äº¤æ˜“è¾“å‡ºã€‚ç»™å®šä»»ä½•ä¸€ä¸ªåŒºå—ï¼Œè®¡ç®—å½“å‰æ‰€æœ‰çš„UXTOé‡‘é¢ä¹‹å’Œï¼Œç­‰åŒäºè‡ªåˆ›ä¸–åŒºå—åˆ°ç»™å®šåŒºå—çš„æŒ–çŸ¿å¥–åŠ±ä¹‹å’Œã€‚&lt;/p&gt;

&lt;p&gt;å› æ­¤ï¼Œæ¯”ç‰¹å¸çš„äº¤æ˜“æ¨¡å‹å’Œæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„é“¶è¡Œè´¦å·æœ‰æ‰€ä¸åŒï¼Œå®ƒå¹¶æ²¡æœ‰è´¦æˆ·è¿™ä¸ªè¯´æ³•ï¼Œåªæœ‰UTXOã€‚æƒ³è¦ç¡®å®šæŸä¸ªäººæ‹¥æœ‰çš„æ¯”ç‰¹å¸ï¼Œå¹¶æ— æ³•é€šè¿‡æŸä¸ªè´¦æˆ·æŸ¥åˆ°ï¼Œå¿…é¡»çŸ¥é“æ­¤äººæ§åˆ¶çš„æ‰€æœ‰UTXOé‡‘é¢ä¹‹å’Œã€‚&lt;/p&gt;

&lt;p&gt;åœ¨é’±åŒ…ç¨‹åºä¸­ï¼Œé’±åŒ…ç®¡ç†çš„æ˜¯ä¸€ç»„ç§é’¥ï¼Œå¯¹åº”çš„æ˜¯ä¸€ç»„å…¬é’¥å’Œåœ°å€ã€‚é’±åŒ…ç¨‹åºå¿…é¡»ä»åˆ›ä¸–åŒºå—å¼€å§‹æ‰«ææ¯ä¸€ç¬”äº¤æ˜“ï¼Œå¦‚æœï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;é‡åˆ°æŸç¬”äº¤æ˜“çš„æŸä¸ªOutputæ˜¯é’±åŒ…ç®¡ç†çš„åœ°å€ä¹‹ä¸€ï¼Œåˆ™é’±åŒ…ä½™é¢å¢åŠ ï¼›&lt;/li&gt;
  &lt;li&gt;é‡åˆ°æŸç¬”äº¤æ˜“çš„æŸä¸ªInputæ˜¯é’±åŒ…ç®¡ç†çš„åœ°å€ä¹‹ä¸€ï¼Œåˆ™é’±åŒ…ä½™é¢å‡å°‘ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;é’±åŒ…çš„å½“å‰ä½™é¢æ€»æ˜¯é’±åŒ…åœ°å€å…³è”çš„æ‰€æœ‰UTXOé‡‘é¢ä¹‹å’Œã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœåˆšè£…äº†ä¸€ä¸ªæ–°é’±åŒ…ï¼Œå¯¼å…¥äº†ä¸€ç»„ç§é’¥ï¼Œåœ¨é’±åŒ…æ‰«æå®Œæ•´ä¸ªæ¯”ç‰¹å¸åŒºå—ä¹‹å‰ï¼Œæ˜¯æ— æ³•å¾—çŸ¥å½“å‰ç®¡ç†çš„åœ°å€ä½™é¢çš„ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ¯”ç‰¹å¸åŒºå—é“¾æœ¬è´¨ä¸Šæ˜¯ä¸å¯ä¿®æ”¹çš„â€œä¿®æ”¹æ—¥å¿—â€ï¼ˆç±»ä¼¼ MySQL çš„ binlogï¼‰ï¼Œè®°å½•çš„æ˜¯äº¤æ˜“å˜æ›´è€Œéè´¦æˆ·çŠ¶æ€ã€‚&lt;/li&gt;
  &lt;li&gt;è¦é«˜æ•ˆæŸ¥è¯¢ä½™é¢ï¼Œéœ€å…ˆé‡æ”¾æ‰€æœ‰åŒºå—äº¤æ˜“ï¼Œæ„å»ºæœ¬åœ°â€œåœ°å€-ä½™é¢â€çŠ¶æ€æ•°æ®åº“ï¼Œé’±åŒ…å¤šä½¿ç”¨ LevelDB å­˜å‚¨è¯¥çŠ¶æ€ã€‚  é‡å»ºæ•´ä¸ªåœ°å€-ä½™é¢æ•°æ®åº“éœ€è¦æ‰«ææ•´ä¸ªåŒºå—é“¾ï¼Œå¹¶æŒ‰æ¯ä¸ªäº¤æ˜“ä¾æ¬¡æ›´æ–°è®°å½•ï¼Œå³å¯å¾—åˆ°å½“å‰çŠ¶æ€ã€‚&lt;/li&gt;
  &lt;li&gt;å®æ—¶ä½™é¢æŸ¥è¯¢å¹¶ä¸è¯»å–åŒºå—é“¾åŸå§‹æ•°æ®ï¼Œè€Œæ˜¯æŸ¥æœ¬åœ°å·²æ„å»ºçš„çŠ¶æ€è¡¨æˆ–ç”±æœåŠ¡å™¨è¿”å›æŸ¥è¯¢ç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;hdé’±åŒ…&quot;&gt;HDé’±åŒ…&lt;/h2&gt;

&lt;h3 id=&quot;æ´¾ç”Ÿç§é’¥&quot;&gt;æ´¾ç”Ÿç§é’¥&lt;/h3&gt;

&lt;p&gt;åœ¨æ¯”ç‰¹å¸çš„é“¾ä¸Šï¼Œå®é™…ä¸Šå¹¶æ²¡æœ‰è´¦æˆ·çš„æ¦‚å¿µï¼ŒæŸä¸ªç”¨æˆ·æŒæœ‰çš„æ¯”ç‰¹å¸ï¼Œå®é™…ä¸Šæ˜¯å…¶æ§åˆ¶çš„ä¸€ç»„UTXOï¼Œè€Œè¿™äº›UTXOå¯èƒ½æ˜¯ç›¸åŒçš„åœ°å€ï¼ˆå¯¹åº”ç›¸åŒçš„ç§é’¥ï¼‰ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸åŒçš„åœ°å€ï¼ˆå¯¹åº”ä¸åŒçš„ç§é’¥ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;å‡ºäºä¿æŠ¤éšç§çš„ç›®çš„ï¼ŒåŒä¸€ç”¨æˆ·å¦‚æœæ§åˆ¶çš„UTXOå…¶åœ°å€éƒ½æ˜¯ä¸åŒçš„ï¼Œé‚£ä¹ˆå¾ˆéš¾ä»åœ°å€è·çŸ¥æŸä¸ªç”¨æˆ·çš„æ¯”ç‰¹å¸æŒå¸æ€»é¢ã€‚ä½†æ˜¯ï¼Œç®¡ç†ä¸€ç»„æˆåƒä¸Šä¸‡çš„åœ°å€ï¼Œæ„å‘³ç€ç®¡ç†æˆåƒä¸Šä¸‡çš„ç§é’¥ï¼Œç®¡ç†èµ·æ¥éå¸¸éº»çƒ¦ã€‚&lt;/p&gt;

&lt;p&gt;èƒ½ä¸èƒ½åªç”¨ä¸€ä¸ªç§é’¥ç®¡ç†æˆåƒä¸Šä¸‡ä¸ªåœ°å€ï¼Ÿå®é™…ä¸Šæ˜¯å¯ä»¥çš„ã€‚è™½ç„¶æ¤­åœ†æ›²çº¿ç®—æ³•å†³å®šäº†ä¸€ä¸ªç§é’¥åªèƒ½å¯¹åº”ä¸€ä¸ªå…¬é’¥ï¼Œä½†æ˜¯ï¼Œå¯ä»¥é€šè¿‡æŸç§ç¡®å®šæ€§ç®—æ³•ï¼Œå…ˆç¡®å®šä¸€ä¸ªç§é’¥k1ï¼Œç„¶åè®¡ç®—å‡ºk2ã€k3ã€k4â€¦â€¦ç­‰å…¶ä»–ç§é’¥ï¼Œå°±ç›¸å½“äºåªéœ€è¦ç®¡ç†ä¸€ä¸ªç§é’¥ï¼Œå‰©ä¸‹çš„ç§é’¥å¯ä»¥æŒ‰éœ€è®¡ç®—å‡ºæ¥ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ç§æ ¹æ®æŸç§ç¡®å®šæ€§ç®—æ³•ï¼Œåªéœ€è¦ç®¡ç†ä¸€ä¸ªæ ¹ç§é’¥ï¼Œå³å¯å®æ—¶è®¡ç®—æ‰€æœ‰â€œå­ç§é’¥â€çš„ç®¡ç†æ–¹å¼ï¼Œç§°ä¸ºHDé’±åŒ…ã€‚&lt;/p&gt;

&lt;p&gt;HDæ˜¯Hierarchical Deterministicçš„ç¼©å†™ï¼Œæ„æ€æ˜¯åˆ†å±‚ç¡®å®šæ€§ã€‚å…ˆç¡®å®šæ ¹ç§é’¥rootï¼Œç„¶åæ ¹æ®ç´¢å¼•è®¡ç®—æ¯ä¸€å±‚çš„å­ç§é’¥ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root
â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚             â”‚
â–¼             â–¼             â–¼
k0            k1            k2 ...
â”‚             â”‚             â”‚
â”œâ”€â”€â”¬â”€â”€â”       â”œâ”€â”€â”¬â”€â”€â”       â”œâ”€â”€â”¬â”€â”€â”
â”‚  â”‚  â”‚       â”‚  â”‚  â”‚       â”‚  â”‚  â”‚
â–¼  â–¼  â–¼       â–¼  â–¼  â–¼       â–¼  â–¼  â–¼
k0 k1 k2 ...  k0 k1 k2 ...  k0 k1 k2 ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¯¹äºä»»æ„ä¸€ä¸ªç§é’¥kï¼Œæ€»æ˜¯å¯ä»¥æ ¹æ®ç´¢å¼•è®¡ç®—å®ƒçš„ä¸‹ä¸€å±‚ç§é’¥kn&lt;/p&gt;

&lt;p&gt;HDé’±åŒ…é‡‡ç”¨çš„è®¡ç®—å­ç§é’¥çš„ç®—æ³•å¹¶ä¸æ˜¯ä¸€ä¸ªç®€å•çš„SHA-256ï¼Œç§é’¥ä¹Ÿä¸æ˜¯æ™®é€šçš„256ä½ECDSAç§é’¥ï¼Œè€Œæ˜¯ä¸€ä¸ªæ‰©å±•çš„512ä½ç§é’¥ï¼Œè®°ä½œxprvï¼Œå®ƒé€šè¿‡SHA-512ç®—æ³•é…åˆECCè®¡ç®—å‡ºå­æ‰©å±•ç§é’¥ï¼Œä»ç„¶æ˜¯512ä½ã€‚é€šè¿‡æ‰©å±•ç§é’¥å¯è®¡ç®—å‡ºç”¨äºç­¾åçš„ç§é’¥ä»¥åŠå…¬é’¥ã€‚&lt;/p&gt;

&lt;p&gt;ç®€å•æ¥è¯´ï¼Œåªè¦ç»™å®šä¸€ä¸ªæ ¹æ‰©å±•ç§é’¥ï¼ˆéšæœº512ä½æ•´æ•°ï¼‰ï¼Œå³å¯è®¡ç®—å…¶ä»»æ„ç´¢å¼•çš„å­æ‰©å±•ç§é’¥ã€‚æ‰©å±•ç§é’¥æ€»æ˜¯èƒ½è®¡ç®—å‡ºæ‰©å±•å…¬é’¥ï¼Œè®°ä½œxpub&lt;/p&gt;

&lt;p&gt;ä»xprvåŠå…¶å¯¹åº”çš„xpubå¯è®¡ç®—å‡ºçœŸæ­£ç”¨äºç­¾åçš„ç§é’¥å’Œå…¬é’¥ã€‚ä¹‹æ‰€ä»¥è¦è®¾è®¡è¿™ç§ç®—æ³•ï¼Œæ˜¯å› ä¸ºæ‰©å±•å…¬é’¥xpubä¹Ÿæœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œé‚£å°±æ˜¯å¯ä»¥ç›´æ¥è®¡ç®—å…¶å­å±‚çº§çš„æ‰©å±•å…¬é’¥&lt;/p&gt;

&lt;p&gt;å› ä¸ºxpubåªåŒ…å«å…¬é’¥ï¼Œä¸åŒ…å«ç§é’¥ï¼Œå› æ­¤ï¼Œå¯ä»¥å®‰å…¨åœ°æŠŠxpubäº¤ç»™ç¬¬ä¸‰æ–¹ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªè§‚å¯Ÿé’±åŒ…ï¼‰ï¼Œå®ƒå¯ä»¥æ ¹æ®xpubè®¡ç®—å­å±‚çº§çš„æ‰€æœ‰åœ°å€ï¼Œç„¶ååœ¨æ¯”ç‰¹å¸çš„é“¾ä¸Šç›‘æ§è¿™äº›åœ°å€çš„ä½™é¢ï¼Œä½†å› ä¸ºæ²¡æœ‰ç§é’¥ï¼Œæ‰€ä»¥åªèƒ½çœ‹ï¼Œä¸èƒ½èŠ±ã€‚&lt;/p&gt;

&lt;p&gt;å› æ­¤ï¼ŒHDé’±åŒ…é€šè¿‡åˆ†å±‚ç¡®å®šæ€§ç®—æ³•ï¼Œå®ç°äº†ä»¥ä¸‹åŠŸèƒ½ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åªè¦ç¡®å®šäº†æ‰©å±•ç§é’¥xprvï¼Œå³å¯æ ¹æ®ç´¢å¼•è®¡ç®—ä¸‹ä¸€å±‚çš„ä»»ä½•æ‰©å±•ç§é’¥ï¼›&lt;/li&gt;
  &lt;li&gt;åªè¦ç¡®å®šäº†æ‰©å±•å…¬é’¥xpubï¼Œå³å¯æ ¹æ®ç´¢å¼•è®¡ç®—ä¸‹ä¸€å±‚çš„ä»»ä½•æ‰©å±•å…¬é’¥ï¼›&lt;/li&gt;
  &lt;li&gt;ç”¨æˆ·åªéœ€ä¿å­˜é¡¶å±‚çš„ä¸€ä¸ªæ‰©å±•ç§é’¥ï¼Œå³å¯è®¡ç®—å‡ºä»»æ„ä¸€å±‚çš„ä»»æ„ç´¢å¼•çš„æ‰©å±•ç§é’¥ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»ç†è®ºä¸Šè¯´ï¼Œæ‰©å±•ç§é’¥çš„å±‚æ•°æ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œæ¯ä¸€å±‚çš„æ•°é‡è¢«é™åˆ¶åœ¨0ï½232ï¼ŒåŸå› æ˜¯æ‰©å±•ç§é’¥ä¸­åªæœ‰4å­—èŠ‚ä½œä¸ºç´¢å¼•ï¼Œå› æ­¤ç´¢å¼•èŒƒå›´æ˜¯0ï½232ã€‚&lt;/p&gt;

&lt;p&gt;é€šå¸¸æŠŠæ ¹æ‰©å±•ç§é’¥è®°ä½œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m&lt;/code&gt;ï¼Œå­æ‰©å±•ç§é’¥æŒ‰å±‚çº§è®°ä½œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/x/y/z&lt;/code&gt;ç­‰ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;m
â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      â”‚
â–¼                      â–¼
m/0                    m/1 ...
â”‚                      â”‚
â”œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”          â”œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚     â”‚     â”‚          â”‚     â”‚     â”‚
â–¼     â–¼     â–¼          â–¼     â–¼     â–¼
m/0/0 m/0/1 m/0/2 ...  m/1/0 m/1/1 m/1/2 ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¾‹å¦‚ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/0/2&lt;/code&gt;è¡¨ç¤ºä»&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m&lt;/code&gt;æ‰©å±•åˆ°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/0&lt;/code&gt;ï¼ˆç´¢å¼•ä¸º0ï¼‰å†æ‰©å±•åˆ°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/0/2&lt;/code&gt;ï¼ˆç´¢å¼•ä¸º2ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯HDé’±åŒ…çš„æ‰©å±•ç§é’¥ç®—æ³•æœ‰ä¸ªæ½œåœ¨çš„å®‰å…¨æ€§é—®é¢˜ï¼Œå°±æ˜¯å¦‚æœæŸä¸ªå±‚çº§çš„xprvæ³„éœ²äº†ï¼Œå¯åå‘æ¨å¯¼å‡ºä¸Šå±‚çš„xprvï¼Œç»§è€Œæ¨å¯¼å‡ºæ•´ä¸ªHDæ‰©å±•ç§é’¥ä½“ç³»ã€‚ä¸ºäº†é¿å…æŸä¸ªå­æ‰©å±•ç§é’¥çš„æ³„æ¼å¯¼è‡´ä¸Šå±‚æ‰©å±•ç§é’¥è¢«åå‘æ¨å¯¼ï¼ŒHDé’±åŒ…è¿˜æœ‰ä¸€ç§ç¡¬åŒ–çš„è¡ç”Ÿè®¡ç®—æ–¹å¼ï¼ˆHardened Derivationï¼‰ï¼Œå®ƒé€šè¿‡ç®—æ³•â€œåˆ‡æ–­â€äº†æ¯æ‰©å±•ç§é’¥å’Œå­æ‰©å±•ç§é’¥çš„åå‘æ¨å¯¼ã€‚HDè§„èŒƒæŠŠç´¢å¼•0ï½231ä½œä¸ºæ™®é€šè¡ç”Ÿç´¢å¼•ï¼Œè€Œç´¢å¼•231ï½232ä½œä¸ºç¡¬åŒ–è¡ç”Ÿç´¢å¼•ï¼Œç¡¬åŒ–è¡ç”Ÿç´¢å¼•é€šå¸¸è®°ä½œ0â€™ã€1â€™ã€2â€™â€¦â€¦ï¼Œå³ç´¢å¼•0â€™=231ï¼Œ1â€™=231+1ï¼Œ2â€™=231+2ï¼Œä»¥æ­¤ç±»æ¨ã€‚&lt;/p&gt;

&lt;p&gt;å› æ­¤ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/44&apos;/0&lt;/code&gt;è¡¨ç¤ºçš„å­æ‰©å±•ç§é’¥ï¼Œå®ƒçš„ç¬¬ä¸€å±‚è¡ç”Ÿç´¢å¼•&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;44&apos;&lt;/code&gt;æ˜¯ç¡¬åŒ–è¡ç”Ÿï¼Œå®é™…ç´¢å¼•æ˜¯231+44=2147483692ã€‚ä»&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/44&apos;&lt;/code&gt;æ— æ³•åå‘æ¨å¯¼å‡º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨åªæœ‰æ‰©å±•å…¬é’¥çš„æƒ…å†µä¸‹ï¼Œåªèƒ½è®¡ç®—å‡ºæ™®é€šè¡ç”Ÿçš„å­å…¬é’¥ï¼Œæ— æ³•è®¡ç®—å‡ºç¡¬åŒ–è¡ç”Ÿçš„å­æ‰©å±•å…¬é’¥ï¼Œå³å¯è®¡ç®—å‡ºçš„å­æ‰©å±•å…¬é’¥ç´¢å¼•è¢«é™åˆ¶åœ¨0ï½231ã€‚å› æ­¤ï¼Œè§‚å¯Ÿé’±åŒ…èƒ½ä½¿ç”¨çš„ç´¢å¼•æ˜¯0ï½231ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ç¡¬åŒ–æ´¾ç”Ÿ-vs-æ™®é€šæ´¾ç”Ÿbip-32&quot;&gt;ç¡¬åŒ–æ´¾ç”Ÿ vs æ™®é€šæ´¾ç”Ÿï¼ˆBIP-32ï¼‰&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;é¡¹ç›®&lt;/th&gt;
      &lt;th&gt;æ™®é€šæ´¾ç”Ÿï¼ˆNormalï¼‰&lt;/th&gt;
      &lt;th&gt;ç¡¬åŒ–æ´¾ç”Ÿï¼ˆHardenedï¼‰&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;ç´¢å¼•èŒƒå›´&lt;/td&gt;
      &lt;td&gt;0 ï½ 2Â³Â¹ - 1&lt;/td&gt;
      &lt;td&gt;2Â³Â¹ ï½ 2Â³Â² - 1ï¼ˆå¦‚ 44â€™ å®ä¸º 2147483692ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;è¾“å…¥&lt;/td&gt;
      &lt;td&gt;çˆ¶ &lt;strong&gt;å…¬é’¥&lt;/strong&gt; + å­ç´¢å¼•.&lt;br /&gt;m/0      â† å­ç´¢å¼• 0&lt;br /&gt;m/1      â† å­ç´¢å¼• 1&lt;br /&gt;m/2      â† å­ç´¢å¼• 2&lt;/td&gt;
      &lt;td&gt;çˆ¶ &lt;strong&gt;ç§é’¥&lt;/strong&gt; + å­ç´¢å¼•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;æ˜¯å¦å¯é€†&lt;/td&gt;
      &lt;td&gt;âŒ å­ç§é’¥å¯æ¨å‡ºçˆ¶å…¬é’¥ï¼Œå¯èƒ½æœ‰é£é™©&lt;/td&gt;
      &lt;td&gt;âœ… å­ç§é’¥æ— æ³•æ¨å‡ºçˆ¶å¯†é’¥æˆ–å…¬é’¥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;é€‚ç”¨åœºæ™¯&lt;/td&gt;
      &lt;td&gt;åˆ›å»ºå…¬é’¥é“¾ï¼ˆå¦‚è§‚å¯Ÿé’±åŒ…ï¼‰&lt;/td&gt;
      &lt;td&gt;å¢å¼ºå®‰å…¨æ€§ï¼Œé˜²æ­¢ç§é’¥æ³„éœ²æ¨å¯¼çˆ¶å¯†é’¥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;å®‰å…¨æ€§&lt;/td&gt;
      &lt;td&gt;è¾ƒä½ï¼ˆè‹¥å­ç§é’¥æ³„éœ² + çˆ¶å…¬é’¥ â†’ æ¨å¯¼çˆ¶ç§é’¥ï¼‰&lt;/td&gt;
      &lt;td&gt;é«˜ï¼ˆå­ç§é’¥æ— çˆ¶å¯†é’¥ä¿¡æ¯ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;å¸¸ç”¨è·¯å¾„&lt;/td&gt;
      &lt;td&gt;å¦‚ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/0/1&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;å¦‚ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/44&apos;/0&apos;/0&apos;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;æ™®é€šæ´¾ç”Ÿ&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼š&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;ChildPubKey&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ParentPubKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;â†’&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;å¯ç”Ÿæˆ&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;â€œ&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;è§‚å¯Ÿé’±åŒ…&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;â€&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ç¡¬åŒ–æ´¾ç”Ÿ&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼š&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;ChildPrivKey&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ParentPrivKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Â³Â¹&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;â†’&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;åªé ç§é’¥èƒ½æ´¾ç”Ÿ&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼Œ&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;é˜²æ­¢åå‘æ¨å¯¼&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;æ´¾ç”Ÿæ ‡å‡†&quot;&gt;&lt;strong&gt;æ´¾ç”Ÿæ ‡å‡†&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;æ¯”ç‰¹å¸çš„&lt;a href=&quot;https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki&quot;&gt;BIP-44&lt;/a&gt;è§„èŒƒå®šä¹‰äº†ä¸€ç§å¦‚ä½•æ´¾ç”Ÿç§é’¥çš„æ ‡å‡†ï¼Œå®ƒæœ¬èº«éå¸¸ç®€å•ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-plain&quot;&gt;m / purpose&apos; / coin_type&apos; / account&apos; / change / address_index
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…¶ä¸­ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;purpose&lt;/code&gt;æ€»æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;44&lt;/code&gt;ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;coin_type&lt;/code&gt;åœ¨&lt;a href=&quot;https://github.com/satoshilabs/slips/blob/master/slip-0044.md&quot;&gt;SLIP-44&lt;/a&gt;ä¸­å®šä¹‰ï¼Œä¾‹å¦‚ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0=BTC&lt;/code&gt;ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;2=LTC&lt;/code&gt;ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;60=ETH&lt;/code&gt;ç­‰ã€‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;account&lt;/code&gt;è¡¨ç¤ºç”¨æˆ·çš„æŸä¸ªâ€œè´¦æˆ·â€ï¼Œç”±ç”¨æˆ·è‡ªå®šä¹‰ç´¢å¼•ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;change=0&lt;/code&gt;è¡¨ç¤ºå¤–éƒ¨äº¤æ˜“ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;change=1&lt;/code&gt;è¡¨ç¤ºå†…éƒ¨äº¤æ˜“ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;address_index&lt;/code&gt;åˆ™æ˜¯çœŸæ­£æ´¾ç”Ÿçš„ç´¢å¼•ä¸º0ï½231çš„åœ°å€ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹å¦‚ï¼ŒæŸä¸ªæ¯”ç‰¹å¸é’±åŒ…ç»™ç”¨æˆ·åˆ›å»ºçš„ä¸€ç»„HDåœ°å€å®é™…ä¸Šæ˜¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;m/44â€™/0â€™/0â€™/0/0&lt;/li&gt;
  &lt;li&gt;m/44â€™/0â€™/0â€™/0/1&lt;/li&gt;
  &lt;li&gt;m/44â€™/0â€™/0â€™/0/2&lt;/li&gt;
  &lt;li&gt;m/44â€™/0â€™/0â€™/0/3&lt;/li&gt;
  &lt;li&gt;â€¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¦‚æœæ˜¯è±ç‰¹å¸é’±åŒ…ï¼Œåˆ™ç”¨æˆ·çš„HDåœ°å€æ˜¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;m/44â€™/2â€™/0â€™/0/0&lt;/li&gt;
  &lt;li&gt;m/44â€™/2â€™/0â€™/0/1&lt;/li&gt;
  &lt;li&gt;m/44â€™/2â€™/0â€™/0/2&lt;/li&gt;
  &lt;li&gt;m/44â€™/2â€™/0â€™/0/3&lt;/li&gt;
  &lt;li&gt;â€¦&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;åŠ©è®°è¯&quot;&gt;åŠ©è®°è¯&lt;/h3&gt;

&lt;p&gt;BIP-39è§„èŒƒé€šè¿‡ä½¿ç”¨åŠ©è®°è¯+å£ä»¤æ¥ç”ŸæˆHDé’±åŒ…çš„ç§å­ï¼Œç”¨æˆ·åªéœ€è®°å¿†åŠ©è®°è¯å’Œå£ä»¤å³å¯éšæ—¶æ¢å¤HDé’±åŒ…ã€‚&lt;/p&gt;

&lt;p&gt;ä¸¢å¤±åŠ©è®°è¯æˆ–è€…ä¸¢å¤±å£ä»¤å‡ä¼šå¯¼è‡´HDé’±åŒ…ä¸¢å¤±ã€‚&lt;/p&gt;

&lt;p&gt;åŠ©è®°è¯æ˜¯ä¸€ç»„äººç±»å¯è¯»çš„å•è¯ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªéšæœºæ•°ç§å­ï¼Œèƒ½&lt;strong&gt;æ¢å¤æ•´ä¸ª HD é’±åŒ…çš„æ‰€æœ‰ç§é’¥ã€å…¬é’¥å’Œåœ°å€&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;eg&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;legal&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;winner&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;thank&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;wave&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;sausage&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;worth&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;useful&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;legal&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;winner&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;thank&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;yellow&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¸¸è§é•¿åº¦æœ‰ï¼š12 / 15 / 18 / 21 / 24 ä¸ªå•è¯&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ç§å­å’ŒåŠ©è®°è¯çš„å…³ç³»&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;åœ¨ BIP-39 æ ‡å‡†ä¸­ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;åŠ©è®°è¯ï¼ˆmnemonic wordsï¼‰&lt;/strong&gt; æ˜¯ 12/15/18/24 ä¸ªè¯çš„äººç±»å¯è¯»è¡¨ç¤º&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åŠ©è®°è¯ â†’ é€šè¿‡ PBKDF2 â†’ æ´¾ç”Ÿå‡º 512 ä½çš„ç§å­&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç§å­ â†’ ç”¨äºç”Ÿæˆ HD é’±åŒ…çš„æ ¹å¯†é’¥ï¼ˆmï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
åŠ©è®°è¯è¯ç»„ï¼ˆ24è¯ï¼‰ 
â†’ PBKDF2 åŠ ç›æ´¾ç”Ÿ 
â†’ ç”Ÿæˆç§å­ï¼ˆ512ä½ï¼‰ 
â†’ BIP-32 ç”Ÿæˆæ ¹ç§é’¥ m 
â†’ æ´¾ç”Ÿæ•´ä¸ª HD é’±åŒ…æ ‘
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;åœ°å€ç›‘æ§&quot;&gt;åœ°å€ç›‘æ§&lt;/h3&gt;

&lt;p&gt;ä¸€ä¸ªHDé’±åŒ…ç®¡ç†çš„æ˜¯ä¸€ç»„è‡ªåŠ¨è®¡ç®—çš„åœ°å€ã€‚ä»¥æ¯”ç‰¹å¸ä¸ºä¾‹ï¼Œåœ¨ç¡®å®šäº†æ ¹æ‰©å±•ç§é’¥&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m&lt;/code&gt;åï¼Œå¾—åˆ°ä¸€ç»„åœ°å€ä¸º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m/44&apos;/0&apos;/0&apos;/0/x&lt;/code&gt;ï¼Œå…¶ä¸­x=0~231ã€‚&lt;/p&gt;

&lt;p&gt;HDé’±åŒ…éœ€è¦åœ¨é“¾ä¸Šç›‘æ§æ¯ä¸ªTXçš„è¾“å…¥å’Œè¾“å‡ºï¼Œçœ‹çœ‹ä¸Šè¿°ç®¡ç†çš„ä¸€ç»„åœ°å€æ˜¯å¦å­˜åœ¨ä¸è¾“å…¥å’Œè¾“å‡ºä¸­ã€‚å¦‚æœä½œä¸ºè¾“å…¥ï¼Œåˆ™é’±åŒ…ä½™é¢å‡å°‘ï¼Œå¦‚æœä½œä¸ºè¾“å‡ºï¼Œåˆ™é’±åŒ…ä½™é¢å¢åŠ ã€‚&lt;/p&gt;

&lt;p&gt;ç°åœ¨é—®é¢˜æ¥äº†ï¼šå¦‚ä½•æ ¹æ®TXçš„è¾“å…¥å’Œè¾“å‡ºåœ°å€å¿«é€Ÿåˆ¤æ–­è¿™äº›åœ°å€ä¸­æ˜¯å¦å­˜åœ¨HDé’±åŒ…ç®¡ç†çš„åœ°å€ï¼Ÿ&lt;/p&gt;

&lt;p&gt;é¦–å…ˆï¼Œå¯ç”¨çš„åœ°å€é«˜è¾¾231ä¸ªï¼Œè¿™ä¸ªæ•°å¤ªå¤§äº†ï¼Œç”¨æˆ·ä¸å¯èƒ½ç”¨å®Œï¼Œå› æ­¤ï¼ŒHDé’±åŒ…åªä¼šé¢„ç”Ÿæˆå‰1000ä¸ªåœ°å€ï¼ˆå³ç´¢å¼•å·ä¸º0ï½999ï¼‰å¹¶ä¿å­˜åœ¨æœ¬åœ°æ•°æ®åº“ä¸­ï¼Œå¦‚æœä¸å¤Ÿäº†ï¼Œå†ç»§ç»­æ‰©å±•1000ä¸ªï¼Œè¿™æ ·ï¼ŒHDé’±åŒ…ç®¡ç†çš„åœ°å€æ•°é‡ä¸ä¼šå¤ªå¤§ã€‚&lt;/p&gt;

&lt;p&gt;è¦åšåˆ°é«˜æ•ˆçš„æŸ¥è¯¢å’Œä½ç©ºé—´å ç”¨ç‡ï¼Œå¯ä»¥ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰ï¼Œå®ƒæ˜¯ç”±Burton Howard Bloomåœ¨1970å¹´æå‡ºçš„ï¼Œå…¶åŸç†æ˜¯å°†æ¯ä¸ªå…ƒç´ é€šè¿‡è‹¥å¹²ä¸ªå“ˆå¸Œå‡½æ•°æ˜ å°„æˆä¸€ä¸ªä½æ•°ç»„çš„è‹¥å¹²ä¸ªç‚¹ï¼Œå°†å…¶ç½®1ã€‚æ£€ç´¢çš„æ—¶å€™ï¼Œå…ˆè®¡ç®—ç»™å®šå…ƒç´ å¯¹åº”ä½æ˜¯å¦å…¨1ï¼Œå¦‚æœæ˜¯å…¨1ï¼Œåˆ™ç»™å®šå…ƒç´ å¾ˆå¯èƒ½å­˜åœ¨ï¼Œå¦åˆ™ï¼Œå…ƒç´ å¿…å®šä¸å­˜åœ¨ã€‚&lt;/p&gt;

&lt;p&gt;å› æ­¤ï¼ŒBloom Filteræœ‰ä¸ªé‡è¦ç‰¹ç‚¹ï¼Œå°±æ˜¯åˆ¤æ–­å…ƒç´ æ—¶ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè‚¯å®šä¸å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå®é™…ä¸Šæ˜¯ä»¥ä¸€å®šæ¦‚ç‡å­˜åœ¨ï¼ˆä¾‹å¦‚ï¼Œ99%ï¼‰ï¼Œè¿˜éœ€è¦å†æ¬¡ä»æ•°æ®åº“æŸ¥è¯¢ä»¥ç¡®å®šå…ƒç´ çœŸçš„å­˜åœ¨ã€‚&lt;/p&gt;</content><author><name>Fulong Ma</name></author><category term="Web3" /><category term="Web3" /><summary type="html">åŒºå—é“¾å…¥é—¨2</summary></entry><entry><title type="html">è¿œç¨‹</title><link href="https://mafulong.github.io/2025/07/09/%E8%BF%9C%E7%A8%8B/" rel="alternate" type="text/html" title="è¿œç¨‹" /><published>2025-07-09T00:00:00+08:00</published><updated>2025-07-09T00:00:00+08:00</updated><id>https://mafulong.github.io/2025/07/09/%E8%BF%9C%E7%A8%8B</id><content type="html" xml:base="https://mafulong.github.io/2025/07/09/%E8%BF%9C%E7%A8%8B/">&lt;h2 id=&quot;è¿œç¨‹&quot;&gt;è¿œç¨‹&lt;/h2&gt;

&lt;p&gt;Web3 è¿œç¨‹&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;çŒå¤´&lt;/li&gt;
  &lt;li&gt;ç”µé¸­ç¤¾åŒº&lt;/li&gt;
  &lt;li&gt;Brix&lt;/li&gt;
  &lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Fulong Ma</name></author><category term="Web3" /><category term="Web3" /><summary type="html">è¿œç¨‹</summary></entry><entry><title type="html">æµ¦ä¸œå…¬ç§Ÿæˆ¿</title><link href="https://mafulong.github.io/2025/05/15/%E6%B5%A6%E4%B8%9C%E5%85%AC%E7%A7%9F%E6%88%BF/" rel="alternate" type="text/html" title="æµ¦ä¸œå…¬ç§Ÿæˆ¿" /><published>2025-05-15T00:00:00+08:00</published><updated>2025-05-15T00:00:00+08:00</updated><id>https://mafulong.github.io/2025/05/15/%E6%B5%A6%E4%B8%9C%E5%85%AC%E7%A7%9F%E6%88%BF</id><content type="html" xml:base="https://mafulong.github.io/2025/05/15/%E6%B5%A6%E4%B8%9C%E5%85%AC%E7%A7%9F%E6%88%BF/">&lt;h2 id=&quot;å…¬ç§Ÿæˆ¿&quot;&gt;å…¬ç§Ÿæˆ¿&lt;/h2&gt;

&lt;p&gt;https://zhuanlan.zhihu.com/p/720027504&lt;/p&gt;

&lt;h2 id=&quot;æµ¦ä¸œåœ°å›¾&quot;&gt;æµ¦ä¸œåœ°å›¾&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202505152350009.png&quot; alt=&quot;image-20250515235026893&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;æˆ¿æº&quot;&gt;æˆ¿æº&lt;/h2&gt;

&lt;h3 id=&quot;å…¬ç§Ÿæˆ¿-1&quot;&gt;å…¬ç§Ÿæˆ¿&lt;/h3&gt;

&lt;h4 id=&quot;ä»æ–‡å…¬å¯“&quot;&gt;ä»æ–‡å…¬å¯“&lt;/h4&gt;

&lt;p&gt;https://select.pdgzf.com/houseDetails?Id=9765&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3700&lt;/strong&gt;å…ƒ/æœˆ 53å¹³ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€å®¤ä¸€å…ï¼Œåœè½¦300ä¸€æœˆã€‚&lt;/p&gt;

&lt;p&gt;é è¿‘äºŒç”² ä¸Šæµ·æ˜ç åŒ»é™¢ã€‚&lt;/p&gt;

&lt;p&gt;48åˆ†é’Ÿï¼Œ41kmï¼Œ 26åˆ†é’Ÿã€‚&lt;/p&gt;

&lt;h4 id=&quot;æµ¦ä¸‰è·¯930å¼„-è‰¾ä¸œè‹‘&quot;&gt;æµ¦ä¸‰è·¯930å¼„ è‰¾ä¸œè‹‘&lt;/h4&gt;

&lt;p&gt;https://select.pdgzf.com/houseDetails?Id=8613486F-AA0F-4AD6-9BD1-B6D62BCFA29B&lt;/p&gt;

&lt;p&gt;æˆ·å‹ï¼š &lt;strong&gt;ä¸€å®¤ä¸€å…&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é¢ç§¯ï¼š &lt;strong&gt;49.87&lt;/strong&gt; å¹³æ–¹ç±³&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4128&lt;/strong&gt;å…ƒ/æœˆ&lt;/p&gt;

&lt;p&gt;48åˆ†é’Ÿï¼Œ44kmï¼Œ17åˆ†é’Ÿï¼Œ12km.&lt;/p&gt;

&lt;h4 id=&quot;å·å’Œè·¯399å¼„å¼ æ±Ÿå…´ç§‘è‹‘&quot;&gt;å·å’Œè·¯399å¼„ï¼ˆå¼ æ±Ÿå…´ç§‘è‹‘ï¼‰&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;4081&lt;/strong&gt;å…ƒ/æœˆ&lt;/p&gt;

&lt;p&gt;æˆ·å‹ï¼š &lt;strong&gt;ä¸€å®¤&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é¢ç§¯ï¼š &lt;strong&gt;47.72&lt;/strong&gt; å¹³æ–¹ç±³&lt;/p&gt;

&lt;p&gt;æ¥¼å±‚ï¼š 02æ¥¼&lt;/p&gt;

&lt;p&gt;æˆ¿å·ï¼š 205&lt;/p&gt;

&lt;p&gt;æœå‘ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;èµ·ç§Ÿæ—¥æœŸï¼š 2025-03-16&lt;/li&gt;
  &lt;li&gt;åœ°å€ï¼š å·å’Œè·¯399å¼„ï¼ˆå¼ æ±Ÿå…´ç§‘è‹‘ï¼‰/11-12å·/02æ¥¼/205&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ²¡æœ‰è½¦ä½ã€‚&lt;/p&gt;

&lt;p&gt;52åˆ†é’Ÿï¼Œ48kmï¼Œ 14åˆ†é’Ÿï¼Œ4.5kmã€‚&lt;/p&gt;

&lt;h3 id=&quot;å…¬ç§Ÿæˆ¿ä¸‰æ—&quot;&gt;å…¬ç§Ÿæˆ¿ä¸‰æ—&lt;/h3&gt;

&lt;h4 id=&quot;ä¸‰èˆ’è·¯-åŸæ—ç¾è‹‘&quot;&gt;ä¸‰èˆ’è·¯ åŸæ—ç¾è‹‘&lt;/h4&gt;

&lt;p&gt;https://select.pdgzf.com/houseDetails?Id=706833db-607b-4f3c-846b-96f144c516d7&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2850&lt;/strong&gt;å…ƒ/æœˆ&lt;/p&gt;

&lt;p&gt;æˆ·å‹ï¼š &lt;strong&gt;äºŒå®¤&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é¢ç§¯ï¼š &lt;strong&gt;67.55&lt;/strong&gt; å¹³æ–¹ç±³&lt;/p&gt;

&lt;p&gt;æ¥¼å±‚ï¼š 08æ¥¼&lt;/p&gt;

&lt;p&gt;æˆ¿å·ï¼š 806&lt;/p&gt;

&lt;p&gt;æœå‘ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;èµ·ç§Ÿæ—¥æœŸï¼š 2025-05-22&lt;/li&gt;
  &lt;li&gt;åœ°å€ï¼š ä¸‰èˆ’è·¯33å¼„ï¼ˆåŸæ—ç¾è‹‘ï¼‰/04å·/08æ¥¼/806&lt;/li&gt;
  &lt;li&gt;å®¤å†…é…å¥—ï¼š&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;52 åˆ† ï¼Œ18km, 32 åˆ†é’Ÿã€‚&lt;/p&gt;

&lt;h4 id=&quot;æ°¸æ³°è·¯136å¼„&quot;&gt;æ°¸æ³°è·¯136å¼„&lt;/h4&gt;

&lt;p&gt;https://select.pdgzf.com/houseDetails?Id=B3EC3477-2161-4A31-8441-ACD494761328&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2963&lt;/strong&gt;å…ƒ/æœˆ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;javascript:void(0)&quot;&gt;å·²é€‰ï¼š2å‡†å…¥èµ„æ ¼è¯202517140007390 ï¼ˆ2025-05-19ï¼‰&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æˆ·å‹ï¼š &lt;strong&gt;ä¸€å®¤&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é¢ç§¯ï¼š &lt;strong&gt;51.61&lt;/strong&gt; å¹³æ–¹ç±³&lt;/p&gt;

&lt;p&gt;æ¥¼å±‚ï¼š 02æ¥¼&lt;/p&gt;

&lt;p&gt;æˆ¿å·ï¼š 203&lt;/p&gt;

&lt;p&gt;æœå‘ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;èµ·ç§Ÿæ—¥æœŸï¼š 2025-05-22&lt;/li&gt;
  &lt;li&gt;åœ°å€ï¼š æ°¸æ³°è·¯136å¼„/33å·/2æ¥¼/203&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;56mins, 27mins.&lt;/p&gt;

&lt;h4 id=&quot;ä¸‰æ—‹è·¯506å¼„ç»¿æ³¢å®¶å›­&quot;&gt;ä¸‰æ—‹è·¯506å¼„ï¼ˆç»¿æ³¢å®¶å›­&lt;/h4&gt;

&lt;p&gt;https://select.pdgzf.com/houseDetails?Id=34BE3519-D644-4915-AC8F-DE4864AF83FB&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2793&lt;/strong&gt;å…ƒ/æœˆ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;javascript:void(0)&quot;&gt;å·²é€‰ï¼š9å‡†å…¥èµ„æ ¼è¯202317140008848 ï¼ˆ2023-06-07ï¼‰&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æˆ·å‹ï¼š &lt;strong&gt;äºŒå®¤ä¸€å…&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é¢ç§¯ï¼š &lt;strong&gt;64.99&lt;/strong&gt; å¹³æ–¹ç±³&lt;/p&gt;

&lt;p&gt;æ¥¼å±‚ï¼š 21æ¥¼&lt;/p&gt;

&lt;p&gt;æˆ¿å·ï¼š 2104&lt;/p&gt;

&lt;p&gt;æœå‘ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;èµ·ç§Ÿæ—¥æœŸï¼š 2025-05-22&lt;/li&gt;
  &lt;li&gt;åœ°å€ï¼š ä¸‰æ—‹è·¯506å¼„ï¼ˆç»¿æ³¢å®¶å›­ï¼‰/19å·/21æ¥¼/2104&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;52mins, 31minsã€‚&lt;/p&gt;

&lt;h4 id=&quot;æ¨å—è·¯&quot;&gt;æ¨å—è·¯&lt;/h4&gt;

&lt;p&gt;https://select.pdgzf.com/houseDetails?Id=8633&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3365&lt;/strong&gt;å…ƒ/æœˆ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;javascript:void(0)&quot;&gt;å·²é€‰ï¼š2å‡†å…¥èµ„æ ¼è¯202317140018617 ï¼ˆ2023-11-30ï¼‰&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æˆ·å‹ï¼š &lt;strong&gt;ä¸€å®¤&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é¢ç§¯ï¼š &lt;strong&gt;56.80&lt;/strong&gt; å¹³æ–¹ç±³&lt;/p&gt;

&lt;p&gt;æ¥¼å±‚ï¼š 02æ¥¼&lt;/p&gt;

&lt;p&gt;æˆ¿å·ï¼š 202&lt;/p&gt;

&lt;p&gt;æœå‘ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;èµ·ç§Ÿæ—¥æœŸï¼š 2025-05-22&lt;/li&gt;
  &lt;li&gt;åœ°å€ï¼š æ¨å—è·¯694å¼„/81å·/2æ¥¼/202&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;55mins, 25mins&lt;/p&gt;

&lt;h4 id=&quot;å’Œç‚¯è·¯77å¼„ç››ä¸–å—è‹‘&quot;&gt;å’Œç‚¯è·¯77å¼„ï¼ˆç››ä¸–å—è‹‘ï¼‰&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;2633&lt;/strong&gt;å…ƒ/æœˆ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;javascript:void(0)&quot;&gt;å·²é€‰ï¼š6å‡†å…¥èµ„æ ¼è¯202317140009994 ï¼ˆ2023-06-25ï¼‰&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æˆ·å‹ï¼š &lt;strong&gt;äºŒå®¤ä¸€å…&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é¢ç§¯ï¼š &lt;strong&gt;65.26&lt;/strong&gt; å¹³æ–¹ç±³&lt;/p&gt;

&lt;p&gt;æ¥¼å±‚ï¼š 01æ¥¼&lt;/p&gt;

&lt;p&gt;æˆ¿å·ï¼š 101&lt;/p&gt;

&lt;p&gt;æœå‘ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;èµ·ç§Ÿæ—¥æœŸï¼š 2025-05-09&lt;/li&gt;
  &lt;li&gt;åœ°å€ï¼š å’Œç‚¯è·¯77å¼„ï¼ˆç››ä¸–å—è‹‘ï¼‰/13å·/1æ¥¼/101&lt;/li&gt;
  &lt;li&gt;å®¤å†…é…å¥—ï¼š&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;55mins, 32mins&lt;/p&gt;

&lt;h3 id=&quot;éå…¬ç§Ÿæˆ¿&quot;&gt;éå…¬ç§Ÿæˆ¿&lt;/h3&gt;

&lt;h4 id=&quot;é«˜ç§‘è‹‘&quot;&gt;é«˜ç§‘è‹‘&lt;/h4&gt;

&lt;p&gt;é«˜ç§‘è‹‘ï¼Œå°±åœ¨å¤æ—¦å¤§å­¦å’Œæ›™å…‰åŒ»é™¢æ—è¾¹ï¼Œè·ç¦»ä¸­ç§‘è·¯ä¸è¿œï¼Œè¿™ä¸ªå°åŒºç¯å¢ƒä¸é”™ï¼Œå¯ä»¥ç§Ÿä¸€å®¤ä¸€å…&lt;/p&gt;

&lt;p&gt;å°åŒºæ²¡æœ‰äºŒæˆ¿ä¸œï¼Œæ˜¯å¼ æ±Ÿé«˜ç§‘é›†å›¢å»ºçš„å¯¹å¤–å‡ºç§Ÿï¼Œä¸å­˜åœ¨äºŒæˆ¿ä¸œæ”¹é€ é—®é¢˜&lt;/p&gt;

&lt;p&gt;åœ°ä¸‹è½¦åº“åœ°ä¸Šè½¦åº“éƒ½æœ‰ï¼Œåœè½¦è´¹ä¹Ÿä¸è´µ&lt;/p&gt;

&lt;p&gt;52åˆ†é’Ÿï¼Œ50km, è·ç¦»å…¬å¸ 3km&lt;/p&gt;

&lt;h4 id=&quot;å¼ æ±Ÿä¸‡ç§‘ç¿¡ç¿ å…¬å›­&quot;&gt;å¼ æ±Ÿä¸‡ç§‘ç¿¡ç¿ å…¬å›­&lt;/h4&gt;

&lt;p&gt;53åˆ†é’Ÿï¼Œ50km, 14åˆ†é’Ÿï¼Œ4.5kmã€‚&lt;/p&gt;

&lt;h3 id=&quot;ä¿ç§Ÿæˆ¿&quot;&gt;ä¿ç§Ÿæˆ¿&lt;/h3&gt;

&lt;h4 id=&quot;çº³ä»•&quot;&gt;çº³ä»•&lt;/h4&gt;

&lt;p&gt;çº³ä»€å›½é™…ï¼Œæ–°çš„&lt;/p&gt;

&lt;p&gt;è´µçš„ä¸è¡Œ&lt;/p&gt;</content><author><name>Fulong Ma</name></author><category term="DailyLife" /><category term="DailyLife" /><summary type="html">å…¬ç§Ÿæˆ¿</summary></entry><entry><title type="html">Spring AOP</title><link href="https://mafulong.github.io/2025/05/06/Spring-AOP/" rel="alternate" type="text/html" title="Spring AOP" /><published>2025-05-06T00:00:00+08:00</published><updated>2025-05-06T00:00:00+08:00</updated><id>https://mafulong.github.io/2025/05/06/Spring%20AOP</id><content type="html" xml:base="https://mafulong.github.io/2025/05/06/Spring-AOP/">&lt;h2 id=&quot;spring-aop&quot;&gt;Spring AOP&lt;/h2&gt;

&lt;h2 id=&quot;è°ˆè°ˆè‡ªå·±å¯¹äº-aop-çš„äº†è§£&quot;&gt;è°ˆè°ˆè‡ªå·±å¯¹äº AOP çš„äº†è§£&lt;/h2&gt;

&lt;p&gt;AOPï¼Œä¹Ÿå°±æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œç®€å•ç‚¹è¯´ï¼ŒAOP å°±æ˜¯æŠŠä¸€äº›ä¸šåŠ¡é€»è¾‘ä¸­çš„ç›¸åŒä»£ç æŠ½å–åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ä¸­ï¼Œè®©ä¸šåŠ¡é€»è¾‘æ›´åŠ æ¸…çˆ½ã€‚&lt;/p&gt;

&lt;p&gt;AOP(Aspect-Oriented Programming:é¢å‘åˆ‡é¢ç¼–ç¨‹)èƒ½å¤Ÿå°†é‚£äº›ä¸ä¸šåŠ¡æ— å…³ï¼Œå´ä¸ºä¸šåŠ¡æ¨¡å—æ‰€å…±åŒè°ƒç”¨çš„é€»è¾‘æˆ–è´£ä»»ï¼ˆä¾‹å¦‚äº‹åŠ¡å¤„ç†ã€æ—¥å¿—ç®¡ç†ã€æƒé™æ§åˆ¶ç­‰ï¼‰å°è£…èµ·æ¥ï¼Œä¾¿äºå‡å°‘ç³»ç»Ÿçš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆåº¦ï¼Œå¹¶æœ‰åˆ©äºæœªæ¥çš„å¯æ‹“å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚&lt;/p&gt;

&lt;p&gt;Spring AOP å°±æ˜¯åŸºäºåŠ¨æ€ä»£ç†çš„ï¼Œå¦‚æœè¦ä»£ç†çš„å¯¹è±¡ï¼Œå®ç°äº†æŸä¸ªæ¥å£ï¼Œé‚£ä¹ˆ Spring AOP ä¼šä½¿ç”¨ &lt;strong&gt;JDK Proxy&lt;/strong&gt;ï¼Œå»åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œè€Œå¯¹äºæ²¡æœ‰å®ç°æ¥å£çš„å¯¹è±¡ï¼Œå°±æ— æ³•ä½¿ç”¨ JDK Proxy å»è¿›è¡Œä»£ç†äº†ï¼Œè¿™æ—¶å€™ Spring AOP ä¼šä½¿ç”¨ &lt;strong&gt;Cglib&lt;/strong&gt; ç”Ÿæˆä¸€ä¸ªè¢«ä»£ç†å¯¹è±¡çš„å­ç±»æ¥ä½œä¸ºä»£ç†&lt;/p&gt;

&lt;p&gt;å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ &lt;strong&gt;AspectJ&lt;/strong&gt; ï¼Spring AOP å·²ç»é›†æˆäº† AspectJ ï¼ŒAspectJ åº”è¯¥ç®—çš„ä¸Šæ˜¯ Java ç”Ÿæ€ç³»ç»Ÿä¸­æœ€å®Œæ•´çš„ AOP æ¡†æ¶äº†ã€‚&lt;/p&gt;

&lt;p&gt;AOP åˆ‡é¢ç¼–ç¨‹æ¶‰åŠåˆ°çš„ä¸€äº›ä¸“ä¸šæœ¯è¯­ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;æœ¯è¯­&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;å«ä¹‰&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ç›®æ ‡(Target)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;è¢«é€šçŸ¥çš„å¯¹è±¡&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ä»£ç†(Proxy)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;å‘ç›®æ ‡å¯¹è±¡åº”ç”¨é€šçŸ¥ä¹‹ååˆ›å»ºçš„ä»£ç†å¯¹è±¡&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;è¿æ¥ç‚¹(JoinPoint)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç›®æ ‡å¯¹è±¡çš„æ‰€å±ç±»ä¸­ï¼Œå®šä¹‰çš„æ‰€æœ‰æ–¹æ³•å‡ä¸ºè¿æ¥ç‚¹&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;åˆ‡å…¥ç‚¹(Pointcut)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;è¢«åˆ‡é¢æ‹¦æˆª / å¢å¼ºçš„è¿æ¥ç‚¹ï¼ˆåˆ‡å…¥ç‚¹ä¸€å®šæ˜¯è¿æ¥ç‚¹ï¼Œè¿æ¥ç‚¹ä¸ä¸€å®šæ˜¯åˆ‡å…¥ç‚¹ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;é€šçŸ¥(Advice)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;å¢å¼ºçš„é€»è¾‘ / ä»£ç ï¼Œä¹Ÿå³æ‹¦æˆªåˆ°ç›®æ ‡å¯¹è±¡çš„è¿æ¥ç‚¹ä¹‹åè¦åšçš„äº‹æƒ…&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;åˆ‡é¢(Aspect)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;åˆ‡å…¥ç‚¹(Pointcut)+é€šçŸ¥(Advice)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Weaving(ç»‡å…¥)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;å°†é€šçŸ¥åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡ï¼Œè¿›è€Œç”Ÿæˆä»£ç†å¯¹è±¡çš„è¿‡ç¨‹åŠ¨ä½œ&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Spring&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AOP&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;â”œâ”€â”€&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ä½¿ç”¨&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AspectJ&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;æ³¨è§£&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼ˆ&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;å¦‚&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@Aspect&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼‰&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;æ¥å£°æ˜åˆ‡é¢&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ã€‚&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;å®ƒæ˜¯å•ç‹¬çš„aopæ¡†æ¶&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼Œ&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;å¯ä»¥åœ¨éspringé‡Œä½¿ç”¨&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ã€‚&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;å’Œspring&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aopæ˜¯ä¸¤å¥—&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ã€‚&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;å®ƒæ˜¯ç¼–è¯‘æ—¶ç»‡å…¥&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ã€‚&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;â”œâ”€â”€&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ä½¿ç”¨ä»£ç†æ–¹å¼å®ç°&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AOP&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼š&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;â”‚&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;â”œâ”€â”€&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JDK&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;åŠ¨æ€ä»£ç†&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼ˆ&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;æ¥å£å‹&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼‰&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;â”‚&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;â””â”€â”€&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CGLIB&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;åŠ¨æ€ä»£ç†&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼ˆ&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ç±»å‹&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼‰&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;aop-å¸¸è§çš„é€šçŸ¥ç±»å‹æœ‰å“ªäº›&quot;&gt;AOP å¸¸è§çš„é€šçŸ¥ç±»å‹æœ‰å“ªäº›ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;AOP ä¸€èˆ¬æœ‰ &lt;strong&gt;5 ç§&lt;/strong&gt;ç¯ç»•æ–¹å¼ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å‰ç½®é€šçŸ¥ (@Before)&lt;/li&gt;
  &lt;li&gt;è¿”å›é€šçŸ¥ (@AfterReturning)&lt;/li&gt;
  &lt;li&gt;å¼‚å¸¸é€šçŸ¥ (@AfterThrowing)&lt;/li&gt;
  &lt;li&gt;åç½®é€šçŸ¥ (@After)&lt;/li&gt;
  &lt;li&gt;ç¯ç»•é€šçŸ¥ (@Around)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202505062358585.png&quot; alt=&quot;ä¸‰åˆ†æ¶é¢æ¸£é€†è¢­ï¼šç¯ç»•æ–¹å¼&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;aspectj-æ˜¯ä»€ä¹ˆ&quot;&gt;AspectJ æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;

&lt;h3 id=&quot;aspectj&quot;&gt;AspectJ&lt;/h3&gt;

&lt;p&gt;AspectJ æ˜¯ä¸€ä¸ª AOP æ¡†æ¶ï¼Œå®ƒå¯ä»¥åšå¾ˆå¤š Spring AOP å¹²ä¸äº†çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¯´æ”¯æŒç¼–è¯‘æ—¶ã€ç¼–è¯‘åå’Œç±»åŠ è½½æ—¶ç»‡å…¥åˆ‡é¢ã€‚å¹¶ä¸”æä¾›æ›´å¤æ‚çš„åˆ‡ç‚¹è¡¨è¾¾å¼å’Œé€šçŸ¥ç±»å‹ã€‚&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Aspect&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªåˆ‡é¢ç±»&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Component&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// Spring ç®¡ç†è¯¥ç±»çš„ Bean&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LoggingAspect&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// å®šä¹‰ä¸€ä¸ªåˆ‡å…¥ç‚¹ï¼ŒåŒ¹é… HelloService ä¸­çš„æ‰€æœ‰æ–¹æ³•&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Pointcut&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;execution(* com.example.demo.HelloService.*(..))&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;helloServiceMethods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// æ–¹æ³•æ‰§è¡Œä¹‹å‰çš„é€šçŸ¥ï¼ˆBefore Adviceï¼‰&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Before&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;helloServiceMethods()&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;logBefore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Method is about to execute&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// æ–¹æ³•æ‰§è¡Œä¹‹åçš„é€šçŸ¥ï¼ˆAfter Adviceï¼‰&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@After&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;helloServiceMethods()&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;logAfter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Method has executed&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;spring-aop-å’Œ-aspectj-aop-æœ‰ä»€ä¹ˆåŒºåˆ«&quot;&gt;Spring AOP å’Œ AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ç‰¹æ€§&lt;/th&gt;
      &lt;th&gt;Spring AOP&lt;/th&gt;
      &lt;th&gt;AspectJ&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;å¢å¼ºæ–¹å¼&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;è¿è¡Œæ—¶å¢å¼ºï¼ˆåŸºäºåŠ¨æ€ä»£ç†ï¼‰&lt;/td&gt;
      &lt;td&gt;ç¼–è¯‘æ—¶å¢å¼ºã€ç±»åŠ è½½æ—¶å¢å¼ºï¼ˆç›´æ¥æ“ä½œå­—èŠ‚ç ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;åˆ‡å…¥ç‚¹æ”¯æŒ&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;æ–¹æ³•çº§ï¼ˆSpring Bean èŒƒå›´å†…ï¼Œä¸æ”¯æŒ final å’Œ staic æ–¹æ³•ï¼‰&lt;/td&gt;
      &lt;td&gt;æ–¹æ³•çº§ã€å­—æ®µã€æ„é€ å™¨ã€é™æ€æ–¹æ³•ç­‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;è¿è¡Œæ—¶ä¾èµ–ä»£ç†ï¼Œæœ‰ä¸€å®šå¼€é”€ï¼Œåˆ‡é¢å¤šæ—¶æ€§èƒ½è¾ƒä½&lt;/td&gt;
      &lt;td&gt;è¿è¡Œæ—¶æ— ä»£ç†å¼€é”€ï¼Œæ€§èƒ½æ›´é«˜&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;å¤æ‚æ€§&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;ç®€å•ï¼Œæ˜“ç”¨ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯&lt;/td&gt;
      &lt;td&gt;åŠŸèƒ½å¼ºå¤§ï¼Œä½†ç›¸å¯¹å¤æ‚&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;Spring åº”ç”¨ä¸‹æ¯”è¾ƒç®€å•çš„ AOP éœ€æ±‚&lt;/td&gt;
      &lt;td&gt;é«˜æ€§èƒ½ã€é«˜å¤æ‚åº¦çš„ AOP éœ€æ±‚&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;å¦‚ä½•é€‰æ‹©ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;åŠŸèƒ½è€ƒé‡&lt;/strong&gt;ï¼šAspectJ æ”¯æŒæ›´å¤æ‚çš„ AOP åœºæ™¯ï¼ŒSpring AOP æ›´ç®€å•æ˜“ç”¨ã€‚å¦‚æœä½ éœ€è¦å¢å¼º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;final&lt;/code&gt; æ–¹æ³•ã€é™æ€æ–¹æ³•ã€å­—æ®µè®¿é—®ã€æ„é€ å™¨è°ƒç”¨ç­‰ï¼Œæˆ–è€…éœ€è¦åœ¨é Spring ç®¡ç†çš„å¯¹è±¡ä¸Šåº”ç”¨å¢å¼ºé€»è¾‘ï¼ŒAspectJ æ˜¯å”¯ä¸€çš„é€‰æ‹©ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ€§èƒ½è€ƒé‡&lt;/strong&gt;ï¼šåˆ‡é¢æ•°é‡è¾ƒå°‘æ—¶ä¸¤è€…æ€§èƒ½å·®å¼‚ä¸å¤§ï¼Œä½†åˆ‡é¢è¾ƒå¤šæ—¶ AspectJ æ€§èƒ½æ›´ä¼˜ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;ä¸€å¥è¯æ€»ç»“&lt;/strong&gt;ï¼šç®€å•åœºæ™¯ä¼˜å…ˆä½¿ç”¨ Spring AOPï¼›å¤æ‚åœºæ™¯æˆ–é«˜æ€§èƒ½éœ€æ±‚æ—¶ï¼Œé€‰æ‹© AspectJã€‚&lt;/p&gt;

&lt;p&gt;Spring AOP å±äº&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;è¿è¡Œæ—¶å¢å¼º&lt;/code&gt;ï¼Œä¸»è¦å…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;åŸºäºåŠ¨æ€ä»£ç†æ¥å®ç°ï¼Œé»˜è®¤å¦‚æœä½¿ç”¨æ¥å£çš„ï¼Œç”¨ JDK æä¾›çš„åŠ¨æ€ä»£ç†å®ç°ï¼Œå¦‚æœæ˜¯æ–¹æ³•åˆ™ä½¿ç”¨ CGLIB å®ç°&lt;/li&gt;
  &lt;li&gt;Spring AOP éœ€è¦ä¾èµ– IoC å®¹å™¨æ¥ç®¡ç†ï¼Œå¹¶ä¸”åªèƒ½ä½œç”¨äº Spring å®¹å™¨ï¼Œä½¿ç”¨çº¯ Java ä»£ç å®ç°&lt;/li&gt;
  &lt;li&gt;åœ¨æ€§èƒ½ä¸Šï¼Œç”±äº Spring AOP æ˜¯åŸºäº&lt;strong&gt;åŠ¨æ€ä»£ç†&lt;/strong&gt;æ¥å®ç°çš„ï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶éœ€è¦ç”Ÿæˆä»£ç†å®ä¾‹ï¼Œåœ¨æ–¹æ³•è°ƒç”¨ä¸Šä¹Ÿä¼šå¢åŠ æ ˆçš„æ·±åº¦ï¼Œä½¿å¾— Spring AOP çš„æ€§èƒ½ä¸å¦‚ AspectJ çš„é‚£ä¹ˆå¥½ã€‚&lt;/li&gt;
  &lt;li&gt;Spring AOP è‡´åŠ›äºè§£å†³ä¼ä¸šçº§å¼€å‘ä¸­æœ€æ™®éçš„ AOP(æ–¹æ³•ç»‡å…¥)ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;AspectJ æ˜¯ä¸€ä¸ªæ˜“ç”¨çš„åŠŸèƒ½å¼ºå¤§çš„ AOP æ¡†æ¶ï¼Œå±äº&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ç¼–è¯‘æ—¶å¢å¼º&lt;/code&gt;ï¼Œ å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥æ•´åˆåˆ°å…¶å®ƒæ¡†æ¶ä¸­ï¼Œæ˜¯ AOP ç¼–ç¨‹çš„å®Œå…¨è§£å†³æ–¹æ¡ˆã€‚AspectJ éœ€è¦ç”¨åˆ°å•ç‹¬çš„ç¼–è¯‘å™¨ ajcã€‚&lt;/p&gt;

&lt;p&gt;AspectJ å±äº&lt;strong&gt;é™æ€ç»‡å…¥&lt;/strong&gt;ï¼Œé€šè¿‡ä¿®æ”¹ä»£ç æ¥å®ç°ï¼Œåœ¨å®é™…è¿è¡Œä¹‹å‰å°±å®Œæˆäº†ç»‡å…¥ï¼Œæ‰€ä»¥è¯´å®ƒç”Ÿæˆçš„ç±»æ˜¯æ²¡æœ‰é¢å¤–è¿è¡Œæ—¶å¼€é”€çš„ï¼Œä¸€èˆ¬æœ‰å¦‚ä¸‹å‡ ä¸ªç»‡å…¥çš„æ—¶æœºï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç¼–è¯‘æœŸç»‡å…¥ï¼ˆCompile-time weavingï¼‰ï¼šå¦‚ç±» A ä½¿ç”¨ AspectJ æ·»åŠ äº†ä¸€ä¸ªå±æ€§ï¼Œç±» B å¼•ç”¨äº†å®ƒï¼Œè¿™ä¸ªåœºæ™¯å°±éœ€è¦ç¼–è¯‘æœŸçš„æ—¶å€™å°±è¿›è¡Œç»‡å…¥ï¼Œå¦åˆ™æ²¡æ³•ç¼–è¯‘ç±» Bã€‚&lt;/li&gt;
  &lt;li&gt;ç¼–è¯‘åç»‡å…¥ï¼ˆPost-compile weavingï¼‰ï¼šä¹Ÿå°±æ˜¯å·²ç»ç”Ÿæˆäº† .class æ–‡ä»¶ï¼Œæˆ–å·²ç»æ‰“æˆ jar åŒ…äº†ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦å¢å¼ºå¤„ç†çš„è¯ï¼Œå°±è¦ç”¨åˆ°ç¼–è¯‘åç»‡å…¥ã€‚&lt;/li&gt;
  &lt;li&gt;ç±»åŠ è½½åç»‡å…¥ï¼ˆLoad-time weavingï¼‰ï¼šæŒ‡çš„æ˜¯åœ¨åŠ è½½ç±»çš„æ—¶å€™è¿›è¡Œç»‡å…¥ï¼Œè¦å®ç°è¿™ä¸ªæ—¶æœŸçš„ç»‡å…¥ï¼Œæœ‰å‡ ç§å¸¸è§çš„æ–¹æ³•&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;sprint-aop&quot;&gt;Sprint AOP&lt;/h2&gt;

&lt;h3 id=&quot;spring-aop-å‘ç”Ÿåœ¨ä»€ä¹ˆæ—¶å€™&quot;&gt;Spring AOP å‘ç”Ÿåœ¨ä»€ä¹ˆæ—¶å€™ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;Spring AOP åŸºäºè¿è¡Œæ—¶ä»£ç†æœºåˆ¶ï¼Œè¿™æ„å‘³ç€ Spring AOP æ˜¯åœ¨è¿è¡Œæ—¶é€šè¿‡åŠ¨æ€ä»£ç†ç”Ÿæˆçš„ï¼Œè€Œä¸æ˜¯åœ¨ç¼–è¯‘æ—¶æˆ–ç±»åŠ è½½æ—¶ç”Ÿæˆçš„ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ Spring å®¹å™¨åˆå§‹åŒ– Bean çš„è¿‡ç¨‹ä¸­ï¼ŒSpring AOP ä¼šæ£€æŸ¥ Bean æ˜¯å¦éœ€è¦åº”ç”¨åˆ‡é¢ã€‚å¦‚æœéœ€è¦ï¼ŒSpring ä¼šä¸ºè¯¥ Bean åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œå¹¶åœ¨ä»£ç†å¯¹è±¡ä¸­ç»‡å…¥åˆ‡é¢é€»è¾‘ã€‚è¿™ä¸€è¿‡ç¨‹å‘ç”Ÿåœ¨ Spring å®¹å™¨çš„åå¤„ç†å™¨ï¼ˆBeanPostProcessorï¼‰é˜¶æ®µã€‚&lt;/p&gt;

&lt;h3 id=&quot;è¯´è¯´-jdk-åŠ¨æ€ä»£ç†å’Œ-cglib-ä»£ç†&quot;&gt;è¯´è¯´ JDK åŠ¨æ€ä»£ç†å’Œ CGLIB ä»£ç†ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;AOP æ˜¯é€šè¿‡&lt;a href=&quot;https://mp.weixin.qq.com/s/aZtfwik0weJN5JzYc-JxYg&quot;&gt;åŠ¨æ€ä»£ç†&lt;/a&gt;å®ç°çš„ï¼Œä»£ç†æ–¹å¼æœ‰ä¸¤ç§ï¼šJDK åŠ¨æ€ä»£ç†å’Œ CGLIB ä»£ç†ã€‚&lt;/p&gt;

&lt;p&gt;â‘ ã€JDK åŠ¨æ€ä»£ç†æ˜¯åŸºäºæ¥å£çš„ä»£ç†ï¼Œåªèƒ½ä»£ç†å®ç°äº†æ¥å£çš„ç±»ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†æ—¶ï¼ŒSpring AOP ä¼šåˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œè¯¥ä»£ç†å¯¹è±¡å®ç°äº†ç›®æ ‡å¯¹è±¡æ‰€å®ç°çš„æ¥å£ï¼Œå¹¶åœ¨æ–¹æ³•è°ƒç”¨å‰åæ’å…¥æ¨ªåˆ‡é€»è¾‘ã€‚&lt;/p&gt;

&lt;p&gt;ä¼˜ç‚¹ï¼šåªéœ€ä¾èµ– JDK è‡ªå¸¦çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;java.lang.reflect.Proxy&lt;/code&gt; ç±»ï¼Œä¸éœ€è¦é¢å¤–çš„åº“ï¼›ç¼ºç‚¹ï¼šåªèƒ½ä»£ç†æ¥å£ï¼Œä¸èƒ½ä»£ç†ç±»æœ¬èº«ã€‚&lt;/p&gt;

&lt;p&gt;â‘¡ã€CGLIB åŠ¨æ€ä»£ç†æ˜¯åŸºäºç»§æ‰¿çš„ä»£ç†ï¼Œå¯ä»¥ä»£ç†æ²¡æœ‰å®ç°æ¥å£çš„ç±»ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ CGLIB åŠ¨æ€ä»£ç†æ—¶ï¼ŒSpring AOP ä¼šç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»ï¼Œå¹¶åœ¨æ–¹æ³•è°ƒç”¨å‰åæ’å…¥æ¨ªåˆ‡é€»è¾‘ã€‚&lt;/p&gt;

&lt;p&gt;ä¼˜ç‚¹ï¼šå¯ä»¥ä»£ç†æ²¡æœ‰å®ç°æ¥å£çš„ç±»ï¼Œçµæ´»æ€§æ›´é«˜ï¼›ç¼ºç‚¹ï¼šéœ€è¦ä¾èµ– CGLIB åº“ï¼Œåˆ›å»ºä»£ç†å¯¹è±¡çš„å¼€é”€ç›¸å¯¹è¾ƒå¤§ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;JDK åŠ¨æ€ä»£ç†&lt;/strong&gt;åªèƒ½ä»£ç†å®ç°äº†æ¥å£çš„ç±»ã€‚å®ƒçš„å®ç°åŸºäº Java çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;java.lang.reflect.Proxy&lt;/code&gt; ç±»å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;InvocationHandler&lt;/code&gt; æ¥å£ï¼Œ&lt;strong&gt;è¿è¡Œæ—¶åœ¨å†…å­˜ä¸­åŠ¨æ€ç”Ÿæˆä»£ç†ç±»çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.class&lt;/code&gt; æ–‡ä»¶å¹¶åŠ è½½æ‰§è¡Œ&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;JDK Proxy æ˜¯é€šè¿‡åœ¨å†…å­˜ä¸­åŠ¨æ€åˆ›å»ºä¸€ä¸ªå®ç°äº†åŒæ ·æ¥å£çš„ä»£ç†ç±»æ¥â€œä»£ç†â€ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ã€‚&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;æ¯”è¾ƒç»´åº¦&lt;/th&gt;
      &lt;th&gt;JDK åŠ¨æ€ä»£ç†&lt;/th&gt;
      &lt;th&gt;CGLIB åŠ¨æ€ä»£ç†&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;ä»£ç†å¯¹è±¡&lt;/td&gt;
      &lt;td&gt;å¿…é¡»å®ç°æ¥å£&lt;/td&gt;
      &lt;td&gt;ä¸éœ€è¦æ¥å£&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;å®ç°æ–¹å¼&lt;/td&gt;
      &lt;td&gt;JDK Proxy + åå°„&lt;/td&gt;
      &lt;td&gt;ç»§æ‰¿ + å­—èŠ‚ç å¢å¼º&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;æ€§èƒ½ï¼ˆæ—©æœŸï¼‰&lt;/td&gt;
      &lt;td&gt;è¾ƒä½&lt;/td&gt;
      &lt;td&gt;è¾ƒé«˜&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;é™åˆ¶&lt;/td&gt;
      &lt;td&gt;ä¸èƒ½ä»£ç†ç±»æœ¬èº«&lt;/td&gt;
      &lt;td&gt;ä¸èƒ½ä»£ç† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;final&lt;/code&gt; ç±»/æ–¹æ³•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Spring é»˜è®¤ç­–ç•¥&lt;/td&gt;
      &lt;td&gt;æœ‰æ¥å£ï¼šJDK åŠ¨æ€ä»£ç†æ— æ¥å£ï¼šCGLIB&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;é€‰æ‹©-cglib-è¿˜æ˜¯-jdk-åŠ¨æ€ä»£ç†&quot;&gt;é€‰æ‹© CGLIB è¿˜æ˜¯ JDK åŠ¨æ€ä»£ç†ï¼Ÿ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;å¦‚æœç›®æ ‡å¯¹è±¡æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œåˆ™åªèƒ½ä½¿ç”¨ CGLIB ä»£ç†ã€‚å¦‚æœç›®æ ‡å¯¹è±¡å®ç°äº†æ¥å£ï¼Œé€šå¸¸é¦–é€‰ JDK åŠ¨æ€ä»£ç†ã€‚&lt;/li&gt;
  &lt;li&gt;è™½ç„¶ CGLIB åœ¨ä»£ç†ç±»çš„ç”Ÿæˆè¿‡ç¨‹ä¸­å¯èƒ½æ¶ˆè€—æ›´å¤šèµ„æºï¼Œä½†åœ¨è¿è¡Œæ—¶å…·æœ‰è¾ƒé«˜çš„æ€§èƒ½ã€‚å¯¹äºæ€§èƒ½æ•æ„Ÿä¸”ä»£ç†å¯¹è±¡åˆ›å»ºé¢‘ç‡ä¸é«˜çš„åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ CGLIBã€‚&lt;/li&gt;
  &lt;li&gt;JDK åŠ¨æ€ä»£ç†æ˜¯ Java åŸç”Ÿæ”¯æŒçš„ï¼Œä¸éœ€è¦é¢å¤–å¼•å…¥åº“ã€‚è€Œ CGLIB éœ€è¦å°† CGLIB åº“ä½œä¸ºä¾èµ–åŠ å…¥é¡¹ç›®ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Fulong Ma</name></author><category term="Spring" /><category term="Spring" /><summary type="html">Spring AOP</summary></entry><entry><title type="html">Spring IoC</title><link href="https://mafulong.github.io/2025/05/06/Spring-IoC/" rel="alternate" type="text/html" title="Spring IoC" /><published>2025-05-06T00:00:00+08:00</published><updated>2025-05-06T00:00:00+08:00</updated><id>https://mafulong.github.io/2025/05/06/Spring%20IoC</id><content type="html" xml:base="https://mafulong.github.io/2025/05/06/Spring-IoC/">&lt;h2 id=&quot;sprint-ioc&quot;&gt;Sprint IoC&lt;/h2&gt;

&lt;h3 id=&quot;è°ˆè°ˆè‡ªå·±å¯¹äº-spring-ioc-çš„äº†è§£&quot;&gt;è°ˆè°ˆè‡ªå·±å¯¹äº Spring IoC çš„äº†è§£&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;IoCï¼ˆInversion of Control:æ§åˆ¶åè½¬ï¼‰&lt;/strong&gt; æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„æŠ€æœ¯å®ç°ã€‚IoC çš„æ€æƒ³å°±æ˜¯å°†åŸæœ¬åœ¨ç¨‹åºä¸­æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡çš„æ§åˆ¶æƒï¼Œäº¤ç”± Spring æ¡†æ¶æ¥ç®¡ç†ã€‚ä¸è¿‡ï¼Œ IoC å¹¶é Spring ç‰¹æœ‰ï¼Œåœ¨å…¶ä»–è¯­è¨€ä¸­ä¹Ÿæœ‰åº”ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆå«æ§åˆ¶åè½¬ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;æ§åˆ¶&lt;/strong&gt;ï¼šæŒ‡çš„æ˜¯å¯¹è±¡åˆ›å»ºï¼ˆå®ä¾‹åŒ–ã€ç®¡ç†ï¼‰çš„æƒåŠ›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åè½¬&lt;/strong&gt;ï¼šæ§åˆ¶æƒäº¤ç»™å¤–éƒ¨ç¯å¢ƒï¼ˆSpring æ¡†æ¶ã€IoC å®¹å™¨ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨å®é™…é¡¹ç›®ä¸­ä¸€ä¸ª Service ç±»å¯èƒ½ä¾èµ–äº†å¾ˆå¤šå…¶ä»–çš„ç±»ï¼Œå‡å¦‚æˆ‘ä»¬éœ€è¦å®ä¾‹åŒ–è¿™ä¸ª Serviceï¼Œä½ å¯èƒ½è¦æ¯æ¬¡éƒ½è¦ææ¸…è¿™ä¸ª Service æ‰€æœ‰åº•å±‚ç±»çš„æ„é€ å‡½æ•°ï¼Œè¿™å¯èƒ½ä¼šæŠŠäººé€¼ç–¯ã€‚å¦‚æœåˆ©ç”¨ IoC çš„è¯ï¼Œä½ åªéœ€è¦é…ç½®å¥½ï¼Œç„¶ååœ¨éœ€è¦çš„åœ°æ–¹å¼•ç”¨å°±è¡Œäº†ï¼Œè¿™å¤§å¤§å¢åŠ äº†é¡¹ç›®çš„å¯ç»´æŠ¤æ€§ä¸”é™ä½äº†å¼€å‘éš¾åº¦ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ Spring ä¸­ï¼Œ IoC å®¹å™¨æ˜¯ Spring ç”¨æ¥å®ç° IoC çš„è½½ä½“ï¼Œ IoC å®¹å™¨å®é™…ä¸Šå°±æ˜¯ä¸ª Mapï¼ˆkeyï¼Œvalueï¼‰ï¼ŒMap ä¸­å­˜æ”¾çš„æ˜¯å„ç§å¯¹è±¡ã€‚&lt;/p&gt;

&lt;p&gt;IOC æ˜¯ä¸€ç§æ€æƒ³ï¼Œ&lt;strong&gt;DI&lt;/strong&gt; æ˜¯å®ç° IOC çš„å…·ä½“æ–¹å¼ï¼Œæ¯”å¦‚è¯´åˆ©ç”¨æ³¨å…¥æœºåˆ¶ï¼ˆå¦‚æ„é€ å™¨æ³¨å…¥ã€Setter æ³¨å…¥ï¼‰å°†ä¾èµ–ä¼ é€’ç»™ç›®æ ‡å¯¹è±¡ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å°†ä¸€ä¸ªç±»å£°æ˜ä¸º-bean-çš„æ³¨è§£æœ‰å“ªäº›&quot;&gt;å°†ä¸€ä¸ªç±»å£°æ˜ä¸º Bean çš„æ³¨è§£æœ‰å“ªäº›?&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Component&lt;/code&gt;ï¼šé€šç”¨çš„æ³¨è§£ï¼Œå¯æ ‡æ³¨ä»»æ„ç±»ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Spring&lt;/code&gt; ç»„ä»¶ã€‚å¦‚æœä¸€ä¸ª Bean ä¸çŸ¥é“å±äºå“ªä¸ªå±‚ï¼Œå¯ä»¥ä½¿ç”¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Component&lt;/code&gt; æ³¨è§£æ ‡æ³¨ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Repository&lt;/code&gt; : å¯¹åº”æŒä¹…å±‚å³ Dao å±‚ï¼Œä¸»è¦ç”¨äºæ•°æ®åº“ç›¸å…³æ“ä½œã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Service&lt;/code&gt; : å¯¹åº”æœåŠ¡å±‚ï¼Œä¸»è¦æ¶‰åŠä¸€äº›å¤æ‚çš„é€»è¾‘ï¼Œéœ€è¦ç”¨åˆ° Dao å±‚ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Controller&lt;/code&gt; : å¯¹åº” Spring MVC æ§åˆ¶å±‚ï¼Œä¸»è¦ç”¨äºæ¥å—ç”¨æˆ·è¯·æ±‚å¹¶è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Service&lt;/code&gt; å±‚è¿”å›æ•°æ®ç»™å‰ç«¯é¡µé¢ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;component-å’Œ-bean-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ&quot;&gt;@Component å’Œ @Bean çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Component&lt;/code&gt; æ³¨è§£ä½œç”¨äºç±»ï¼Œè€Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Bean&lt;/code&gt;æ³¨è§£ä½œç”¨äºæ–¹æ³•ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Component&lt;/code&gt;é€šå¸¸æ˜¯é€šè¿‡ç±»è·¯å¾„æ‰«ææ¥è‡ªåŠ¨ä¾¦æµ‹ä»¥åŠè‡ªåŠ¨è£…é…åˆ° Spring å®¹å™¨ä¸­ï¼ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@ComponentScan&lt;/code&gt; æ³¨è§£å®šä¹‰è¦æ‰«æçš„è·¯å¾„ä»ä¸­æ‰¾å‡ºæ ‡è¯†äº†éœ€è¦è£…é…çš„ç±»è‡ªåŠ¨è£…é…åˆ° Spring çš„ bean å®¹å™¨ä¸­ï¼‰ã€‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Bean&lt;/code&gt; æ³¨è§£é€šå¸¸æ˜¯æˆ‘ä»¬åœ¨æ ‡æœ‰è¯¥æ³¨è§£çš„æ–¹æ³•ä¸­å®šä¹‰äº§ç”Ÿè¿™ä¸ª bean,&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Bean&lt;/code&gt;å‘Šè¯‰äº† Spring è¿™æ˜¯æŸä¸ªç±»çš„å®ä¾‹ï¼Œå½“æˆ‘éœ€è¦ç”¨å®ƒçš„æ—¶å€™è¿˜ç»™æˆ‘ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Bean&lt;/code&gt; æ³¨è§£æ¯” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Component&lt;/code&gt; æ³¨è§£çš„è‡ªå®šä¹‰æ€§æ›´å¼ºï¼Œè€Œä¸”å¾ˆå¤šåœ°æ–¹æˆ‘ä»¬åªèƒ½é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Bean&lt;/code&gt; æ³¨è§£æ¥æ³¨å†Œ beanã€‚æ¯”å¦‚å½“æˆ‘ä»¬å¼•ç”¨ç¬¬ä¸‰æ–¹åº“ä¸­çš„ç±»éœ€è¦è£…é…åˆ° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Spring&lt;/code&gt;å®¹å™¨æ—¶ï¼Œåˆ™åªèƒ½é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Bean&lt;/code&gt;æ¥å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;nd&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AppConfig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TransferService&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;transferService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TransferServiceImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;æ³¨å…¥-bean-çš„æ³¨è§£æœ‰å“ªäº›&quot;&gt;æ³¨å…¥ Bean çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;Spring å†…ç½®çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Autowired&lt;/code&gt; ä»¥åŠ JDK å†…ç½®çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Resource&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Inject&lt;/code&gt; éƒ½å¯ä»¥ç”¨äºæ³¨å…¥ Beanã€‚&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Annotation&lt;/th&gt;
      &lt;th&gt;Package&lt;/th&gt;
      &lt;th&gt;Source&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Autowired&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.bean.factory&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Spring 2.5+&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Resource&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;javax.annotation&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Java JSR-250&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Inject&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;javax.inject&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Java JSR-330&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Autowired&lt;/code&gt; å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Resource&lt;/code&gt;ä½¿ç”¨çš„æ¯”è¾ƒå¤šä¸€äº›ã€‚&lt;/p&gt;

&lt;p&gt;æ¨èæ„é€ å‡½æ•°æ³¨å…¥ã€‚&lt;/p&gt;

&lt;h3 id=&quot;autowired-å’Œ-resource-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ&quot;&gt;@Autowired å’Œ @Resource çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Autowired&lt;/code&gt; æ˜¯ Spring æä¾›çš„æ³¨è§£ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Resource&lt;/code&gt; æ˜¯ JDK æä¾›çš„æ³¨è§£ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Autowired&lt;/code&gt; é»˜è®¤çš„æ³¨å…¥æ–¹å¼ä¸º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;byType&lt;/code&gt;ï¼ˆæ ¹æ®ç±»å‹è¿›è¡ŒåŒ¹é…ï¼‰ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Resource&lt;/code&gt;é»˜è®¤æ³¨å…¥æ–¹å¼ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;byName&lt;/code&gt;ï¼ˆæ ¹æ®åç§°è¿›è¡ŒåŒ¹é…ï¼‰ã€‚&lt;/li&gt;
  &lt;li&gt;å½“ä¸€ä¸ªæ¥å£å­˜åœ¨å¤šä¸ªå®ç°ç±»çš„æƒ…å†µä¸‹ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Autowired&lt;/code&gt; å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Resource&lt;/code&gt;éƒ½éœ€è¦é€šè¿‡åç§°æ‰èƒ½æ­£ç¡®åŒ¹é…åˆ°å¯¹åº”çš„ Beanã€‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Autowired&lt;/code&gt; å¯ä»¥é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Qualifier&lt;/code&gt; æ³¨è§£æ¥æ˜¾å¼æŒ‡å®šåç§°ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Resource&lt;/code&gt;å¯ä»¥é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;name&lt;/code&gt; å±æ€§æ¥æ˜¾å¼æŒ‡å®šåç§°ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Autowired&lt;/code&gt; æ”¯æŒåœ¨æ„é€ å‡½æ•°ã€æ–¹æ³•ã€å­—æ®µå’Œå‚æ•°ä¸Šä½¿ç”¨ã€‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Resource&lt;/code&gt; ä¸»è¦ç”¨äºå­—æ®µå’Œæ–¹æ³•ä¸Šçš„æ³¨å…¥ï¼Œä¸æ”¯æŒåœ¨æ„é€ å‡½æ•°æˆ–å‚æ•°ä¸Šä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;æ³¨å…¥-bean-çš„æ–¹å¼æœ‰å“ªäº›&quot;&gt;æ³¨å…¥ Bean çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ä¾èµ–æ³¨å…¥ (Dependency Injection, DI) çš„å¸¸è§æ–¹å¼ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æ„é€ å‡½æ•°æ³¨å…¥ï¼šé€šè¿‡ç±»çš„æ„é€ å‡½æ•°æ¥æ³¨å…¥ä¾èµ–é¡¹ã€‚&lt;/li&gt;
  &lt;li&gt;Setter æ³¨å…¥ï¼šé€šè¿‡ç±»çš„ Setter æ–¹æ³•æ¥æ³¨å…¥ä¾èµ–é¡¹ã€‚&lt;/li&gt;
  &lt;li&gt;Fieldï¼ˆå­—æ®µï¼‰ æ³¨å…¥ï¼šç›´æ¥åœ¨ç±»çš„å­—æ®µä¸Šä½¿ç”¨æ³¨è§£ï¼ˆå¦‚ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Autowired&lt;/code&gt; æˆ– &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Resource&lt;/code&gt;ï¼‰æ¥æ³¨å…¥ä¾èµ–é¡¹ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;Spring å®˜æ–¹æ¨èæ„é€ å‡½æ•°æ³¨å…¥&lt;/strong&gt;ï¼Œè¿™ç§æ³¨å…¥æ–¹å¼çš„ä¼˜åŠ¿å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä¾èµ–å®Œæ•´æ€§ï¼šç¡®ä¿æ‰€æœ‰å¿…éœ€ä¾èµ–åœ¨å¯¹è±¡åˆ›å»ºæ—¶å°±è¢«æ³¨å…¥ï¼Œé¿å…äº†ç©ºæŒ‡é’ˆå¼‚å¸¸çš„é£é™©ã€‚&lt;/li&gt;
  &lt;li&gt;ä¸å¯å˜æ€§ï¼šæœ‰åŠ©äºåˆ›å»ºä¸å¯å˜å¯¹è±¡ï¼Œæé«˜äº†çº¿ç¨‹å®‰å…¨æ€§ã€‚&lt;/li&gt;
  &lt;li&gt;åˆå§‹åŒ–ä¿è¯ï¼šç»„ä»¶åœ¨ä½¿ç”¨å‰å·²å®Œå…¨åˆå§‹åŒ–ï¼Œå‡å°‘äº†æ½œåœ¨çš„é”™è¯¯ã€‚&lt;/li&gt;
  &lt;li&gt;æµ‹è¯•ä¾¿åˆ©æ€§ï¼šåœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥æ¨¡æ‹Ÿçš„ä¾èµ–é¡¹ï¼Œè€Œä¸å¿…ä¾èµ– Spring å®¹å™¨è¿›è¡Œæ³¨å…¥ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ„é€ å‡½æ•°æ³¨å…¥é€‚åˆå¤„ç†&lt;strong&gt;å¿…éœ€çš„ä¾èµ–é¡¹&lt;/strong&gt;ï¼Œè€Œ &lt;strong&gt;Setter æ³¨å…¥&lt;/strong&gt; åˆ™æ›´é€‚åˆ&lt;strong&gt;å¯é€‰çš„ä¾èµ–é¡¹&lt;/strong&gt;ï¼Œè¿™äº›ä¾èµ–é¡¹å¯ä»¥æœ‰é»˜è®¤å€¼æˆ–åœ¨å¯¹è±¡ç”Ÿå‘½å‘¨æœŸä¸­åŠ¨æ€è®¾ç½®ã€‚è™½ç„¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Autowired&lt;/code&gt; å¯ä»¥ç”¨äº Setter æ–¹æ³•æ¥å¤„ç†å¿…éœ€çš„ä¾èµ–é¡¹ï¼Œä½†æ„é€ å‡½æ•°æ³¨å…¥ä»ç„¶æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ç¬¬ä¸‰æ–¹ç±»ä¸æä¾› Setter æ–¹æ³•ï¼‰ï¼Œæ„é€ å‡½æ•°æ³¨å…¥å¯èƒ½æ˜¯&lt;strong&gt;å”¯ä¸€çš„é€‰æ‹©&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;bean-çš„ä½œç”¨åŸŸæœ‰å“ªäº›&quot;&gt;Bean çš„ä½œç”¨åŸŸæœ‰å“ªäº›?&lt;/h3&gt;

&lt;p&gt;Spring ä¸­ Bean çš„ä½œç”¨åŸŸé€šå¸¸æœ‰ä¸‹é¢å‡ ç§ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;singleton&lt;/strong&gt; : IoC å®¹å™¨ä¸­åªæœ‰å”¯ä¸€çš„ bean å®ä¾‹ã€‚Spring ä¸­çš„ bean é»˜è®¤éƒ½æ˜¯å•ä¾‹çš„ï¼Œæ˜¯å¯¹å•ä¾‹è®¾è®¡æ¨¡å¼çš„åº”ç”¨ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;prototype&lt;/strong&gt; : æ¯æ¬¡è·å–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ bean å®ä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿ç»­ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getBean()&lt;/code&gt; ä¸¤æ¬¡ï¼Œå¾—åˆ°çš„æ˜¯ä¸åŒçš„ Bean å®ä¾‹ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;request&lt;/strong&gt; ï¼ˆä»… Web åº”ç”¨å¯ç”¨ï¼‰: æ¯ä¸€æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ beanï¼ˆè¯·æ±‚ beanï¼‰ï¼Œè¯¥ bean ä»…åœ¨å½“å‰ HTTP request å†…æœ‰æ•ˆã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;session&lt;/strong&gt; ï¼ˆä»… Web åº”ç”¨å¯ç”¨ï¼‰ : æ¯ä¸€æ¬¡æ¥è‡ªæ–° session çš„ HTTP è¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ beanï¼ˆä¼šè¯ beanï¼‰ï¼Œè¯¥ bean ä»…åœ¨å½“å‰ HTTP session å†…æœ‰æ•ˆã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;application/global-session&lt;/strong&gt; ï¼ˆä»… Web åº”ç”¨å¯ç”¨ï¼‰ï¼šæ¯ä¸ª Web åº”ç”¨åœ¨å¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ª Beanï¼ˆåº”ç”¨ Beanï¼‰ï¼Œè¯¥ bean ä»…åœ¨å½“å‰åº”ç”¨å¯åŠ¨æ—¶é—´å†…æœ‰æ•ˆã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;websocket&lt;/strong&gt; ï¼ˆä»… Web åº”ç”¨å¯ç”¨ï¼‰ï¼šæ¯ä¸€æ¬¡ WebSocket ä¼šè¯äº§ç”Ÿä¸€ä¸ªæ–°çš„ beanã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;bean-çš„ç”Ÿå‘½å‘¨æœŸäº†è§£ä¹ˆ&quot;&gt;Bean çš„ç”Ÿå‘½å‘¨æœŸäº†è§£ä¹ˆ?&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;åˆ›å»º Bean çš„å®ä¾‹&lt;/strong&gt;ï¼šBean å®¹å™¨é¦–å…ˆä¼šæ‰¾åˆ°é…ç½®æ–‡ä»¶ä¸­çš„ Bean å®šä¹‰ï¼Œç„¶åä½¿ç”¨ Java åå°„ API æ¥åˆ›å»º Bean çš„å®ä¾‹ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Bean å±æ€§èµ‹å€¼/å¡«å……&lt;/strong&gt;ï¼šä¸º Bean è®¾ç½®ç›¸å…³å±æ€§å’Œä¾èµ–ï¼Œä¾‹å¦‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Autowired&lt;/code&gt; ç­‰æ³¨è§£æ³¨å…¥çš„å¯¹è±¡ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Value&lt;/code&gt; æ³¨å…¥çš„å€¼ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setter&lt;/code&gt;æ–¹æ³•æˆ–æ„é€ å‡½æ•°æ³¨å…¥ä¾èµ–å’Œå€¼ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Resource&lt;/code&gt;æ³¨å…¥çš„å„ç§èµ„æºã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Bean åˆå§‹åŒ–&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;å¦‚æœ Bean å®ç°äº† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanNameAware&lt;/code&gt; æ¥å£ï¼Œè°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setBeanName()&lt;/code&gt;æ–¹æ³•ï¼Œä¼ å…¥ Bean çš„åå­—ã€‚
     - å¦‚æœ Bean å®ç°äº† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanClassLoaderAware&lt;/code&gt; æ¥å£ï¼Œè°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setBeanClassLoader()&lt;/code&gt;æ–¹æ³•ï¼Œä¼ å…¥ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ClassLoader&lt;/code&gt;å¯¹è±¡çš„å®ä¾‹ã€‚&lt;/li&gt;
      &lt;li&gt;å¦‚æœ Bean å®ç°äº† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanFactoryAware&lt;/code&gt; æ¥å£ï¼Œè°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setBeanFactory()&lt;/code&gt;æ–¹æ³•ï¼Œä¼ å…¥ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt;å¯¹è±¡çš„å®ä¾‹ã€‚&lt;/li&gt;
      &lt;li&gt;ä¸ä¸Šé¢çš„ç±»ä¼¼ï¼Œå¦‚æœå®ç°äº†å…¶ä»– &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*.Aware&lt;/code&gt;æ¥å£ï¼Œå°±è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ã€‚&lt;/li&gt;
      &lt;li&gt;å¦‚æœæœ‰å’ŒåŠ è½½è¿™ä¸ª Bean çš„ Spring å®¹å™¨ç›¸å…³çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanPostProcessor&lt;/code&gt; å¯¹è±¡ï¼Œæ‰§è¡Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;postProcessBeforeInitialization()&lt;/code&gt; æ–¹æ³•&lt;/li&gt;
      &lt;li&gt;å¦‚æœ Bean å®ç°äº†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;InitializingBean&lt;/code&gt;æ¥å£ï¼Œæ‰§è¡Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;afterPropertiesSet()&lt;/code&gt;æ–¹æ³•ã€‚&lt;/li&gt;
      &lt;li&gt;å¦‚æœ Bean åœ¨é…ç½®æ–‡ä»¶ä¸­çš„å®šä¹‰åŒ…å« &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;init-method&lt;/code&gt; å±æ€§ï¼Œæ‰§è¡ŒæŒ‡å®šçš„æ–¹æ³•ã€‚&lt;/li&gt;
      &lt;li&gt;å¦‚æœæœ‰å’ŒåŠ è½½è¿™ä¸ª Bean çš„ Spring å®¹å™¨ç›¸å…³çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanPostProcessor&lt;/code&gt; å¯¹è±¡ï¼Œæ‰§è¡Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;postProcessAfterInitialization()&lt;/code&gt; æ–¹æ³•ã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;é”€æ¯ Bean&lt;/p&gt;

    &lt;p&gt;ï¼šé”€æ¯å¹¶ä¸æ˜¯è¯´è¦ç«‹é©¬æŠŠ Bean ç»™é”€æ¯æ‰ï¼Œè€Œæ˜¯æŠŠ Bean çš„é”€æ¯æ–¹æ³•å…ˆè®°å½•ä¸‹æ¥ï¼Œå°†æ¥éœ€è¦é”€æ¯ Bean æˆ–è€…é”€æ¯å®¹å™¨çš„æ—¶å€™ï¼Œå°±è°ƒç”¨è¿™äº›æ–¹æ³•å»é‡Šæ”¾ Bean æ‰€æŒæœ‰çš„èµ„æºã€‚&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;å¦‚æœ Bean å®ç°äº† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DisposableBean&lt;/code&gt; æ¥å£ï¼Œæ‰§è¡Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;destroy()&lt;/code&gt; æ–¹æ³•ã€‚&lt;/li&gt;
      &lt;li&gt;å¦‚æœ Bean åœ¨é…ç½®æ–‡ä»¶ä¸­çš„å®šä¹‰åŒ…å« &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;destroy-method&lt;/code&gt; å±æ€§ï¼Œæ‰§è¡ŒæŒ‡å®šçš„ Bean é”€æ¯æ–¹æ³•ã€‚æˆ–è€…ï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@PreDestroy&lt;/code&gt; æ³¨è§£æ ‡è®° Bean é”€æ¯ä¹‹å‰æ‰§è¡Œçš„æ–¹æ³•ã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Bean çš„ç”Ÿå‘½å‘¨æœŸå¤§è‡´åˆ†ä¸ºäº”ä¸ªé˜¶æ®µï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202505062341884.png&quot; alt=&quot;ä¸‰åˆ†æ¶é¢æ¸£é€†è¢­ï¼šBeanç”Ÿå‘½å‘¨æœŸäº”ä¸ªé˜¶æ®µ&quot; /&gt;ä¸‰åˆ†æ¶é¢æ¸£é€†è¢­ï¼šBeanç”Ÿå‘½å‘¨æœŸäº”ä¸ªé˜¶æ®µ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å®ä¾‹åŒ–&lt;/strong&gt;ï¼šSpring é¦–å…ˆä½¿ç”¨æ„é€ æ–¹æ³•æˆ–è€…å·¥å‚æ–¹æ³•åˆ›å»ºä¸€ä¸ª Bean çš„å®ä¾‹ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼ŒBean åªæ˜¯ä¸€ä¸ªç©ºçš„ Java å¯¹è±¡ï¼Œè¿˜æœªè®¾ç½®ä»»ä½•å±æ€§ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å±æ€§èµ‹å€¼&lt;/strong&gt;ï¼šSpring å°†é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§å€¼æˆ–ä¾èµ–çš„ Bean æ³¨å…¥åˆ°è¯¥ Bean ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºä¾èµ–æ³¨å…¥ï¼Œç¡®ä¿ Bean æ‰€éœ€çš„æ‰€æœ‰ä¾èµ–éƒ½è¢«æ³¨å…¥ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åˆå§‹åŒ–&lt;/strong&gt;ï¼šSpring è°ƒç”¨ afterPropertiesSet æ–¹æ³•ï¼Œæˆ–é€šè¿‡é…ç½®æ–‡ä»¶æŒ‡å®šçš„ init-method æ–¹æ³•ï¼Œå®Œæˆåˆå§‹åŒ–ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä½¿ç”¨ä¸­&lt;/strong&gt;ï¼šBean å‡†å¤‡å¥½å¯ä»¥ä½¿ç”¨äº†ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;é”€æ¯&lt;/strong&gt;ï¼šåœ¨å®¹å™¨å…³é—­æ—¶ï¼ŒSpring ä¼šè°ƒç”¨ destroy æ–¹æ³•ï¼Œå®Œæˆ Bean çš„æ¸…ç†å·¥ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;å¦‚ä½•è®°å¿†å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æ•´ä½“ä¸Šå¯ä»¥ç®€å•åˆ†ä¸ºå››æ­¥ï¼šå®ä¾‹åŒ– â€”&amp;gt; å±æ€§èµ‹å€¼ â€”&amp;gt; åˆå§‹åŒ– â€”&amp;gt; é”€æ¯ã€‚&lt;/li&gt;
  &lt;li&gt;åˆå§‹åŒ–è¿™ä¸€æ­¥æ¶‰åŠåˆ°çš„æ­¥éª¤æ¯”è¾ƒå¤šï¼ŒåŒ…å« &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Aware&lt;/code&gt; æ¥å£çš„ä¾èµ–æ³¨å…¥ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanPostProcessor&lt;/code&gt; åœ¨åˆå§‹åŒ–å‰åçš„å¤„ç†ä»¥åŠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;InitializingBean&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;init-method&lt;/code&gt; çš„åˆå§‹åŒ–æ“ä½œã€‚&lt;/li&gt;
  &lt;li&gt;é”€æ¯è¿™ä¸€æ­¥ä¼šæ³¨å†Œç›¸å…³é”€æ¯å›è°ƒæ¥å£ï¼Œæœ€åé€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DisposableBean&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;destory-method&lt;/code&gt; è¿›è¡Œé”€æ¯ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æœ€åï¼Œå†åˆ†äº«ä¸€å¼ æ¸…æ™°çš„å›¾è§£ï¼ˆå›¾æºï¼š&lt;a href=&quot;https://chaycao.github.io/2020/02/15/å¦‚ä½•è®°å¿†Spring-Beançš„ç”Ÿå‘½å‘¨æœŸ.html&quot;&gt;å¦‚ä½•è®°å¿† Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202505062339187.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;spring-ä¸­çš„å•ä¾‹-bean-ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜å—&quot;&gt;Spring ä¸­çš„å•ä¾‹ Bean ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜å—ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;Spring Bean çš„é»˜è®¤ä½œç”¨åŸŸæ˜¯å•ä¾‹ï¼ˆSingletonï¼‰ï¼Œè¿™æ„å‘³ç€ Spring å®¹å™¨ä¸­åªä¼šå­˜åœ¨ä¸€ä¸ª Bean å®ä¾‹ï¼Œå¹¶ä¸”è¯¥å®ä¾‹ä¼šè¢«å¤šä¸ªçº¿ç¨‹å…±äº«ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœå•ä¾‹ Bean æ˜¯æ— çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå•ä¾‹ Bean æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æ¯”å¦‚ Spring MVC ä¸­çš„ Controllerã€Serviceã€Dao ç­‰ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯æ— çŠ¶æ€çš„ã€‚&lt;/p&gt;

&lt;p&gt;ä½†å¦‚æœ Bean çš„å†…éƒ¨çŠ¶æ€æ˜¯å¯å˜çš„ï¼Œä¸”æ²¡æœ‰è¿›è¡Œé€‚å½“çš„åŒæ­¥å¤„ç†ï¼Œå°±å¯èƒ½å‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºæœ‰çŠ¶æ€å•ä¾‹ Bean çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå¸¸è§çš„ä¸‰ç§è§£å†³åŠæ³•æ˜¯ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;é¿å…å¯å˜æˆå‘˜å˜é‡&lt;/strong&gt;: å°½é‡è®¾è®¡ Bean ä¸ºæ— çŠ¶æ€ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä½¿ç”¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ThreadLocal&lt;/code&gt;&lt;/strong&gt;: å°†å¯å˜æˆå‘˜å˜é‡ä¿å­˜åœ¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ThreadLocal&lt;/code&gt; ä¸­ï¼Œç¡®ä¿çº¿ç¨‹ç‹¬ç«‹ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä½¿ç”¨åŒæ­¥æœºåˆ¶&lt;/strong&gt;: åˆ©ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;synchronized&lt;/code&gt; æˆ– &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantLock&lt;/code&gt; æ¥è¿›è¡ŒåŒæ­¥æ§åˆ¶ï¼Œç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚&lt;/li&gt;
&lt;/ol&gt;</content><author><name>Fulong Ma</name></author><category term="Spring" /><category term="Spring" /><summary type="html">Sprint IoC</summary></entry><entry><title type="html">Spring å¾ªç¯ä¾èµ–</title><link href="https://mafulong.github.io/2025/05/06/Spring-%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96/" rel="alternate" type="text/html" title="Spring å¾ªç¯ä¾èµ–" /><published>2025-05-06T00:00:00+08:00</published><updated>2025-05-06T00:00:00+08:00</updated><id>https://mafulong.github.io/2025/05/06/Spring%20%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96</id><content type="html" xml:base="https://mafulong.github.io/2025/05/06/Spring-%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96/">&lt;h2 id=&quot;spring-å¾ªç¯ä¾èµ–&quot;&gt;Spring å¾ªç¯ä¾èµ–&lt;/h2&gt;

&lt;h2 id=&quot;å¾ªç¯ä¾èµ–&quot;&gt;å¾ªç¯ä¾èµ–&lt;/h2&gt;

&lt;p&gt;å¤šä¸ªbeanã€‚A ä¾èµ– Bï¼ŒB ä¾èµ– Aï¼Œæˆ–è€… C ä¾èµ– Cï¼Œå°±æˆäº†å¾ªç¯ä¾èµ–ã€‚åŸå› å¾ˆç®€å•ï¼ŒAB å¾ªç¯ä¾èµ–ï¼ŒA å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œå‘ç°ä¾èµ– Bï¼Œåˆ›å»º B å®ä¾‹ï¼Œåˆ›å»º B çš„æ—¶å€™å‘ç°éœ€è¦ Aï¼Œåˆ›å»º A1 å®ä¾‹â€¦â€¦æ— é™å¥—å¨ƒã€‚ã€‚ã€‚ã€‚&lt;/p&gt;

&lt;p&gt;å¾ªç¯ä¾èµ–åªå‘ç”Ÿåœ¨ Singleton ä½œç”¨åŸŸçš„ Bean ä¹‹é—´ï¼Œå› ä¸ºå¦‚æœæ˜¯ Prototype ä½œç”¨åŸŸçš„ Beanï¼ŒSpring ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚&lt;/p&gt;

&lt;h2 id=&quot;spring-å¯ä»¥è§£å†³å“ªäº›æƒ…å†µçš„å¾ªç¯ä¾èµ–&quot;&gt;Spring å¯ä»¥è§£å†³å“ªäº›æƒ…å†µçš„å¾ªç¯ä¾èµ–ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;çœ‹çœ‹è¿™å‡ ç§æƒ…å½¢ï¼ˆAB å¾ªç¯ä¾èµ–ï¼‰ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202505062344583.png&quot; alt=&quot;ä¸‰åˆ†æ¶é¢æ¸£é€†è¢­ï¼šå¾ªç¯ä¾èµ–çš„å‡ ç§æƒ…å½¢&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;AB å‡é‡‡ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œä¸æ”¯æŒ&lt;/li&gt;
  &lt;li&gt;AB å‡é‡‡ç”¨ setter æ³¨å…¥ï¼Œæ”¯æŒ&lt;/li&gt;
  &lt;li&gt;AB å‡é‡‡ç”¨å±æ€§è‡ªåŠ¨æ³¨å…¥ï¼Œæ”¯æŒ&lt;/li&gt;
  &lt;li&gt;A ä¸­æ³¨å…¥çš„ B ä¸º setter æ³¨å…¥ï¼ŒB ä¸­æ³¨å…¥çš„ A ä¸ºæ„é€ å™¨æ³¨å…¥ï¼Œæ”¯æŒ&lt;/li&gt;
  &lt;li&gt;B ä¸­æ³¨å…¥çš„ A ä¸º setter æ³¨å…¥ï¼ŒA ä¸­æ³¨å…¥çš„ B ä¸ºæ„é€ å™¨æ³¨å…¥ï¼Œä¸æ”¯æŒ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¬¬å››ç§å¯ä»¥ï¼Œç¬¬äº”ç§ä¸å¯ä»¥çš„åŸå› æ˜¯ Spring åœ¨åˆ›å»º Bean æ—¶é»˜è®¤ä¼šæ ¹æ®è‡ªç„¶æ’åºè¿›è¡Œåˆ›å»ºï¼Œæ‰€ä»¥ A ä¼šå…ˆäº B è¿›è¡Œåˆ›å»ºã€‚&lt;/p&gt;

&lt;p&gt;ç®€å•æ€»ç»“ä¸‹ï¼Œå½“å¾ªç¯ä¾èµ–çš„å®ä¾‹éƒ½é‡‡ç”¨ setter æ–¹æ³•æ³¨å…¥æ—¶ï¼ŒSpring æ”¯æŒï¼Œéƒ½é‡‡ç”¨æ„é€ å™¨æ³¨å…¥çš„æ—¶å€™ï¼Œä¸æ”¯æŒï¼›æ„é€ å™¨æ³¨å…¥å’Œ setter æ³¨å…¥åŒæ—¶å­˜åœ¨çš„æ—¶å€™ï¼Œçœ‹å¤©&lt;/p&gt;

&lt;h2 id=&quot;spring-æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–å‘¢&quot;&gt;Spring æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–å‘¢ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;Spring é€šè¿‡ä¸‰çº§ç¼“å­˜æœºåˆ¶æ¥è§£å†³å¾ªç¯ä¾èµ–ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä¸€çº§ç¼“å­˜ï¼šå­˜æ”¾å®Œå…¨åˆå§‹åŒ–å¥½çš„å•ä¾‹ Beanã€‚&lt;/li&gt;
  &lt;li&gt;äºŒçº§ç¼“å­˜ï¼šå­˜æ”¾æ­£åœ¨åˆ›å»ºä½†æœªå®Œå…¨åˆå§‹åŒ–çš„ Bean å®ä¾‹ã€‚&lt;/li&gt;
  &lt;li&gt;ä¸‰çº§ç¼“å­˜ï¼šå­˜æ”¾ Bean å·¥å‚å¯¹è±¡ï¼Œç”¨äºæå‰æš´éœ² Beanã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202505062345571.png&quot; alt=&quot;ä¸‰åˆ†æ¶é¢æ¸£é€†è¢­ï¼šä¸‰çº§ç¼“å­˜&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ä¸‰çº§ç¼“å­˜è§£å†³å¾ªç¯ä¾èµ–çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„&quot;&gt;ä¸‰çº§ç¼“å­˜è§£å†³å¾ªç¯ä¾èµ–çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;å®ä¾‹åŒ– Bean æ—¶ï¼Œå°†å…¶æ—©æœŸå¼•ç”¨æ”¾å…¥ä¸‰çº§ç¼“å­˜ã€‚&lt;/li&gt;
  &lt;li&gt;å…¶ä»–ä¾èµ–è¯¥ Bean çš„å¯¹è±¡ï¼Œå¯ä»¥ä»ç¼“å­˜ä¸­è·å–å…¶å¼•ç”¨ã€‚&lt;/li&gt;
  &lt;li&gt;åˆå§‹åŒ–å®Œæˆåï¼Œå°† Bean ç§»å…¥ä¸€çº§ç¼“å­˜ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å…¶å®å°±æ˜¯ä¸‰çº§ç¼“å­˜å­˜äº†ä»£ç†å¯¹è±¡/åŸå§‹å¯¹è±¡çš„å †åœ°å€ï¼Œåˆå§‹åŒ–åŠ¨ä½œåç§»ã€‚ ç»†èŠ‚å‚è€ƒ&lt;a href=&quot;https://javabetter.cn/sidebar/sanfene/spring.html#_16-spring-%E6%80%8E%E4%B9%88%E8%A7%A3%E5%86%B3%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96%E5%91%A2&quot;&gt;link&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜çº§ä¸å—&quot;&gt;ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼Ÿâ¼†çº§ä¸â¾å—ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ä¸è¡Œï¼Œä¸»è¦æ˜¯ä¸ºäº† &lt;strong&gt;â½£æˆä»£ç†å¯¹è±¡&lt;/strong&gt;ã€‚å¦‚æœæ˜¯æ²¡æœ‰ä»£ç†çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨äºŒçº§ç¼“å­˜è§£å†³å¾ªç¯ä¾èµ–ä¹Ÿæ˜¯ OK çš„ã€‚ä½†æ˜¯å¦‚æœå­˜åœ¨ä»£ç†ï¼Œä¸‰çº§æ²¡æœ‰é—®é¢˜ï¼ŒäºŒçº§å°±ä¸è¡Œäº†ã€‚&lt;/p&gt;

&lt;p&gt;å› ä¸ºä¸‰çº§ç¼“å­˜ä¸­æ”¾çš„æ˜¯â½£æˆå…·ä½“å¯¹è±¡çš„åŒ¿åå†…éƒ¨ç±»ï¼Œè·å– Object çš„æ—¶å€™ï¼Œå®ƒå¯ä»¥â½£æˆä»£ç†å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥è¿”å›æ™®é€šå¯¹è±¡ã€‚ä½¿â½¤ä¸‰çº§ç¼“å­˜ä¸»è¦æ˜¯ä¸ºäº†ä¿è¯ä¸ç®¡ä»€ä¹ˆæ—¶å€™ä½¿â½¤çš„éƒ½æ˜¯â¼€ä¸ªå¯¹è±¡ã€‚&lt;/p&gt;

&lt;p&gt;å½“æ¶‰åŠåˆ° AOP æ—¶ï¼Œä¸‰çº§ç¼“å­˜å°±æ˜¾å¾—éå¸¸é‡è¦äº†ï¼Œå› ä¸ºå®ƒç¡®ä¿äº†å³ä½¿åœ¨ Bean çš„åˆ›å»ºè¿‡ç¨‹ä¸­æœ‰å¤šæ¬¡å¯¹æ—©æœŸå¼•ç”¨çš„è¯·æ±‚ï¼Œä¹Ÿå§‹ç»ˆåªè¿”å›åŒä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œä»è€Œé¿å…äº†åŒä¸€ä¸ª Bean æœ‰å¤šä¸ªä»£ç†å¯¹è±¡çš„é—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;å‡è®¾åªæœ‰â¼†çº§ç¼“å­˜çš„æƒ…å†µï¼Œå¾€â¼†çº§ç¼“å­˜ä¸­æ”¾çš„æ˜¾ç¤ºâ¼€ä¸ªæ™®é€šçš„ Bean å¯¹è±¡ï¼ŒBean åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ BeanPostProcessor å»â½£æˆä»£ç†å¯¹è±¡ä¹‹åï¼Œè¦†ç›–æ‰â¼†çº§ç¼“å­˜ä¸­çš„æ™®é€š Bean å¯¹è±¡ï¼Œé‚£ä¹ˆå¯èƒ½å°±å¯¼è‡´å–åˆ°çš„ Bean å¯¹è±¡ä¸ä¸€è‡´äº†ã€‚&lt;/p&gt;

&lt;h4 id=&quot;å¦‚æœç¼ºå°‘ç¬¬äºŒçº§ç¼“å­˜ä¼šæœ‰ä»€ä¹ˆé—®é¢˜&quot;&gt;å¦‚æœç¼ºå°‘ç¬¬äºŒçº§ç¼“å­˜ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ&lt;/h4&gt;

&lt;p&gt;å¦‚æœæ²¡æœ‰äºŒçº§ç¼“å­˜ï¼ŒSpring æ— æ³•åœ¨æœªå®Œæˆåˆå§‹åŒ–çš„æƒ…å†µä¸‹æš´éœ² Beanã€‚ä¼šå¯¼è‡´ä»£ç† Bean çš„å¾ªç¯ä¾èµ–é—®é¢˜ï¼Œå› ä¸ºæŸäº›ä»£ç†é€»è¾‘æ— æ³•åœ¨ä¸‰çº§ç¼“å­˜ä¸­æå‰æš´éœ²ã€‚æœ€ç»ˆå¯èƒ½æŠ›å‡º BeanCurrentlyInCreationExceptionã€‚&lt;/p&gt;

&lt;h2 id=&quot;lazy-èƒ½è§£å†³å¾ªç¯ä¾èµ–å—&quot;&gt;@Lazy èƒ½è§£å†³å¾ªç¯ä¾èµ–å—ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Lazy&lt;/code&gt; ç”¨æ¥æ ‡è¯†ç±»æ˜¯å¦éœ€è¦æ‡’åŠ è½½/å»¶è¿ŸåŠ è½½ï¼Œå¯ä»¥ä½œç”¨åœ¨ç±»ä¸Šã€æ–¹æ³•ä¸Šã€æ„é€ å™¨ä¸Šã€æ–¹æ³•å‚æ•°ä¸Šã€æˆå‘˜å˜é‡ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;Spring Boot 2.2 æ–°å¢äº†&lt;strong&gt;å…¨å±€æ‡’åŠ è½½å±æ€§&lt;/strong&gt;ï¼Œå¼€å¯åå…¨å±€ bean è¢«è®¾ç½®ä¸ºæ‡’åŠ è½½ï¼Œéœ€è¦æ—¶å†å»åˆ›å»ºã€‚&lt;/p&gt;

&lt;p&gt;å¦‚éå¿…è¦ï¼Œå°½é‡ä¸è¦ç”¨å…¨å±€æ‡’åŠ è½½ã€‚å…¨å±€æ‡’åŠ è½½ä¼šè®© Bean ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™åŠ è½½ä¼šå˜æ…¢ï¼Œå¹¶ä¸”å®ƒä¼šå»¶è¿Ÿåº”ç”¨ç¨‹åºé—®é¢˜çš„å‘ç°ï¼ˆå½“ Bean è¢«åˆå§‹åŒ–æ—¶ï¼Œé—®é¢˜æ‰ä¼šå‡ºç°ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä¸€ä¸ª Bean æ²¡æœ‰è¢«æ ‡è®°ä¸ºæ‡’åŠ è½½ï¼Œé‚£ä¹ˆå®ƒä¼šåœ¨ Spring IoC å®¹å™¨å¯åŠ¨çš„è¿‡ç¨‹ä¸­è¢«åˆ›å»ºå’Œåˆå§‹åŒ–ã€‚å¦‚æœä¸€ä¸ª Bean è¢«æ ‡è®°ä¸ºæ‡’åŠ è½½ï¼Œé‚£ä¹ˆå®ƒä¸ä¼šåœ¨ Spring IoC å®¹å™¨å¯åŠ¨æ—¶ç«‹å³å®ä¾‹åŒ–ï¼Œè€Œæ˜¯åœ¨ç¬¬ä¸€æ¬¡è¢«è¯·æ±‚æ—¶æ‰åˆ›å»ºã€‚è¿™å¯ä»¥å¸®åŠ©å‡å°‘åº”ç”¨å¯åŠ¨æ—¶çš„åˆå§‹åŒ–æ—¶é—´ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Lazy&lt;/code&gt; è§£å†³å¾ªç¯ä¾èµ–çš„å…³é”®ç‚¹åœ¨äºä»£ç†å¯¹è±¡çš„ä½¿ç”¨ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;æ²¡æœ‰ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Lazy&lt;/code&gt; çš„æƒ…å†µä¸‹&lt;/strong&gt;ï¼šåœ¨ Spring å®¹å™¨åˆå§‹åŒ– &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A&lt;/code&gt; æ—¶ä¼šç«‹å³å°è¯•åˆ›å»º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;B&lt;/code&gt;ï¼Œè€Œåœ¨åˆ›å»º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;B&lt;/code&gt; çš„è¿‡ç¨‹ä¸­åˆä¼šå°è¯•åˆ›å»º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A&lt;/code&gt;ï¼Œæœ€ç»ˆå¯¼è‡´å¾ªç¯ä¾èµ–ï¼ˆå³æ— é™é€’å½’ï¼Œæœ€ç»ˆæŠ›å‡ºå¼‚å¸¸ï¼‰ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Lazy&lt;/code&gt; çš„æƒ…å†µä¸‹&lt;/strong&gt;ï¼šSpring ä¸ä¼šç«‹å³åˆ›å»º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;B&lt;/code&gt;ï¼Œè€Œæ˜¯ä¼šæ³¨å…¥ä¸€ä¸ª &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;B&lt;/code&gt; çš„ä»£ç†å¯¹è±¡ã€‚ç”±äºæ­¤æ—¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;B&lt;/code&gt; ä»æœªè¢«çœŸæ­£åˆå§‹åŒ–ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A&lt;/code&gt; çš„åˆå§‹åŒ–å¯ä»¥é¡ºåˆ©å®Œæˆã€‚ç­‰åˆ° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A&lt;/code&gt; å®ä¾‹å®é™…è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;B&lt;/code&gt; çš„æ–¹æ³•æ—¶ï¼Œä»£ç†å¯¹è±¡æ‰ä¼šè§¦å‘ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;B&lt;/code&gt; çš„çœŸæ­£åˆå§‹åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Lazy&lt;/code&gt; èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šæ‰“ç ´å¾ªç¯ä¾èµ–é“¾ï¼Œå…è®¸ Spring å®¹å™¨é¡ºåˆ©åœ°å®Œæˆ Bean çš„åˆ›å»ºå’Œæ³¨å…¥ã€‚ä½†è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªæ ¹æœ¬æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œå°¤å…¶æ˜¯åœ¨æ„é€ å‡½æ•°æ³¨å…¥ã€å¤æ‚çš„å¤šçº§ä¾èµ–ç­‰åœºæ™¯ä¸­ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Lazy&lt;/code&gt; æ— æ³•æœ‰æ•ˆåœ°è§£å†³é—®é¢˜ã€‚å› æ­¤ï¼Œæœ€ä½³å®è·µä»ç„¶æ˜¯å°½é‡é¿å…è®¾è®¡ä¸Šçš„å¾ªç¯ä¾èµ–ã€‚&lt;/p&gt;</content><author><name>Fulong Ma</name></author><category term="Spring" /><category term="Spring" /><summary type="html">Spring å¾ªç¯ä¾èµ–</summary></entry><entry><title type="html">SpringåŸºç¡€</title><link href="https://mafulong.github.io/2025/05/06/Spring%E5%9F%BA%E7%A1%80/" rel="alternate" type="text/html" title="SpringåŸºç¡€" /><published>2025-05-06T00:00:00+08:00</published><updated>2025-05-06T00:00:00+08:00</updated><id>https://mafulong.github.io/2025/05/06/Spring%E5%9F%BA%E7%A1%80</id><content type="html" xml:base="https://mafulong.github.io/2025/05/06/Spring%E5%9F%BA%E7%A1%80/">&lt;h2 id=&quot;springåŸºç¡€&quot;&gt;SpringåŸºç¡€&lt;/h2&gt;

&lt;p&gt;ä¸€å¥è¯æ¦‚æ‹¬ï¼š&lt;strong&gt;Spring æ˜¯ä¸€ä¸ªè½»é‡çº§ã€éå…¥ä¾µå¼çš„æ§åˆ¶åè½¬ (IoC) å’Œé¢å‘åˆ‡é¢ (AOP) çš„æ¡†æ¶ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä¸€èˆ¬è¯´ Spring æ¡†æ¶æŒ‡çš„éƒ½æ˜¯ Spring Frameworkï¼Œå®ƒæ˜¯å¾ˆå¤šæ¨¡å—çš„é›†åˆï¼Œä½¿ç”¨è¿™äº›æ¨¡å—å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ååŠ©æˆ‘ä»¬è¿›è¡Œå¼€å‘ï¼Œæ¯”å¦‚è¯´ Spring æ”¯æŒ IoCï¼ˆInversion of Control:æ§åˆ¶åè½¬ï¼‰ å’Œ AOP(Aspect-Oriented Programming:é¢å‘åˆ‡é¢ç¼–ç¨‹)ã€å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¯¹æ•°æ®åº“è¿›è¡Œè®¿é—®ã€å¯ä»¥å¾ˆæ–¹ä¾¿åœ°é›†æˆç¬¬ä¸‰æ–¹ç»„ä»¶ï¼ˆç”µå­é‚®ä»¶ï¼Œä»»åŠ¡ï¼Œè°ƒåº¦ï¼Œç¼“å­˜ç­‰ç­‰ï¼‰ã€å¯¹å•å…ƒæµ‹è¯•æ”¯æŒæ¯”è¾ƒå¥½ã€æ”¯æŒ RESTful Java åº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202505062328358.png&quot; alt=&quot;ä¸‰åˆ†æ¶é¢æ¸£é€†è¢­ï¼šSpringç‰¹æ€§&quot; style=&quot;zoom:67%;&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;IoC&lt;/strong&gt; å’Œ &lt;strong&gt;DI&lt;/strong&gt; çš„æ”¯æŒ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Spring çš„æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ªå¤§çš„å·¥å‚å®¹å™¨ï¼Œå¯ä»¥ç»´æŠ¤æ‰€æœ‰å¯¹è±¡çš„åˆ›å»ºå’Œä¾èµ–å…³ç³»ï¼ŒSpring å·¥å‚ç”¨äºç”Ÿæˆ Beanï¼Œå¹¶ä¸”ç®¡ç† Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œå®ç°&lt;strong&gt;é«˜å†…èšä½è€¦åˆ&lt;/strong&gt;çš„è®¾è®¡ç†å¿µã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;AOP ç¼–ç¨‹çš„æ”¯æŒ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Spring æä¾›äº†&lt;strong&gt;é¢å‘åˆ‡é¢ç¼–ç¨‹&lt;/strong&gt;ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°å¯¹ç¨‹åºè¿›è¡Œæƒé™æ‹¦æˆªã€è¿è¡Œç›‘æ§ç­‰åˆ‡é¢åŠŸèƒ½ã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ”¯æŒé€šè¿‡é…ç½®å°±æ¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œä¸éœ€è¦é€šè¿‡ç¡¬ç¼–ç çš„æ–¹å¼ï¼Œä»¥å‰é‡å¤çš„ä¸€äº›äº‹åŠ¡æäº¤ã€å›æ»šçš„ JDBC ä»£ç ï¼Œéƒ½å¯ä»¥ä¸ç”¨è‡ªå·±å†™äº†ã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å¿«æ·æµ‹è¯•çš„æ”¯æŒ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Spring å¯¹ Junit æä¾›æ”¯æŒï¼Œå¯ä»¥é€šè¿‡&lt;strong&gt;æ³¨è§£&lt;/strong&gt;å¿«æ·åœ°æµ‹è¯• Spring ç¨‹åºã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å¿«é€Ÿé›†æˆåŠŸèƒ½&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶ï¼ŒSpring ä¸æ’æ–¥å„ç§ä¼˜ç§€çš„å¼€æºæ¡†æ¶ï¼Œå…¶å†…éƒ¨æä¾›äº†å¯¹å„ç§ä¼˜ç§€æ¡†æ¶ï¼ˆå¦‚ï¼šStrutsã€Hibernateã€MyBatisã€Quartz ç­‰ï¼‰çš„ç›´æ¥æ”¯æŒã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å¤æ‚ API æ¨¡æ¿å°è£…&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Spring å¯¹ JavaEE å¼€å‘ä¸­éå¸¸éš¾ç”¨çš„ä¸€äº› APIï¼ˆJDBCã€JavaMailã€è¿œç¨‹è°ƒç”¨ç­‰ï¼‰éƒ½æä¾›äº†æ¨¡æ¿åŒ–çš„å°è£…ï¼Œè¿™äº›å°è£… API çš„æä¾›ä½¿å¾—åº”ç”¨éš¾åº¦å¤§å¤§é™ä½ã€‚&lt;/p&gt;

&lt;h2 id=&quot;1-ç®€å•è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯aop-å’Œ-ioc&quot;&gt;1. &lt;a href=&quot;https://javabetter.cn/sidebar/sanfene/spring.html#ç®€å•è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯aop-å’Œ-ioc&quot;&gt;ç®€å•è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯AOP å’Œ IoCï¼Ÿ&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;AOP&lt;/strong&gt;ï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œæ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å°†é‚£äº›ä¸æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æ— å…³ï¼Œä½†æ˜¯å¯¹å¤šä¸ªå¯¹è±¡äº§ç”Ÿå½±å“çš„å…¬å…±è¡Œä¸ºå°è£…èµ·æ¥ï¼Œå¦‚æ—¥å¿—è®°å½•ã€æ€§èƒ½ç»Ÿè®¡ã€äº‹åŠ¡ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;IoC&lt;/strong&gt;ï¼šæ§åˆ¶åè½¬ï¼Œæ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å°†å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡ä¹‹é—´çš„è°ƒç”¨è¿‡ç¨‹äº¤ç»™ Spring å®¹å™¨æ¥ç®¡ç†ã€‚&lt;/p&gt;

&lt;h2 id=&quot;2spring-æœ‰å“ªäº›æ¨¡å—å‘¢&quot;&gt;2.Spring æœ‰å“ªäº›æ¨¡å—å‘¢ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;Spring æ¡†æ¶æ˜¯åˆ†æ¨¡å—å­˜åœ¨ï¼Œé™¤äº†æœ€æ ¸å¿ƒçš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Spring Core Container&lt;/code&gt;æ˜¯å¿…è¦æ¨¡å—ä¹‹å¤–ï¼Œå…¶ä»–æ¨¡å—éƒ½æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;å¯é€‰&lt;/code&gt;ï¼Œå¤§çº¦æœ‰ 20 å¤šä¸ªæ¨¡å—ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202505062329603.png&quot; alt=&quot;Springæ¨¡å—åˆ’åˆ†&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æœ€ä¸»è¦çš„ä¸ƒå¤§æ¨¡å—ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;Spring Core&lt;/strong&gt;ï¼šSpring æ ¸å¿ƒï¼Œå®ƒæ˜¯æ¡†æ¶æœ€åŸºç¡€çš„éƒ¨åˆ†ï¼Œæä¾› IoC å’Œä¾èµ–æ³¨å…¥ DI ç‰¹æ€§ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Spring Context&lt;/strong&gt;ï¼šSpring ä¸Šä¸‹æ–‡å®¹å™¨ï¼Œå®ƒæ˜¯ BeanFactory åŠŸèƒ½åŠ å¼ºçš„ä¸€ä¸ªå­æ¥å£ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Spring Web&lt;/strong&gt;ï¼šå®ƒæä¾› Web åº”ç”¨å¼€å‘çš„æ”¯æŒã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Spring MVC&lt;/strong&gt;ï¼šå®ƒé’ˆå¯¹ Web åº”ç”¨ä¸­ MVC æ€æƒ³çš„å®ç°ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Spring DAO&lt;/strong&gt;ï¼šæä¾›å¯¹ JDBC æŠ½è±¡å±‚ï¼Œç®€åŒ–äº† JDBC ç¼–ç ï¼ŒåŒæ—¶ï¼Œç¼–ç æ›´å…·æœ‰å¥å£®æ€§ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Spring ORM&lt;/strong&gt;ï¼šå®ƒæ”¯æŒç”¨äºæµè¡Œçš„ ORM æ¡†æ¶çš„æ•´åˆï¼Œæ¯”å¦‚ï¼šSpring + Hibernateã€Spring + iBatisã€Spring + JDO çš„æ•´åˆç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Spring AOP&lt;/strong&gt;ï¼šå³é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå®ƒæä¾›äº†ä¸ AOP è”ç›Ÿå…¼å®¹çš„ç¼–ç¨‹å®ç°ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;3spring-æœ‰å“ªäº›å¸¸ç”¨æ³¨è§£å‘¢&quot;&gt;3.Spring æœ‰å“ªäº›å¸¸ç”¨æ³¨è§£å‘¢ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;Spring æä¾›äº†å¤§é‡çš„æ³¨è§£æ¥ç®€åŒ– Java åº”ç”¨çš„å¼€å‘å’Œé…ç½®ï¼Œä¸»è¦ç”¨äº Web å¼€å‘ã€å¾€å®¹å™¨æ³¨å…¥ Beanã€AOPã€äº‹åŠ¡æ§åˆ¶ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202505062329372.png&quot; alt=&quot;ä¸‰åˆ†æ¶é¢æ¸£é€†è¢­ï¼šSpringå¸¸ç”¨æ³¨è§£&quot; style=&quot;zoom:67%;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;web-å¼€å‘æ–¹é¢æœ‰å“ªäº›æ³¨è§£å‘¢&quot;&gt;Web å¼€å‘æ–¹é¢æœ‰å“ªäº›æ³¨è§£å‘¢ï¼Ÿ&lt;/h4&gt;

&lt;p&gt;â‘ ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Controller&lt;/code&gt;ï¼šç”¨äºæ ‡æ³¨æ§åˆ¶å±‚ç»„ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;â‘¡ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@RestController&lt;/code&gt;ï¼šæ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Controller&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@ResponseBody&lt;/code&gt; çš„ç»“åˆä½“ï¼Œè¿”å› JSON æ•°æ®æ—¶ä½¿ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;â‘¢ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@RequestMapping&lt;/code&gt;ï¼šç”¨äºæ˜ å°„è¯·æ±‚ URL åˆ°å…·ä½“çš„æ–¹æ³•ä¸Šï¼Œè¿˜å¯ä»¥ç»†åˆ†ä¸ºï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@GetMapping&lt;/code&gt;ï¼šåªèƒ½ç”¨äºå¤„ç† GET è¯·æ±‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@PostMapping&lt;/code&gt;ï¼šåªèƒ½ç”¨äºå¤„ç† POST è¯·æ±‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@DeleteMapping&lt;/code&gt;ï¼šåªèƒ½ç”¨äºå¤„ç† DELETE è¯·æ±‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;â‘£ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@ResponseBody&lt;/code&gt;ï¼šç›´æ¥å°†è¿”å›çš„æ•°æ®æ”¾å…¥ HTTP å“åº”æ­£æ–‡ä¸­ï¼Œä¸€èˆ¬ç”¨äºè¿”å› JSON æ•°æ®ã€‚  &lt;strong&gt;æŠŠå¯¹è±¡è½¬json&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;â‘¤ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@RequestBody&lt;/code&gt;ï¼šè¡¨ç¤ºä¸€ä¸ªæ–¹æ³•å‚æ•°åº”è¯¥ç»‘å®šåˆ° Web è¯·æ±‚ä½“ã€‚&lt;strong&gt;jsonè½¬å¯¹è±¡ï¼Œå‚æ•°ä¸Šã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;â‘¥ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@PathVariable&lt;/code&gt;ï¼šç”¨äºæ¥æ”¶è·¯å¾„å‚æ•°ï¼Œæ¯”å¦‚ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@RequestMapping(â€œ/hello/{name}â€)&lt;/code&gt;ï¼Œè¿™é‡Œçš„ name å°±æ˜¯è·¯å¾„å‚æ•°ã€‚&lt;/p&gt;

&lt;p&gt;â‘¦ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@RequestParam&lt;/code&gt;ï¼šç”¨äºæ¥æ”¶è¯·æ±‚å‚æ•°ã€‚æ¯”å¦‚ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@RequestParam(name = &quot;key&quot;) String key&lt;/code&gt;ï¼Œè¿™é‡Œçš„ key å°±æ˜¯è¯·æ±‚å‚æ•°ã€‚&lt;/p&gt;

&lt;h4 id=&quot;å®¹å™¨ç±»æ³¨è§£æœ‰å“ªäº›å‘¢&quot;&gt;å®¹å™¨ç±»æ³¨è§£æœ‰å“ªäº›å‘¢ï¼Ÿ&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Component&lt;/code&gt;ï¼šæ ‡è¯†ä¸€ä¸ªç±»ä¸º Spring ç»„ä»¶ï¼Œä½¿å…¶èƒ½å¤Ÿè¢« Spring å®¹å™¨è‡ªåŠ¨æ‰«æå’Œç®¡ç†ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Service&lt;/code&gt;ï¼šæ ‡è¯†ä¸€ä¸ªä¸šåŠ¡é€»è¾‘ç»„ä»¶ï¼ˆæœåŠ¡å±‚ï¼‰ã€‚æ¯”å¦‚ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Service(&quot;userService&quot;)&lt;/code&gt;ï¼Œè¿™é‡Œçš„ userService å°±æ˜¯ Bean çš„åç§°ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Repository&lt;/code&gt;ï¼šæ ‡è¯†ä¸€ä¸ªæ•°æ®è®¿é—®ç»„ä»¶ï¼ˆæŒä¹…å±‚ï¼‰ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Autowired&lt;/code&gt;ï¼šæŒ‰ç±»å‹è‡ªåŠ¨æ³¨å…¥ä¾èµ–ã€‚ é…åˆ@Qualifierå¯ä»¥æŒ‰name.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Configuration&lt;/code&gt;ï¼šç”¨äºå®šä¹‰é…ç½®ç±»ï¼Œå¯æ›¿æ¢ XML é…ç½®æ–‡ä»¶ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Value&lt;/code&gt;ï¼šç”¨äºå°† Spring Boot ä¸­ application.properties é…ç½®çš„å±æ€§å€¼èµ‹å€¼ç»™å˜é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;aop-æ–¹é¢æœ‰å“ªäº›æ³¨è§£å‘¢&quot;&gt;AOP æ–¹é¢æœ‰å“ªäº›æ³¨è§£å‘¢ï¼Ÿ&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Aspect&lt;/code&gt; ç”¨äºå£°æ˜ä¸€ä¸ªåˆ‡é¢ï¼Œå¯ä»¥é…åˆå…¶ä»–æ³¨è§£ä¸€èµ·ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@After&lt;/code&gt;ï¼šåœ¨æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Before&lt;/code&gt;ï¼šåœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Around&lt;/code&gt;ï¼šæ–¹æ³•å‰åå‡æ‰§è¡Œã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@PointCut&lt;/code&gt;ï¼šå®šä¹‰åˆ‡ç‚¹ï¼ŒæŒ‡å®šéœ€è¦æ‹¦æˆªçš„æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å½“ä¸€ä¸ªæ–¹æ³•ä¸Šè¢«å¤šä¸ª AOP æ³¨è§£æ‹¦æˆªæ—¶ï¼Œ&lt;strong&gt;é»˜è®¤æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@Aroundï¼ˆå‰ï¼‰
   â””â”€ @Before
       â””â”€ â€”â€”ã€ç›®æ ‡æ–¹æ³•æ‰§è¡Œã€‘â€”â€”
           â””â”€ @After
@Aroundï¼ˆåï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;äº‹åŠ¡æ³¨è§£æœ‰å“ªäº›&quot;&gt;äº‹åŠ¡æ³¨è§£æœ‰å“ªäº›ï¼Ÿ&lt;/h4&gt;

&lt;p&gt;ä¸»è¦å°±æ˜¯ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Transactional&lt;/code&gt;ï¼Œç”¨äºå£°æ˜ä¸€ä¸ªæ–¹æ³•éœ€è¦äº‹åŠ¡æ”¯æŒã€‚&lt;/p&gt;

&lt;h2 id=&quot;springspring-mvcspring-boot-ä¹‹é—´ä»€ä¹ˆå…³ç³»&quot;&gt;Spring,Spring MVC,Spring Boot ä¹‹é—´ä»€ä¹ˆå…³ç³»?&lt;/h2&gt;

&lt;p&gt;å¾ˆå¤šäººå¯¹ Spring,Spring MVC,Spring Boot è¿™ä¸‰è€…å‚»å‚»åˆ†ä¸æ¸…æ¥šï¼è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹è¿™ä¸‰è€…ï¼Œå…¶å®å¾ˆç®€å•ï¼Œæ²¡æœ‰ä»€ä¹ˆé«˜æ·±çš„ä¸œè¥¿ã€‚&lt;/p&gt;

&lt;p&gt;Spring åŒ…å«äº†å¤šä¸ªåŠŸèƒ½æ¨¡å—ï¼ˆä¸Šé¢åˆšåˆšæåˆ°è¿‡ï¼‰ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯ Spring-Coreï¼ˆä¸»è¦æä¾› IoC ä¾èµ–æ³¨å…¥åŠŸèƒ½çš„æ”¯æŒï¼‰ æ¨¡å—ï¼Œ Spring ä¸­çš„å…¶ä»–æ¨¡å—ï¼ˆæ¯”å¦‚ Spring MVCï¼‰çš„åŠŸèƒ½å®ç°åŸºæœ¬éƒ½éœ€è¦ä¾èµ–äºè¯¥æ¨¡å—ã€‚&lt;/p&gt;

&lt;p&gt;Spring MVC æ˜¯ Spring ä¸­çš„ä¸€ä¸ªå¾ˆé‡è¦çš„æ¨¡å—ï¼Œä¸»è¦èµ‹äºˆ Spring å¿«é€Ÿæ„å»º MVC æ¶æ„çš„ Web ç¨‹åºçš„èƒ½åŠ›ã€‚MVC æ˜¯æ¨¡å‹(Model)ã€è§†å›¾(View)ã€æ§åˆ¶å™¨(Controller)çš„ç®€å†™ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å°†ä¸šåŠ¡é€»è¾‘ã€æ•°æ®ã€æ˜¾ç¤ºåˆ†ç¦»æ¥ç»„ç»‡ä»£ç ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ Spring è¿›è¡Œå¼€å‘å„ç§é…ç½®è¿‡äºéº»çƒ¦æ¯”å¦‚å¼€å¯æŸäº› Spring ç‰¹æ€§æ—¶ï¼Œéœ€è¦ç”¨ XML æˆ– Java è¿›è¡Œæ˜¾å¼é…ç½®ã€‚äºæ˜¯ï¼ŒSpring Boot è¯ç”Ÿäº†ï¼&lt;/p&gt;

&lt;p&gt;Spring æ—¨åœ¨ç®€åŒ– J2EE ä¼ä¸šåº”ç”¨ç¨‹åºå¼€å‘ã€‚Spring Boot æ—¨åœ¨ç®€åŒ– Spring å¼€å‘ï¼ˆå‡å°‘é…ç½®æ–‡ä»¶ï¼Œå¼€ç®±å³ç”¨ï¼ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;Spring Boot åªæ˜¯ç®€åŒ–äº†é…ç½®ï¼Œå¦‚æœä½ éœ€è¦æ„å»º MVC æ¶æ„çš„ Web ç¨‹åºï¼Œä½ è¿˜æ˜¯éœ€è¦ä½¿ç”¨ Spring MVC ä½œä¸º MVC æ¡†æ¶ï¼Œåªæ˜¯è¯´ Spring Boot å¸®ä½ ç®€åŒ–äº† Spring MVC çš„å¾ˆå¤šé…ç½®ï¼ŒçœŸæ­£åšåˆ°å¼€ç®±å³ç”¨ï¼&lt;/p&gt;

&lt;h2 id=&quot;spring-æ¡†æ¶ä¸­ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼&quot;&gt;Spring æ¡†æ¶ä¸­ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;å…³äºä¸‹é¢è¿™äº›è®¾è®¡æ¨¡å¼çš„è¯¦ç»†ä»‹ç»ï¼Œå¯ä»¥çœ‹æˆ‘å†™çš„ &lt;a href=&quot;https://javaguide.cn/system-design/framework/spring/spring-design-patterns-summary.html&quot;&gt;Spring ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£&lt;/a&gt; è¿™ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å·¥å‚è®¾è®¡æ¨¡å¼&lt;/strong&gt; : Spring ä½¿ç”¨å·¥å‚æ¨¡å¼é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ApplicationContext&lt;/code&gt; åˆ›å»º bean å¯¹è±¡ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä»£ç†è®¾è®¡æ¨¡å¼&lt;/strong&gt; : Spring AOP åŠŸèƒ½çš„å®ç°ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å•ä¾‹è®¾è®¡æ¨¡å¼&lt;/strong&gt; : Spring ä¸­çš„ Bean é»˜è®¤éƒ½æ˜¯å•ä¾‹çš„ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ¨¡æ¿æ–¹æ³•æ¨¡å¼&lt;/strong&gt; : Spring ä¸­ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jdbcTemplate&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hibernateTemplate&lt;/code&gt; ç­‰ä»¥ Template ç»“å°¾çš„å¯¹æ•°æ®åº“æ“ä½œçš„ç±»ï¼Œå®ƒä»¬å°±ä½¿ç”¨åˆ°äº†æ¨¡æ¿æ¨¡å¼ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åŒ…è£…å™¨è®¾è®¡æ¨¡å¼&lt;/strong&gt; : æˆ‘ä»¬çš„é¡¹ç›®éœ€è¦è¿æ¥å¤šä¸ªæ•°æ®åº“ï¼Œè€Œä¸”ä¸åŒçš„å®¢æˆ·åœ¨æ¯æ¬¡è®¿é—®ä¸­æ ¹æ®éœ€è¦ä¼šå»è®¿é—®ä¸åŒçš„æ•°æ®åº“ã€‚è¿™ç§æ¨¡å¼è®©æˆ‘ä»¬å¯ä»¥æ ¹æ®å®¢æˆ·çš„éœ€æ±‚èƒ½å¤ŸåŠ¨æ€åˆ‡æ¢ä¸åŒçš„æ•°æ®æºã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è§‚å¯Ÿè€…æ¨¡å¼:&lt;/strong&gt; Spring äº‹ä»¶é©±åŠ¨æ¨¡å‹å°±æ˜¯è§‚å¯Ÿè€…æ¨¡å¼å¾ˆç»å…¸çš„ä¸€ä¸ªåº”ç”¨ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;é€‚é…å™¨æ¨¡å¼&lt;/strong&gt; : Spring AOP çš„å¢å¼ºæˆ–é€šçŸ¥(Advice)ä½¿ç”¨åˆ°äº†é€‚é…å™¨æ¨¡å¼ã€spring MVC ä¸­ä¹Ÿæ˜¯ç”¨åˆ°äº†é€‚é…å™¨æ¨¡å¼é€‚é…&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Controller&lt;/code&gt;ã€‚&lt;/li&gt;
  &lt;li&gt;â€¦â€¦&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Fulong Ma</name></author><category term="Spring" /><category term="Spring" /><summary type="html">SpringåŸºç¡€</summary></entry><entry><title type="html">Javaå¹¶å‘åŒ…å’Œçº¿ç¨‹æ± </title><link href="https://mafulong.github.io/2025/05/04/Java%E5%B9%B6%E5%8F%91%E5%8C%85%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%B1%A0/" rel="alternate" type="text/html" title="Javaå¹¶å‘åŒ…å’Œçº¿ç¨‹æ± " /><published>2025-05-04T00:00:00+08:00</published><updated>2025-05-04T00:00:00+08:00</updated><id>https://mafulong.github.io/2025/05/04/Java%E5%B9%B6%E5%8F%91%E5%8C%85%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%B1%A0</id><content type="html" xml:base="https://mafulong.github.io/2025/05/04/Java%E5%B9%B6%E5%8F%91%E5%8C%85%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%B1%A0/">&lt;h2 id=&quot;javaå¹¶å‘åŒ…å’Œçº¿ç¨‹æ± &quot;&gt;Javaå¹¶å‘åŒ…å’Œçº¿ç¨‹æ± &lt;/h2&gt;

&lt;h2 id=&quot;jdk-å¹¶å‘åŒ…-juc&quot;&gt;JDK å¹¶å‘åŒ… JUC&lt;/h2&gt;

&lt;p&gt;java.util.concurrent&lt;/p&gt;

&lt;h3 id=&quot;é‡å…¥é”-reentrantlock&quot;&gt;é‡å…¥é” ReentrantLock&lt;/h3&gt;

&lt;p&gt;å‡ ä¸ªé‡è¦æ–¹æ³•
re-entrance-lock&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//è·å¾—é”ï¼Œå¦‚å ç”¨ï¼Œåˆ™ç­‰å¾…&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lockInteruptibly&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼›&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//è·å¾—é”ï¼Œä½†ä¼˜å…ˆå“åº”ä¸­æ–­ï¼Œå°±æ˜¯å¯ä»¥ä¸­æ–­çš„&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tryLock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼›&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//å¤±è´¥è¿”å›false,ä¸ç­‰å¾…&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tryLock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//åœ¨ç»™å®šæ—¶é—´å†…å°è¯•è·å¾—é”&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;unlock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//é‡Šæ”¾é”&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Lock&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReentrantLock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Condition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;condition&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newCondition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nf&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ä¸ç¬¦åˆæ¡ä»¶&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;signalAll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;unlock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ Java ä¸­ï¼Œé‡å…¥é”ï¼ˆReentrant Lockï¼‰æ˜¯ä¸€ç§æ”¯æŒ&lt;strong&gt;åŒä¸€çº¿ç¨‹é‡å¤è·å–é”è€Œä¸ä¼šè¢«é˜»å¡&lt;/strong&gt;çš„é”æœºåˆ¶ã€‚å®ƒçš„å®ç°å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä¸€ç§æ˜¯åŸºäº JVM çš„å†…ç½®é”ï¼ˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;synchronized&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
  &lt;li&gt;ä¸€ç§æ˜¯åŸºäº JUC åŒ…çš„æ˜¾ç¤ºé”ï¼ˆå¦‚ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantLock&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;synchronized çš„é‡å…¥åŸç†ï¼ˆåŸºäº JVM å®ç°ï¼‰&lt;/strong&gt; &lt;strong&gt;éå…¬å¹³é”&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;synchronized&lt;/code&gt; æ˜¯åŸºäº&lt;strong&gt;å¯¹è±¡å¤´ï¼ˆObject Monitorï¼‰&lt;/strong&gt;çš„ Monitor Lock å®ç°çš„ã€‚&lt;/li&gt;
  &lt;li&gt;æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª Monitorï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹å·²ç»è·å–äº†è¯¥ Monitorï¼Œå†æ¬¡è¿›å…¥æ—¶ä¼š&lt;strong&gt;å¢åŠ ä¸€ä¸ªè®¡æ•°å™¨&lt;/strong&gt;ï¼ˆç§°ä¸ºé‡å…¥è®¡æ•°ï¼‰ã€‚&lt;/li&gt;
  &lt;li&gt;åªæœ‰å½“çº¿ç¨‹å®Œå…¨é€€å‡ºæ‰€æœ‰ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;synchronized&lt;/code&gt; å—åï¼Œæ‰ä¼šçœŸæ­£é‡Šæ”¾è¿™ä¸ªé”ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ğŸ“Œ &lt;strong&gt;JVM ä¸­çš„é‡å…¥æœºåˆ¶ä¾èµ–äº Monitor çš„ Owner å’Œè®¡æ•°å™¨ï¼š&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è®°å½•å½“å‰æŒé”çº¿ç¨‹ï¼ˆOwnerï¼‰ã€‚&lt;/li&gt;
  &lt;li&gt;å¦‚æœå½“å‰çº¿ç¨‹å†æ¬¡è¯·æ±‚é”ï¼Œåªéœ€å°†è®¡æ•°å™¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;+1&lt;/code&gt;ã€‚&lt;/li&gt;
  &lt;li&gt;é€€å‡ºæ—¶é€’å‡è®¡æ•°å™¨ï¼Œç›´åˆ°ä¸º 0 æ—¶é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;ReentrantLock çš„é‡å…¥åŸç†ï¼ˆåŸºäº AQS å®ç°ï¼‰&lt;/strong&gt;  &lt;strong&gt;å…¬å¹³é”&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantLock&lt;/code&gt; æ˜¯åŸºäº &lt;strong&gt;AbstractQueuedSynchronizerï¼ˆAQSï¼‰&lt;/strong&gt; å®ç°çš„ã€‚&lt;/li&gt;
  &lt;li&gt;AQS ä½¿ç”¨ä¸€ä¸ª volatile çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;state&lt;/code&gt; å­—æ®µè®°å½•åŠ é”æ¬¡æ•°ï¼Œæ”¯æŒå¯é‡å…¥ã€‚&lt;/li&gt;
  &lt;li&gt;çº¿ç¨‹ç¬¬ä¸€æ¬¡è·å¾—é”æ—¶ï¼š
    &lt;ul&gt;
      &lt;li&gt;è®¾ç½® state = 1ï¼Œå¹¶è®°å½•å½“å‰çº¿ç¨‹ä¸º ownerã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;å¦‚æœ owner çº¿ç¨‹å†æ¬¡è¯·æ±‚ï¼š
    &lt;ul&gt;
      &lt;li&gt;æ£€æŸ¥çº¿ç¨‹æ˜¯å¦ä¸ºå½“å‰ ownerï¼Œå¦‚æœæ˜¯å°±ç›´æ¥ state++ã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;é‡Šæ”¾é”æ—¶ï¼š
    &lt;ul&gt;
      &lt;li&gt;æ¯é‡Šæ”¾ä¸€æ¬¡ stateâ€“ï¼›&lt;/li&gt;
      &lt;li&gt;å½“ state ä¸º 0 æ—¶æ‰çœŸæ­£é‡Šæ”¾é”å¹¶å”¤é†’ç­‰å¾…çº¿ç¨‹ã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;é‡å…¥é”çš„å¥½æ­æ¡£condition-æ¡ä»¶&quot;&gt;é‡å…¥é”çš„å¥½æ­æ¡£ï¼šCondition æ¡ä»¶&lt;/h3&gt;

&lt;p&gt;condition.await()å’Œ wait()ç±»ä¼¼&lt;/p&gt;

&lt;p&gt;condition.signal()å’Œ notify()ç±»ä¼¼&lt;/p&gt;

&lt;p&gt;è¦åœ¨ lock å—å†…ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;conditionå¯ä»¥æœ‰å¤šä¸ªï¼Œæ¯ä¸ªcondition.awaité˜»å¡åªèƒ½é€šè¿‡è¯¥conditionçš„signal/signalallæ¥å”¤é†’ï¼è¿™æ˜¯synchronizedå…³é”®å­—æ‰€è¾¾ä¸åˆ°çš„&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ³¨æ„å¦‚æœsignalåœ¨awaitä¹‹å‰ï¼Œå¯èƒ½ä¼šé€šçŸ¥ä¸¢å¤±ï¼Œå˜æˆæ­»é”ï¼Œéšæ„æœ€å¥½ç”¨çŠ¶æ€å˜é‡æ¥å¾ªç¯è§£å†³ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Condition&lt;/code&gt; çš„å®ç°åŸºäº &lt;strong&gt;AQS&lt;/strong&gt;ï¼Œä¹Ÿå°±æ˜¯ &lt;strong&gt;AbstractQueuedSynchronizer&lt;/strong&gt;ã€‚å®ƒèƒŒåçš„æ ¸å¿ƒåŸç†æ˜¯é€šè¿‡ &lt;strong&gt;ç­‰å¾…é˜Ÿåˆ—&lt;/strong&gt; å’Œ &lt;strong&gt;é€šçŸ¥æœºåˆ¶&lt;/strong&gt; æ¥åè°ƒçº¿ç¨‹çš„æ‰§è¡Œã€‚ çº¿ç¨‹è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;await()&lt;/code&gt; æ–¹æ³•æ—¶ï¼Œ&lt;strong&gt;å½“å‰çº¿ç¨‹ä¼šè¢«æŒ‚èµ·å¹¶åŠ å…¥åˆ° AQS çš„é˜Ÿåˆ—ä¸­&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;å”¤é†’æ˜¯é€šè¿‡ &lt;strong&gt;è®¾ç½®çº¿ç¨‹çš„çŠ¶æ€&lt;/strong&gt; æ¥å®ç°çš„ã€‚AQS ä¼šé€šè¿‡ &lt;strong&gt;CAS æ“ä½œ&lt;/strong&gt; åŸå­åœ°æ”¹å˜çº¿ç¨‹çš„çŠ¶æ€ï¼Œä¿è¯çº¿ç¨‹å®‰å…¨ã€‚&lt;/p&gt;

&lt;h3 id=&quot;semaphore&quot;&gt;Semaphore&lt;/h3&gt;

&lt;p&gt;ä¿¡å·é‡æœºåˆ¶&lt;/p&gt;

&lt;p&gt;å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//permitsæ˜¯ä¸ªè®¸å¯è¯&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;acquire&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä»¥ä¸‹ä»£ç æ¨¡æ‹Ÿäº†å¯¹æŸä¸ªæœåŠ¡çš„å¹¶å‘è¯·æ±‚ï¼Œæ¯æ¬¡åªèƒ½æœ‰ 3 ä¸ªå®¢æˆ·ç«¯åŒæ—¶è®¿é—®ï¼Œè¯·æ±‚æ€»æ•°ä¸º 10ã€‚&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SemaphoreExample&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clientCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalRequestCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;semaphore&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clientCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ExecutorService&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;executorService&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Executors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newCachedThreadPool&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalRequestCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;executorService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()-&amp;gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;acquire&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;availablePermits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;executorService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shutdown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;resutl:
2 1 2 2 2 2 2 1 2 2&lt;/p&gt;

&lt;p&gt;å¾ªç¯æ‰“å°ABC.&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ABCPrinter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// åˆ›å»ºä¸‰ä¸ªä¿¡å·é‡ï¼Œç”¨äºæ§åˆ¶çº¿ç¨‹çš„æ‰§è¡Œé¡ºåº&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;semaphoreA&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;semaphoreB&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;semaphoreC&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Runnable&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printA&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;semaphoreA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;acquire&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ç­‰å¾…Açš„ä¿¡å·&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;semaphoreB&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// é‡Šæ”¾Bçš„ä¿¡å·&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;ã€‚ã€‚ã€‚&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Semaphore&lt;/code&gt; çš„å®ç°åŸºäº &lt;strong&gt;AQSï¼ˆAbstractQueuedSynchronizerï¼‰&lt;/strong&gt;ï¼Œé€šè¿‡ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨æ¥æ§åˆ¶å¹¶å‘çº¿ç¨‹æ•°ã€‚æ¯å½“çº¿ç¨‹è¯·æ±‚èµ„æºæ—¶ï¼Œè®¡æ•°å™¨å‡å°‘ï¼Œå½“è®¡æ•°å™¨ä¸º 0 æ—¶ï¼Œåç»­çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ã€‚é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;release()&lt;/code&gt; æ–¹æ³•å¯ä»¥é‡Šæ”¾èµ„æºå¹¶å¢åŠ è®¡æ•°å™¨çš„å€¼ï¼Œå”¤é†’ç­‰å¾…çš„çº¿ç¨‹ã€‚&lt;/p&gt;

&lt;h3 id=&quot;reentrantreadwritelock&quot;&gt;ReentrantReadWriteLock&lt;/h3&gt;

&lt;p&gt;è¯»å†™åˆ†ç¦»é”ï¼Œå¯ä»¥å‡å°‘é”ç«äº‰ï¼Œæå‡æ€§èƒ½&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantReadWriteLock&lt;/code&gt; å†…éƒ¨é€šè¿‡ä¸€ä¸ª &lt;strong&gt;state&lt;/strong&gt; å­—æ®µæ¥è¡¨ç¤ºé”çš„çŠ¶æ€ã€‚è¿™ä¸ªçŠ¶æ€ç”± &lt;strong&gt;é«˜ 16 ä½&lt;/strong&gt; å’Œ &lt;strong&gt;ä½ 16 ä½&lt;/strong&gt; ä¸¤éƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é«˜ 16 ä½&lt;/strong&gt;ï¼šè¡¨ç¤ºå†™é”çš„æ•°é‡ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä½ 16 ä½&lt;/strong&gt;ï¼šè¡¨ç¤ºè¯»é”çš„æ•°é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantReadWriteLock&lt;/code&gt; æ˜¯å…¶å¸¸è§çš„å®ç°ï¼Œå®ƒä½¿ç”¨ &lt;strong&gt;AQSï¼ˆAbstractQueuedSynchronizerï¼‰&lt;/strong&gt; æ¥åè°ƒçº¿ç¨‹é—´çš„å¹¶å‘è®¿é—®ã€‚è¯»é”æ˜¯å…±äº«é”ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æŒæœ‰ï¼›å†™é”æ˜¯ç‹¬å é”ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æŒæœ‰å†™é”ï¼Œä¸”åœ¨å†™é”æŒæœ‰æœŸé—´ï¼Œä¸å…è®¸ä»»ä½•çº¿ç¨‹è¯»å–æˆ–å†™å…¥èµ„æºã€‚&lt;/p&gt;

&lt;h4 id=&quot;stampedlock&quot;&gt;StampedLock&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;StampedLock&lt;/code&gt; æ˜¯ Java 8 ä¸­å¼•å…¥çš„ä¸€ä¸ªæ–°å‹é”ï¼Œæä¾›æ¯” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantReadWriteLock&lt;/code&gt; æ›´é«˜æ•ˆçš„å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼Œå°¤å…¶é€‚ç”¨äºéœ€è¦å¤§é‡è¯»æ“ä½œçš„åœºæ™¯ã€‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;StampedLock&lt;/code&gt; ä¹Ÿé€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantLock&lt;/code&gt; çš„æœºåˆ¶æ¥å®ç°ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å†™é”&lt;/strong&gt;ï¼šç‹¬å é”ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ‚²è§‚è¯»é”&lt;/strong&gt;ï¼šç±»ä¼¼äº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantReadWriteLock&lt;/code&gt; çš„è¯»é”ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¹è§‚è¯»é”&lt;/strong&gt;ï¼šå…è®¸åœ¨ä¸æŒæœ‰é”çš„æƒ…å†µä¸‹è¯»å–æ•°æ®ï¼Œåœ¨æäº¤ä¹‹å‰æ£€æŸ¥æ•°æ®æ˜¯å¦è¢«ä¿®æ”¹è¿‡ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;countdownlatch&quot;&gt;CountdownLatch&lt;/h3&gt;

&lt;p&gt;å°±æ˜¯å€’è®¡æ•°çš„é”å­˜æœŸï¼Œå¯ä»¥è®©çº¿ç¨‹ç­‰å¾…ç›´åˆ°å€’è®¡æ—¶ç»“æŸï¼Œå†å¼€å§‹æ‰§è¡Œ&lt;/p&gt;

&lt;p&gt;ç”¨æ¥æ§åˆ¶ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¤šä¸ªçº¿ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ cntï¼Œæ¯æ¬¡è°ƒç”¨ countDown() æ–¹æ³•ä¼šè®©è®¡æ•°å™¨çš„å€¼å‡ 1ï¼Œå‡åˆ° 0 çš„æ—¶å€™ï¼Œé‚£äº›å› ä¸ºè°ƒç”¨ await() æ–¹æ³•è€Œåœ¨ç­‰å¾…çš„çº¿ç¨‹å°±ä¼šè¢«å”¤é†’ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å®ç°åŸç†ï¼š&lt;/strong&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CountDownLatch&lt;/code&gt; çš„åº•å±‚é€šè¿‡ AQS å®ç°ï¼Œä½¿ç”¨ä¸€ä¸ª volatile çš„ state å˜é‡è¡¨ç¤ºå€’è®¡æ—¶ï¼Œçº¿ç¨‹é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;await()&lt;/code&gt; è¿›å…¥ AQS çš„ CLH åŒå‘ç­‰å¾…é˜Ÿåˆ—é˜»å¡ã€‚
 æ¯ä¸ªè°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;countDown()&lt;/code&gt; çš„çº¿ç¨‹åŸå­æ€§åœ°å°† state å‡ä¸€ï¼Œå½“ state å˜ä¸º 0 æ—¶ï¼Œè°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;releaseShared()&lt;/code&gt; å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ã€‚&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CountdownLatchExample&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalThread&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;CountDownLatch&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;countDownLatch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CountDownLatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;totalThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ExecutorService&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;executorService&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Executors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newCachedThreadPool&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;executorService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;run..&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;countDownLatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;countDown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;countDownLatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;end&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;executorService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shutdown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;result:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;run..run..run..run..run..run..run..run..run..run..end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;cyclicbarrier&quot;&gt;CyclicBarrier&lt;/h3&gt;

&lt;p&gt;å…è®¸ä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œç›´åˆ°éƒ½åˆ°è¾¾æŸä¸ªå…¬å…±å±éšœç‚¹&lt;/p&gt;

&lt;p&gt;ç”¨æ¥æ§åˆ¶å¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œåªæœ‰å½“å¤šä¸ªçº¿ç¨‹éƒ½åˆ°è¾¾æ—¶ï¼Œè¿™äº›çº¿ç¨‹æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚&lt;/p&gt;

&lt;p&gt;å’Œ CountdownLatch ç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡ç»´æŠ¤è®¡æ•°å™¨æ¥å®ç°çš„ã€‚ä½†æ˜¯å®ƒçš„è®¡æ•°å™¨æ˜¯é€’å¢çš„ï¼Œæ¯æ¬¡æ‰§è¡Œ await() æ–¹æ³•ä¹‹åï¼Œè®¡æ•°å™¨ä¼šåŠ  1ï¼Œç›´åˆ°è®¡æ•°å™¨çš„å€¼å’Œè®¾ç½®çš„å€¼ç›¸ç­‰ï¼Œç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚å’Œ CountdownLatch çš„å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼ŒCyclicBarrier çš„è®¡æ•°å™¨å¯ä»¥å¾ªç¯ä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒæ‰å«åšå¾ªç¯å±éšœã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªæ˜¯è§„å®šå¤šå°‘ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸€å®šæ•°é‡çš„çº¿ç¨‹éƒ½åˆ°è¾¾ await()æ—¶æ‰å¼€å§‹éƒ½å”¤é†’ï¼Œç»§ç»­æ‰§è¡Œ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å®ç°åŸç†&lt;/strong&gt;ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CyclicBarrier&lt;/code&gt; å†…éƒ¨é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantLock&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Condition&lt;/code&gt; æ§åˆ¶çº¿ç¨‹çš„é˜»å¡ä¸å”¤é†’ï¼Œæ¯æ¬¡æœ‰çº¿ç¨‹è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;await()&lt;/code&gt;ï¼Œéƒ½ä¼šå°† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;count&lt;/code&gt; å‡ 1ï¼Œå½“æœ€åä¸€ä¸ªçº¿ç¨‹åˆ°è¾¾æ—¶æ‰§è¡Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;barrierAction&lt;/code&gt;ï¼ˆå¦‚æœæœ‰ï¼‰ï¼Œç„¶åå”¤é†’æ‰€æœ‰çº¿ç¨‹ï¼›ä¸ºäº†æ”¯æŒå¤šè½®ä½¿ç”¨ï¼Œå®ƒé€šè¿‡ä¸€ä¸ªå« &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;generation&lt;/code&gt; çš„å¯¹è±¡æ ‡è®°æ¯ä¸€è½®å±éšœï¼›å…¶è®¾è®¡ä½“ç°äº†ç»å…¸çš„â€œå±éšœâ€åŒæ­¥æ¨¡å¼ï¼Œéå¸¸é€‚ç”¨äºå¤šçº¿ç¨‹å¹¶å‘é˜¶æ®µä»»åŠ¡ã€‚&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CyclicBarrierExample&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalThread&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;CyclicBarrier&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cyclicBarrier&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CyclicBarrier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;totalThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ExecutorService&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;executorService&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Executors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newCachedThreadPool&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;executorService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;before..&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;cyclicBarrier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;BrokenBarrierException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;after..&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;executorService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shutdown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;result:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;before..before..before..before..before..before..before..before..before..before..after..after..after..after..after..after..after..after..after..after..
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;exchanger&quot;&gt;Exchanger&lt;/h3&gt;

&lt;p&gt;ç”¨äºä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´æ•°æ®çš„åŒæ­¥äº¤æ¢ï¼Œéƒ½å‡†å¤‡å¥½æ‰äº¤æ¢&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exchanger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exchanger&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exchanger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;// Thread 1: Producer&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;producer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Hello from producer!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Producer before exchange: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;exchanger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;exchange&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// äº¤æ¢æ•°æ®&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Producer after exchange: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;interrupt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// Thread 2: Consumer&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;consumer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Hello from consumer!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Consumer before exchange: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;exchanger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;exchange&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// äº¤æ¢æ•°æ®&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Consumer after exchange: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;interrupt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Exchanger&lt;/code&gt; åº•å±‚çš„æ ¸å¿ƒç»“æ„æ˜¯ä¸€ä¸ª &lt;strong&gt;åŒå‘é“¾è¡¨&lt;/strong&gt; æˆ– &lt;strong&gt;èŠ‚ç‚¹ï¼ˆNodeï¼‰&lt;/strong&gt;ã€‚æ¯å½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exchange()&lt;/code&gt; æ–¹æ³•æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹å¹¶å°†è‡ªå·±æ’å…¥é“¾è¡¨ä¸­ï¼Œè¡¨ç¤ºå®ƒæ­£ç­‰å¾…äº¤æ¢æ•°æ®ã€‚å¦ä¸€çº¿ç¨‹è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exchange()&lt;/code&gt; æ—¶ï¼Œä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œç­‰å¾…ä¸ç¬¬ä¸€ä¸ªçº¿ç¨‹äº¤æ¢æ•°æ®ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€æ—¦ä¸¤ä¸ªçº¿ç¨‹éƒ½å‡†å¤‡å¥½äº¤æ¢æ•°æ®ï¼Œå®ƒä»¬ä¼šåœ¨è¿™ä¸ªé“¾è¡¨ä¸­äº¤æ¢å„è‡ªçš„æ•°æ®ã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;transferer&lt;/code&gt;&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Exchanger&lt;/code&gt; å†…éƒ¨ä½¿ç”¨äº† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Transferer&lt;/code&gt; æ¥å£çš„å®ç°ç±»æ¥ç®¡ç†çº¿ç¨‹é—´çš„äº¤æ¢ã€‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Transferer&lt;/code&gt; å®é™…ä¸Šæ˜¯ç”¨æ¥å®ç°æ•°æ®äº¤æ¢çš„æ¥å£ï¼Œå®ƒæœ‰å¤šä¸ªå®ç°ç±»ï¼Œç”¨äºä¸åŒçš„åŒæ­¥éœ€æ±‚ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Item&lt;/code&gt;&lt;/strong&gt;: ç”¨æ¥å­˜æ”¾çº¿ç¨‹äº¤æ¢çš„æ•°æ®çš„å¯¹è±¡ã€‚åœ¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Exchanger&lt;/code&gt; å†…éƒ¨ï¼Œçº¿ç¨‹ä¼šæŒæœ‰ä¸€ä¸ª &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Item&lt;/code&gt;ï¼Œæ¯ä¸ªçº¿ç¨‹ä¼ å…¥çš„æ•°æ®éƒ½ä¼šå­˜å‚¨åœ¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Item&lt;/code&gt; ä¸­ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Node&lt;/code&gt;&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Node&lt;/code&gt; æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨çš„èŠ‚ç‚¹ã€‚æ¯å½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exchange()&lt;/code&gt; æ—¶ï¼Œçº¿ç¨‹å°±ä¼šåœ¨å†…éƒ¨çš„åŒå‘é“¾è¡¨ä¸­åˆ›å»ºä¸€ä¸ª &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Node&lt;/code&gt; æ¥ç­‰å¾…äº¤æ¢ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;é”ä¸æ¡ä»¶å˜é‡&lt;/strong&gt;:
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantLock&lt;/code&gt;ï¼šç”¨äºç¡®ä¿å¯¹å…±äº«èµ„æºçš„äº’æ–¥è®¿é—®ã€‚&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Condition&lt;/code&gt;ï¼šç”¨äºå®ç°çº¿ç¨‹çš„ç­‰å¾…ä¸é€šçŸ¥æœºåˆ¶ã€‚æ¯ä¸ªçº¿ç¨‹åœ¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exchange()&lt;/code&gt; è°ƒç”¨æ—¶éƒ½ä¼šè¢«æ”¾å…¥ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°ä¸å¦ä¸€ä¸ªçº¿ç¨‹äº¤æ¢æ•°æ®ã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒæµç¨‹&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;çº¿ç¨‹è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exchange()&lt;/code&gt; æ–¹æ³•&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å½“çº¿ç¨‹è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exchange()&lt;/code&gt; æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹å¹¶åŠ å…¥åˆ°äº¤æ¢çš„é˜Ÿåˆ—ä¸­ã€‚èŠ‚ç‚¹ä¿å­˜äº†å½“å‰çº¿ç¨‹çš„æ•°æ®ï¼Œå¹¶ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹æ¥äº¤æ¢æ•°æ®ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;çº¿ç¨‹ A è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exchange()&lt;/code&gt;ï¼Œå¹¶å°†å…¶æ•°æ®å­˜å‚¨åœ¨èŠ‚ç‚¹ä¸­ï¼Œç­‰å¾…ä¸çº¿ç¨‹ B äº¤æ¢æ•°æ®ã€‚&lt;/li&gt;
  &lt;li&gt;çº¿ç¨‹ B è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exchange()&lt;/code&gt;ï¼Œå¹¶å°†å…¶æ•°æ®å­˜å‚¨åœ¨èŠ‚ç‚¹ä¸­ï¼Œç­‰å¾…ä¸çº¿ç¨‹ A äº¤æ¢æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;ol&gt;
  &lt;li&gt;çº¿ç¨‹é˜»å¡ä¸ç­‰å¾…&lt;/li&gt;
&lt;/ol&gt;

&lt;ul&gt;
  &lt;li&gt;å½“çº¿ç¨‹ A è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exchange()&lt;/code&gt; åï¼Œå®ƒä¼šè°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lock.lock()&lt;/code&gt; è·å–é”ï¼Œç„¶åæ£€æŸ¥æ˜¯å¦æœ‰å¦ä¸€ä¸ªçº¿ç¨‹å·²ç»åœ¨ç­‰å¾…äº¤æ¢ã€‚&lt;/li&gt;
  &lt;li&gt;å¦‚æœçº¿ç¨‹ B ä¹Ÿå·²ç»åœ¨ç­‰å¾…ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Exchanger&lt;/code&gt; ä¼šäº¤æ¢å®ƒä»¬çš„æ•°æ®ã€‚&lt;/li&gt;
  &lt;li&gt;å¦‚æœçº¿ç¨‹ A æ²¡æœ‰æ‰¾åˆ°çº¿ç¨‹ B æ¥äº¤æ¢æ•°æ®ï¼Œå®ƒä¼šè°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;condition.await()&lt;/code&gt; é˜»å¡è‡ªå·±ï¼Œç›´åˆ°çº¿ç¨‹ B å‡†å¤‡å¥½äº¤æ¢æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;ol&gt;
  &lt;li&gt;çº¿ç¨‹äº¤æ¢æ•°æ®&lt;/li&gt;
&lt;/ol&gt;

&lt;ul&gt;
  &lt;li&gt;ä¸€æ—¦çº¿ç¨‹ A å’Œçº¿ç¨‹ B éƒ½å‡†å¤‡å¥½äº†äº¤æ¢æ•°æ®ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Exchanger&lt;/code&gt; ä¼šå°†å®ƒä»¬å„è‡ªçš„æ•°æ®äº¤æ¢ã€‚çº¿ç¨‹ A ä¼šä»çº¿ç¨‹ B è·å–æ•°æ®ï¼Œè€Œçº¿ç¨‹ B ä¼šä»çº¿ç¨‹ A è·å–æ•°æ®ã€‚&lt;/li&gt;
  &lt;li&gt;äº¤æ¢å®Œæˆåï¼Œçº¿ç¨‹ä¼šè¢«é€šçŸ¥ç»§ç»­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;ol&gt;
  &lt;li&gt;é€šçŸ¥ä¸ç»§ç»­æ‰§è¡Œ&lt;/li&gt;
&lt;/ol&gt;

&lt;ul&gt;
  &lt;li&gt;äº¤æ¢å®Œæˆåï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Exchanger&lt;/code&gt; ä¼šä½¿ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;condition.signalAll()&lt;/code&gt; æ¥é€šçŸ¥æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ï¼Œè®©å®ƒä»¬ç»§ç»­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;Semaphore synchronized CountDownLatch ä¸ä¾èµ–äºé‡å…¥é”ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FutureTask&lt;/code&gt;ï¼šä¸æ˜¯ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantLock&lt;/code&gt;ï¼Œè€Œæ˜¯ AQS å®ç°&lt;/p&gt;

&lt;p&gt;å…¶ä»–JUCåŸºæœ¬ä¾èµ–äºé‡å…¥é”ã€‚&lt;/p&gt;

&lt;h2 id=&quot;å¹¶å‘æ•°æ®ç»“æ„&quot;&gt;å¹¶å‘æ•°æ®ç»“æ„&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ç±»å&lt;/th&gt;
      &lt;th&gt;æ•°æ®ç»“æ„&lt;/th&gt;
      &lt;th&gt;åŒæ­¥æœºåˆ¶&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ConcurrentHashMap&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;æ•°ç»„ + é“¾è¡¨/çº¢é»‘æ ‘ + åˆ†æ®µé”/CAS&lt;/td&gt;
      &lt;td&gt;åˆ†æ®µé”ï¼ˆJDK7ï¼‰ï¼ŒCAS + synchronizedï¼ˆJDK8ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ConcurrentSkipListMap&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;è·³è¡¨ï¼ˆSkipListï¼‰&lt;/td&gt;
      &lt;td&gt;CAS + volatile&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ConcurrentLinkedQueue&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;é“¾è¡¨&lt;/td&gt;
      &lt;td&gt;CASï¼ˆæ— é”ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ConcurrentLinkedDeque&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;åŒå‘é“¾è¡¨&lt;/td&gt;
      &lt;td&gt;CASï¼ˆæ— é”ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LinkedBlockingQueue&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;é“¾è¡¨&lt;/td&gt;
      &lt;td&gt;ReentrantLockï¼ˆput/take ä¸¤æŠŠé”ï¼‰é•¿åº¦ä¸å¯ä¸º0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ArrayBlockingQueue&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;æ•°ç»„ç¯å½¢ç¼“å†²åŒº&lt;/td&gt;
      &lt;td&gt;ReentrantLockï¼ˆput/take ä¸¤æŠŠé”ï¼‰ æ˜¯æœ‰ç•Œçš„ï¼Œåˆå§‹åŒ–éœ€è¦æä¾›æ•°é‡&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PriorityBlockingQueue&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;æœ€å°å †&lt;/td&gt;
      &lt;td&gt;ReentrantLock&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DelayQueue&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;æœ€å°å †ï¼ˆå†…éƒ¨æ˜¯ PriorityQueueï¼‰&lt;/td&gt;
      &lt;td&gt;ReentrantLock&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SynchronousQueue&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;æ— ç¼“å†²/è™šæ‹Ÿé˜Ÿåˆ—&lt;/td&gt;
      &lt;td&gt;CAS + Lockï¼ˆå…¬å¹³æ—¶ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LinkedTransferQueue&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;é“¾è¡¨ + åŒ¹é…èŠ‚ç‚¹&lt;/td&gt;
      &lt;td&gt;CAS + è‡ªæ—‹&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CopyOnWriteArrayList&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;æ•°ç»„&lt;/td&gt;
      &lt;td&gt;å†™æ—¶å¤åˆ¶&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CopyOnWriteArraySet&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;åŸºäº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CopyOnWriteArrayList&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;å†™æ—¶å¤åˆ¶&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;linkedblockingqueue&quot;&gt;LinkedBlockingQueue&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LinkedBlockingQueue&lt;/code&gt; æ˜¯åŸºäº &lt;strong&gt;é“¾è¡¨&lt;/strong&gt; å®ç°çš„ï¼Œå¹¶é€šè¿‡ &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantLock&lt;/code&gt;&lt;/strong&gt; è¿›è¡ŒåŒæ­¥ç®¡ç†ã€‚å®ƒä½¿ç”¨ä¸¤æŠŠé”ï¼šä¸€æŠŠç”¨äºç”Ÿäº§è€…çº¿ç¨‹ï¼ˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put&lt;/code&gt; æ“ä½œï¼‰ï¼Œä¸€æŠŠç”¨äºæ¶ˆè´¹è€…çº¿ç¨‹ï¼ˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ“ä½œï¼‰ã€‚è¿™æ ·è®¾è®¡ä¿è¯äº† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ“ä½œå¯ä»¥å¹¶å‘æ‰§è¡Œï¼Œæé«˜äº†ååé‡ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;head&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tail&lt;/code&gt;ï¼šé“¾è¡¨çš„å¤´éƒ¨å’Œå°¾éƒ¨èŠ‚ç‚¹ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;count&lt;/code&gt;ï¼šé˜Ÿåˆ—ä¸­çš„å½“å‰å…ƒç´ æ•°é‡ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;putLock&lt;/code&gt;ï¼šç”¨äºæ§åˆ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put&lt;/code&gt; æ“ä½œçš„é”ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;takeLock&lt;/code&gt;ï¼šç”¨äºæ§åˆ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ“ä½œçš„é”ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;notFull&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;notEmpty&lt;/code&gt;ï¼šåˆ†åˆ«æ§åˆ¶å½“é˜Ÿåˆ—æ»¡æ—¶ç”Ÿäº§è€…çº¿ç¨‹çš„ç­‰å¾…å’Œå½“é˜Ÿåˆ—ç©ºæ—¶æ¶ˆè´¹è€…çº¿ç¨‹çš„ç­‰å¾…ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReentrantLock&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;putLock&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;putLock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;putLock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;lockInterruptibly&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// å½“é˜Ÿåˆ—æ»¡æ—¶&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;notFull&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// ç­‰å¾…é˜Ÿåˆ—æœ‰ç©ºé—´&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;enqueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;                      &lt;span class=&quot;c1&quot;&gt;// æ’å…¥é˜Ÿåˆ—&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                  &lt;span class=&quot;c1&quot;&gt;// å”¤é†’ç­‰å¾…çš„æ¶ˆè´¹è€…&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;notEmpty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;signal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;putLock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;unlock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;åŒé”æœºåˆ¶ï¼ˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;putLock&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;takeLock&lt;/code&gt;ï¼‰&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;putLock&lt;/code&gt;&lt;/strong&gt;ï¼šæ§åˆ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put&lt;/code&gt; æ“ä½œï¼Œä¿è¯åœ¨æ’å…¥æ—¶ä¸ä¼šä¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ“ä½œå†²çªã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;takeLock&lt;/code&gt;&lt;/strong&gt;ï¼šæ§åˆ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ“ä½œï¼Œä¿è¯åœ¨ç§»é™¤æ—¶ä¸ä¼šä¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put&lt;/code&gt; æ“ä½œå†²çªã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;æ¡ä»¶å˜é‡ï¼ˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;notFull&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;notEmpty&lt;/code&gt;ï¼‰&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;notFull&lt;/code&gt;&lt;/strong&gt;ï¼šå½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šé˜»å¡åœ¨è¯¥æ¡ä»¶å˜é‡ä¸Šï¼Œç›´åˆ°é˜Ÿåˆ—æœ‰ç©ºé—´ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;notEmpty&lt;/code&gt;&lt;/strong&gt;ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šé˜»å¡åœ¨è¯¥æ¡ä»¶å˜é‡ä¸Šï¼Œç›´åˆ°é˜Ÿåˆ—æœ‰å…ƒç´ ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;synchronousqueue&quot;&gt;SynchronousQueue&lt;/h3&gt;

&lt;h4 id=&quot;åº•å±‚æ•°æ®ç»“æ„&quot;&gt;åº•å±‚æ•°æ®ç»“æ„&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SynchronousQueue&lt;/code&gt; çš„åº•å±‚å®ç°å¹¶ä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„åŸºäº &lt;strong&gt;æ•°ç»„&lt;/strong&gt; æˆ– &lt;strong&gt;é“¾è¡¨&lt;/strong&gt; çš„æ•°æ®ç»“æ„ï¼Œè€Œæ˜¯é€šè¿‡ &lt;strong&gt;åŒå‘é“¾è¡¨&lt;/strong&gt; å’Œ &lt;strong&gt;é˜»å¡é˜Ÿåˆ—&lt;/strong&gt; çš„æœºåˆ¶æ¥å®ç°å…ƒç´ çš„äº¤æ¢ã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;èŠ‚ç‚¹ï¼ˆNodeï¼‰&lt;/strong&gt;ï¼š
 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SynchronousQueue&lt;/code&gt; ä¸­ç»´æŠ¤äº†ä¸¤ä¸ªèŠ‚ç‚¹ï¼š&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;ä¸€ä¸ªç”¨äºç­‰å¾…ç”Ÿäº§è€…çº¿ç¨‹ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put&lt;/code&gt; æ•°æ®çš„èŠ‚ç‚¹ã€‚&lt;/li&gt;
      &lt;li&gt;ä¸€ä¸ªç”¨äºç­‰å¾…æ¶ˆè´¹è€…çº¿ç¨‹ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ•°æ®çš„èŠ‚ç‚¹ã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;åŒæ­¥åŒå‘é“¾è¡¨&lt;/strong&gt;ï¼š
 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SynchronousQueue&lt;/code&gt; å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œè¿™ä¸ªé“¾è¡¨åªæœ‰ä¸¤ä¸ªèŠ‚ç‚¹ï¼š&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ç”Ÿäº§è€…çº¿ç¨‹åœ¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put&lt;/code&gt; æ“ä½œæ—¶ç­‰å¾…çš„æ•°æ®ã€‚&lt;/li&gt;
      &lt;li&gt;å¦ä¸€ä¸ªèŠ‚ç‚¹æ˜¯æ¶ˆè´¹è€…çº¿ç¨‹åœ¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ“ä½œæ—¶ç­‰å¾…çš„æ•°æ®ã€‚&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;åŒå‘é“¾è¡¨çš„ä½œç”¨æ˜¯å¸®åŠ©ç®¡ç†ç­‰å¾…çš„çº¿ç¨‹ã€‚ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹çš„äº¤æ¢å°±æ˜¯é€šè¿‡è¿™ä¸¤ä¸ªèŠ‚ç‚¹æ¥å®ç°çš„ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;é”ä¸æ¡ä»¶å˜é‡&lt;/strong&gt;ï¼š
 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SynchronousQueue&lt;/code&gt; ä½¿ç”¨äº† &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantLock&lt;/code&gt;&lt;/strong&gt; å’Œ &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Condition&lt;/code&gt;&lt;/strong&gt; æ¥å®ç°çº¿ç¨‹åŒæ­¥å’Œç­‰å¾…ã€‚ç”Ÿäº§è€…çº¿ç¨‹åœ¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put&lt;/code&gt; æ•°æ®æ—¶ä¼šæŒæœ‰é”å¹¶ç­‰å¾…ï¼Œå¦‚æœæ²¡æœ‰æ¶ˆè´¹è€…çº¿ç¨‹ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ•°æ®ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šé˜»å¡ã€‚æ¶ˆè´¹è€…çº¿ç¨‹åœ¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ•°æ®æ—¶ä¹Ÿä¼šæŒæœ‰é”å¹¶ç­‰å¾…ï¼Œå¦‚æœæ²¡æœ‰ç”Ÿäº§è€…çº¿ç¨‹ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put&lt;/code&gt; æ•°æ®ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šé˜»å¡ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;æ ¸å¿ƒæ–¹æ³•&quot;&gt;æ ¸å¿ƒæ–¹æ³•&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put(E e)&lt;/code&gt;&lt;/strong&gt;ï¼šå½“ç”Ÿäº§è€…è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;put&lt;/code&gt; æ–¹æ³•æ—¶ï¼Œå®ƒä¼šå°è¯•å°†æ•°æ®æ”¾å…¥é˜Ÿåˆ—ã€‚ç”±äº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SynchronousQueue&lt;/code&gt; æ˜¯ä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜Ÿåˆ—ï¼Œç”Ÿäº§è€…çº¿ç¨‹å¿…é¡»ç­‰å¾…æ¶ˆè´¹è€…çº¿ç¨‹è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ¥å–èµ°è¿™ä¸ªæ•°æ®ã€‚å¦‚æœæ¶ˆè´¹è€…çº¿ç¨‹æ²¡æœ‰å–èµ°æ•°æ®ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šè¢«é˜»å¡ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take()&lt;/code&gt;&lt;/strong&gt;ï¼šæ¶ˆè´¹è€…çº¿ç¨‹è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take&lt;/code&gt; æ–¹æ³•æ—¶ï¼Œå®ƒä¼šç­‰å¾…ç”Ÿäº§è€…çº¿ç¨‹å°†æ•°æ®æ”¾å…¥é˜Ÿåˆ—ã€‚å¦‚æœç”Ÿäº§è€…çº¿ç¨‹æ²¡æœ‰æ”¾å…¥æ•°æ®ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šè¢«é˜»å¡ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queue&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;take&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;delayqueue&quot;&gt;DelayQueue&lt;/h3&gt;

&lt;p&gt;DelayQueueä¸€èˆ¬ç”¨äºç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ã€‚&lt;/p&gt;

&lt;p&gt;å®ƒä¸æ˜¯å®šæ—¶ä»»åŠ¡ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take()&lt;/code&gt;&lt;/strong&gt;ï¼šé˜»å¡åœ°è·å–é˜Ÿåˆ—ä¸­çš„å…ƒç´ ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œæˆ–è€…æ‰€æœ‰å…ƒç´ éƒ½å°šæœªåˆ°æœŸï¼Œè°ƒç”¨çº¿ç¨‹ä¼šè¢«é˜»å¡ç›´åˆ°æœ‰å…ƒç´ å¯ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DelayQueue&lt;/code&gt; çš„æ ¸å¿ƒæ˜¯åŸºäº &lt;strong&gt;ä¼˜å…ˆçº§é˜Ÿåˆ—&lt;/strong&gt; æ¥è¿›è¡Œå…ƒç´ æ’åºï¼Œå…·ä½“æ¥è¯´ï¼Œå®ƒæ˜¯é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PriorityBlockingQueue&lt;/code&gt; æ¥å®ç°çš„ã€‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PriorityBlockingQueue&lt;/code&gt; æ˜¯ä¸€ä¸ªæ²¡æœ‰å®¹é‡é™åˆ¶çš„é˜»å¡é˜Ÿåˆ—ï¼Œèƒ½å¤Ÿæ ¹æ®å…ƒç´ çš„å»¶è¿Ÿæ—¶é—´æ¥å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é˜»å¡æœºåˆ¶&lt;/strong&gt;ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;take()&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;poll()&lt;/code&gt; æ–¹æ³•ä¼šæ£€æŸ¥é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´ çš„å»¶è¿Ÿæ—¶é—´ã€‚å¦‚æœå»¶è¿Ÿæ—¶é—´æœªåˆ°ï¼Œè°ƒç”¨çº¿ç¨‹ä¼šè¢«é˜»å¡ç›´åˆ°å»¶è¿Ÿæ—¶é—´åˆ°æœŸã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;çº¿ç¨‹é˜»å¡ä¸å”¤é†’&lt;/strong&gt;ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DelayQueue&lt;/code&gt; ä½¿ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AQS&lt;/code&gt;ï¼ˆAbstractQueuedSynchronizerï¼‰æ¥ç®¡ç†é˜»å¡çº¿ç¨‹ã€‚å½“é˜Ÿåˆ—ä¸­çš„å…ƒç´ åˆ°æœŸæ—¶ï¼Œå®ƒä¼šå”¤é†’ç­‰å¾…çš„çº¿ç¨‹ï¼Œä½¿å¾—è¿™äº›çº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;aqsåŸç†&quot;&gt;AQSåŸç†&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;AQSï¼ˆAbstractQueuedSynchronizerï¼‰çš„åŸç†ã€‚å®ƒæ˜¯ Java å¹¶å‘æ¡†æ¶ä¸­ç”¨äºæ„å»ºé”å’ŒåŒæ­¥å™¨çš„ä¸€ä¸ªæ ¸å¿ƒæ¡†æ¶ç±»ï¼Œæ¯”å¦‚ ReentrantLockã€Semaphoreã€CountDownLatch ç­‰åŒæ­¥å™¨ï¼Œåº•å±‚éƒ½æ˜¯åŸºäº AQS å®ç°çš„ã€‚æ˜¯ Java å¹¶å‘åŒ… &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;java.util.concurrent.locks&lt;/code&gt; ä¸­ç”¨æ¥æ„å»ºé”å’Œå…¶ä»–åŒæ­¥å™¨ï¼ˆå¦‚ä¿¡å·é‡ã€è¯»å†™é”ã€å€’è®¡æ—¶å™¨ç­‰ï¼‰çš„ä¸€ä¸ª&lt;strong&gt;åŸºç¡€æ¡†æ¶ç±»&lt;/strong&gt;ã€‚å®ƒæ˜¯ J.U.C å¹¶å‘æ¡†æ¶ä¸­æœ€æ ¸å¿ƒçš„åº•å±‚ç»„ä»¶ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;AQS é€šè¿‡ä¸€ä¸ª&lt;strong&gt;FIFO é˜Ÿåˆ—&lt;/strong&gt;ï¼ˆå…ˆè¿›å…ˆå‡ºç­‰å¾…é˜Ÿåˆ—ï¼‰æ¥&lt;strong&gt;ç®¡ç†è·å–é”å¤±è´¥çš„çº¿ç¨‹&lt;/strong&gt;ï¼Œå¹¶é€šè¿‡ä¸€ä¸ª&lt;strong&gt;åŸå­å˜é‡ state&lt;/strong&gt; æ¥&lt;strong&gt;è¡¨ç¤ºåŒæ­¥çŠ¶æ€&lt;/strong&gt;ï¼Œä»è€Œå®ç°å„ç§è‡ªå®šä¹‰åŒæ­¥å™¨ã€‚&lt;/p&gt;

&lt;h3 id=&quot;aqs-ä¸-synchronized-æœ‰ä½•ä¸åŒ&quot;&gt;AQS ä¸ synchronized æœ‰ä½•ä¸åŒï¼Ÿ&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ç‰¹æ€§&lt;/th&gt;
      &lt;th&gt;synchronized&lt;/th&gt;
      &lt;th&gt;AQSï¼ˆå¦‚ ReentrantLockï¼‰&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;å¯ä¸­æ–­&lt;/td&gt;
      &lt;td&gt;âŒ ä¸æ”¯æŒ&lt;/td&gt;
      &lt;td&gt;âœ… æ”¯æŒ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;å¯é‡å…¥&lt;/td&gt;
      &lt;td&gt;âœ…&lt;/td&gt;
      &lt;td&gt;âœ…&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;å…¬å¹³æ€§é€‰æ‹©&lt;/td&gt;
      &lt;td&gt;âŒ ä¸å¯é€‰&lt;/td&gt;
      &lt;td&gt;âœ… åªæœ‰æ”¯æŒå…¬å¹³æ¨¡å¼&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;æ¡ä»¶å˜é‡æ”¯æŒ&lt;/td&gt;
      &lt;td&gt;âŒ&lt;/td&gt;
      &lt;td&gt;âœ… Condition æ”¯æŒæ›´å¼ºå¤§&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;æ€§èƒ½æ§åˆ¶&lt;/td&gt;
      &lt;td&gt;âŒï¼ˆé»‘ç›’ï¼‰&lt;/td&gt;
      &lt;td&gt;âœ… æ›´å¯æ§&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;å¦‚æœæƒ³è¦éFIFOï¼Œè¯·ç”¨synchronized, æ¯”å¦‚é‡å…¥é”éå…¬å¹³æ¨¡å¼ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å®ç°&quot;&gt;å®ç°&lt;/h3&gt;

&lt;h4 id=&quot;-1-æ ¸å¿ƒæ€æƒ³çŠ¶æ€--é˜Ÿåˆ—&quot;&gt;ğŸŒŸ 1. æ ¸å¿ƒæ€æƒ³ï¼šçŠ¶æ€ + é˜Ÿåˆ—&lt;/h4&gt;

&lt;p&gt;AQS çš„æ ¸å¿ƒæ˜¯ä¸¤ä¸ªéƒ¨åˆ†ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;state&lt;/strong&gt;ï¼šä¸€ä¸ª &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;volatile int state&lt;/code&gt; è¡¨ç¤ºå½“å‰çš„åŒæ­¥çŠ¶æ€ï¼Œæ¯”å¦‚ 0 è¡¨ç¤ºæœªåŠ é”ï¼Œ1 è¡¨ç¤ºå·²åŠ é”ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç­‰å¾…é˜Ÿåˆ—ï¼ˆCLH é˜Ÿåˆ—ï¼‰&lt;/strong&gt;ï¼šçº¿ç¨‹è·å–é”å¤±è´¥åï¼Œä¼šè¢«å°è£…ä¸ºä¸€ä¸ª &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Node&lt;/code&gt; èŠ‚ç‚¹ï¼ŒåŠ å…¥åˆ°ä¸€ä¸ª &lt;strong&gt;FIFO åŒå‘é˜Ÿåˆ—&lt;/strong&gt; ä¸­ï¼Œå¹¶é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LockSupport.park()&lt;/code&gt; æŒ‚èµ·ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;å­—æ®µå&lt;/th&gt;
      &lt;th&gt;ç±»å‹&lt;/th&gt;
      &lt;th&gt;è¯´æ˜&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;state&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;volatile int&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;åŒæ­¥çŠ¶æ€ï¼ˆ0 ä»£è¡¨æœªå ç”¨ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;head&lt;/code&gt; / &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tail&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Node&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;CLH é˜Ÿåˆ—çš„å¤´å°¾æŒ‡é’ˆ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Node&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;é™æ€å†…éƒ¨ç±»&lt;/td&gt;
      &lt;td&gt;æ¯ä¸ªç­‰å¾…çº¿ç¨‹ä¸€ä¸ª &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Node&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;waitStatus&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;int&lt;/td&gt;
      &lt;td&gt;èŠ‚ç‚¹çŠ¶æ€ï¼ˆSIGNALã€CANCELLED ç­‰ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;thread&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Thread&lt;/td&gt;
      &lt;td&gt;å¯¹åº”çº¿ç¨‹&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next&lt;/code&gt; / &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;prev&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Node&lt;/td&gt;
      &lt;td&gt;æŒ‡å‘å‰åèŠ‚ç‚¹ï¼Œå®ç°åŒå‘é“¾è¡¨&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h4 id=&quot;-2-è·å–é”æµç¨‹ä»¥ç‹¬å ä¸ºä¾‹&quot;&gt;ğŸ” 2. è·å–é”æµç¨‹ï¼ˆä»¥ç‹¬å ä¸ºä¾‹ï¼‰ï¼š&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;çº¿ç¨‹è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;acquire()&lt;/code&gt; å°è¯•åŠ é”ï¼Œåº•å±‚ä¼šè°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tryAcquire()&lt;/code&gt;ã€‚&lt;/li&gt;
  &lt;li&gt;å¦‚æœ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tryAcquire()&lt;/code&gt; å¤±è´¥ï¼Œå°±è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œå¹¶é˜»å¡å½“å‰çº¿ç¨‹ã€‚&lt;/li&gt;
  &lt;li&gt;å‰ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾é”æ—¶è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;release()&lt;/code&gt;ï¼Œåº•å±‚è°ƒç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tryRelease()&lt;/code&gt; æˆåŠŸåå”¤é†’ä¸‹ä¸€ä¸ªçº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;-3-aqs-æä¾›æ¨¡æ¿æ–¹æ³•å­ç±»è´Ÿè´£å®ç°&quot;&gt;ğŸ§± 3. AQS æä¾›æ¨¡æ¿æ–¹æ³•ï¼Œå­ç±»è´Ÿè´£å®ç°ï¼š&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
protected boolean tryAcquire(int arg);
protected boolean tryRelease(int arg);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¼€å‘è€…é€šè¿‡ç»§æ‰¿ AQS å¹¶å®ç°è¿™äº›æ–¹æ³•ï¼Œå¯ä»¥è‡ªå®šä¹‰åŒæ­¥å™¨çš„è¡Œä¸ºã€‚&lt;/p&gt;

&lt;h4 id=&quot;-4-æ”¯æŒä¸¤ç§æ¨¡å¼&quot;&gt;ğŸ“Œ 4. æ”¯æŒä¸¤ç§æ¨¡å¼ï¼š&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ç‹¬å æ¨¡å¼ï¼ˆExclusiveï¼‰&lt;/strong&gt;ï¼šä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è·å–èµ„æºï¼Œå¦‚ ReentrantLockã€‚&lt;strong&gt;tryAcquire&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å…±äº«æ¨¡å¼ï¼ˆSharedï¼‰&lt;/strong&gt;ï¼šå¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«èµ„æºï¼Œå¦‚ Semaphoreã€CountDownLatchã€‚&lt;strong&gt;tryAcquireShared&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;tryAcquire&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;tryAcquireShared&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;â†“&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;è·å–å¤±è´¥&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;â†’&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;addWaiter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;â†’&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;enq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;â†’&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;park&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;â†“&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;å‰é©±é‡Šæ”¾é”&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;â†’&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;unpark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;â†’&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;è‡ªæ—‹é‡è¯•&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;â†’&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;è·å–æˆåŠŸ&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;-5-å®é™…åº”ç”¨ä¸¾ä¾‹&quot;&gt;ğŸ“š 5. å®é™…åº”ç”¨ä¸¾ä¾‹ï¼š&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;ReentrantLockï¼šåŸºäº AQS çš„ç‹¬å æ¨¡å¼ã€‚&lt;/li&gt;
  &lt;li&gt;Semaphoreï¼šåŸºäºå…±äº«æ¨¡å¼æ§åˆ¶å¹¶å‘æ•°é‡ã€‚&lt;/li&gt;
  &lt;li&gt;CountDownLatchï¼šé€šè¿‡å…±äº«è®¡æ•°æ§åˆ¶çº¿ç¨‹ç­‰å¾…ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;å­ç±»&lt;/th&gt;
      &lt;th&gt;æ¨¡å¼&lt;/th&gt;
      &lt;th&gt;å®ç°æ–¹æ³•&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantLock&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;ç‹¬å &lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tryAcquire&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tryRelease&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Semaphore&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;å…±äº«&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tryAcquireShared&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tryReleaseShared&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CountDownLatch&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;å…±äº«&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tryAcquireShared&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tryReleaseShared&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantReadWriteLock.WriteLock&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;ç‹¬å &lt;/td&gt;
      &lt;td&gt;è§å†™é”å®ç°&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReentrantReadWriteLock.ReadLock&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;å…±äº«&lt;/td&gt;
      &lt;td&gt;è§è¯»é”å®ç°&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ReentrantReadWriteLock  è¯»å…±äº«ï¼Œå†™ç‹¬å &lt;/p&gt;

&lt;h3 id=&quot;qa&quot;&gt;QA&lt;/h3&gt;

&lt;p&gt;ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ LockSupport.park() è€Œä¸æ˜¯ wait()ï¼Ÿ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;park/unpark&lt;/code&gt; æ›´çµæ´»ï¼Œçº¿ç¨‹ä¸éœ€è¦å…ˆè·å–é”ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;wait/notify&lt;/code&gt; ä¾èµ–å¯¹è±¡é”ï¼Œå®¹æ˜“äº§ç”Ÿæ­»é”æˆ–å¤æ‚åŒæ­¥ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;CLHï¼ˆCraig, Landin, and Hagerstenï¼‰é˜Ÿåˆ—&lt;/strong&gt; æ˜¯æ ¸å¿ƒçš„æ•°æ®ç»“æ„ä¹‹ä¸€ã€‚å®ƒæ˜¯ä¸€ç§ç”¨äºå®ç° &lt;strong&gt;è‡ªæ—‹é” / é˜»å¡é”çš„å¹¶å‘é˜Ÿåˆ—&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ¯ä¸ªçº¿ç¨‹éƒ½å¯¹åº”ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Node&lt;/code&gt;ï¼‰æŒ‚åˆ°é˜Ÿåˆ—å°¾éƒ¨ã€‚&lt;/li&gt;
  &lt;li&gt;çº¿ç¨‹é€šè¿‡è‡ªæ—‹æˆ–æŒ‚èµ·ç­‰å¾…å…¶å‰é©±èŠ‚ç‚¹çš„çŠ¶æ€å˜åŒ–ã€‚&lt;/li&gt;
  &lt;li&gt;åœ¨ AQS ä¸­ç§°ä¸º &lt;strong&gt;â€œåŒæ­¥é˜Ÿåˆ—â€ï¼ˆsync queueï¼‰&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¼˜ç‚¹&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;FIFO ä¿è¯å…¬å¹³æ€§&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;éé˜»å¡å…¥é˜Ÿï¼ˆCASï¼‰&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è‡ªæ—‹/æŒ‚èµ·ç­‰å¾…å‰é©±é€šçŸ¥&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¯æ‰©å±•æ€§å¼ºï¼Œé€‚åˆé«˜å¹¶å‘åœºæ™¯&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;çº¿ç¨‹æ± &quot;&gt;çº¿ç¨‹æ± &lt;/h2&gt;

&lt;p&gt;åˆç†åˆ©ç”¨çº¿ç¨‹æ± èƒ½å¤Ÿå¸¦æ¥ä¸‰ä¸ªå¥½å¤„ã€‚ç¬¬ä¸€ï¼šé™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚ç¬¬äºŒï¼šæé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦çš„ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚ç¬¬ä¸‰ï¼šæé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚ä½†æ˜¯è¦åšåˆ°åˆç†çš„åˆ©ç”¨çº¿ç¨‹æ± ï¼Œå¿…é¡»å¯¹å…¶åŸç†äº†å¦‚æŒ‡æŒã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Executors.newFixedThreadPool(int nThreads)&lt;/code&gt;ï¼šåˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Executors.newCachedThreadPool()&lt;/code&gt;ï¼šåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çš„çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± çš„å¤§å°å¯æ ¹æ®éœ€æ±‚åŠ¨æ€è°ƒæ•´ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Executors.newSingleThreadExecutor()&lt;/code&gt;ï¼šåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œæ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æäº¤é¡ºåºæ‰§è¡Œã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Executors.newScheduledThreadPool(int corePoolSize)&lt;/code&gt;ï¼šåˆ›å»ºä¸€ä¸ªå®šæ—¶ä»»åŠ¡çº¿ç¨‹æ± ï¼Œæ”¯æŒå®šæ—¶ä»»åŠ¡æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        &lt;span class=&quot;c1&quot;&gt;// åˆ›å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ï¼Œå¤§å°ä¸º 3&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ExecutorService&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;threadPool&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Executors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newFixedThreadPool&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// æäº¤ 6 ä¸ªä»»åŠ¡&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;threadPool&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;submit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Task &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)));&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// å…³é—­çº¿ç¨‹æ± &lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;threadPool&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;shutdown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;çº¿ç¨‹æ± ä»»åŠ¡åˆ›å»ºä¸æäº¤&quot;&gt;çº¿ç¨‹æ± ä»»åŠ¡åˆ›å»ºä¸æäº¤&lt;/h3&gt;

&lt;p&gt;ä»»åŠ¡åˆ†ä¸ºä¸¤ç§:ä¸€ç§æ˜¯æœ‰è¿”å›å€¼çš„ï¼ˆ callable ï¼‰ï¼Œä¸€ç§æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼ˆ runnable ï¼‰. Callable ä¸ Future ä¸¤åŠŸèƒ½æ˜¯ Java åœ¨åç»­ç‰ˆæœ¬ä¸­ä¸ºäº†é€‚åº”å¤šå¹¶æ³•æ‰åŠ å…¥çš„ï¼ŒCallable æ˜¯ç±»ä¼¼äº Runnable çš„æ¥å£ï¼Œå®ç° Callable æ¥å£çš„ç±»å’Œå®ç° Runnable çš„ç±»éƒ½æ˜¯å¯è¢«å…¶ä»–çº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡ã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æ— è¿”å›å€¼çš„ä»»åŠ¡å°±æ˜¯ä¸€ä¸ªå®ç°äº† runnable æ¥å£çš„ç±».ä½¿ç”¨ run æ–¹æ³•.&lt;/li&gt;
  &lt;li&gt;æœ‰è¿”å›å€¼çš„ä»»åŠ¡æ˜¯ä¸€ä¸ªå®ç°äº† callable æ¥å£çš„ç±».ä½¿ç”¨ call æ–¹æ³•.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Callable å’Œ Runnable çš„åŒºåˆ«å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Callable å®šä¹‰çš„æ–¹æ³•æ˜¯ callï¼Œè€Œ Runnable å®šä¹‰çš„æ–¹æ³•æ˜¯ runã€‚&lt;/li&gt;
  &lt;li&gt;Callable çš„ call æ–¹æ³•å¯ä»¥æœ‰è¿”å›å€¼ï¼Œè€Œ Runnable çš„ run æ–¹æ³•ä¸èƒ½æœ‰è¿”å›å€¼ã€‚&lt;/li&gt;
  &lt;li&gt;Callable çš„ call æ–¹æ³•å¯æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œ Runnable çš„ run æ–¹æ³•ä¸èƒ½æŠ›å‡ºå¼‚å¸¸ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;execute ä¸ submit åŒºåˆ«ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æ¥æ”¶çš„å‚æ•°ä¸ä¸€æ ·&lt;/li&gt;
  &lt;li&gt;submit æœ‰è¿”å›å€¼ï¼Œè€Œ execute æ²¡æœ‰&lt;/li&gt;
  &lt;li&gt;submit æ–¹ä¾¿ Exception å¤„ç†&lt;/li&gt;
  &lt;li&gt;execute æ˜¯ Executor æ¥å£ä¸­å”¯ä¸€å®šä¹‰çš„æ–¹æ³•ï¼›submit æ˜¯ ExecutorServiceï¼ˆè¯¥æ¥å£ç»§æ‰¿ Executorï¼‰ä¸­å®šä¹‰çš„æ–¹æ³•&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;çº¿ç¨‹æ± çš„å…³é—­&quot;&gt;çº¿ç¨‹æ± çš„å…³é—­&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨çº¿ç¨‹æ± çš„ shutdown æˆ– shutdownNow æ–¹æ³•æ¥å…³é—­çº¿ç¨‹æ± ï¼Œä½†æ˜¯å®ƒä»¬çš„å®ç°åŸç†ä¸åŒï¼Œshutdown çš„åŸç†æ˜¯åªæ˜¯å°†çº¿ç¨‹æ± çš„çŠ¶æ€è®¾ç½®æˆ SHUTDOWN çŠ¶æ€ï¼Œç„¶åä¸­æ–­æ‰€æœ‰æ²¡æœ‰æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ã€‚shutdownNow çš„åŸç†æ˜¯éå†çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹ï¼Œç„¶åé€ä¸ªè°ƒç”¨çº¿ç¨‹çš„ &lt;strong&gt;interrupt&lt;/strong&gt; æ–¹æ³•æ¥ä¸­æ–­çº¿ç¨‹ï¼Œæ‰€ä»¥æ— æ³•å“åº”ä¸­æ–­çš„ä»»åŠ¡å¯èƒ½æ°¸è¿œæ— æ³•ç»ˆæ­¢ã€‚shutdownNow ä¼šé¦–å…ˆå°†çº¿ç¨‹æ± çš„çŠ¶æ€è®¾ç½®æˆ STOPï¼Œç„¶åå°è¯•åœæ­¢æ‰€æœ‰çš„æ­£åœ¨æ‰§è¡Œæˆ–æš‚åœä»»åŠ¡çš„çº¿ç¨‹ï¼Œå¹¶è¿”å›ç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„åˆ—è¡¨ã€‚&lt;/p&gt;

&lt;p&gt;åªè¦è°ƒç”¨äº†è¿™ä¸¤ä¸ªå…³é—­æ–¹æ³•çš„å…¶ä¸­ä¸€ä¸ªï¼Œ&lt;strong&gt;isShutdown&lt;/strong&gt; æ–¹æ³•å°±ä¼šè¿”å› trueã€‚å½“æ‰€æœ‰çš„ä»»åŠ¡éƒ½å·²å…³é—­å,æ‰è¡¨ç¤ºçº¿ç¨‹æ± å…³é—­æˆåŠŸï¼Œè¿™æ—¶è°ƒç”¨ isTerminaed æ–¹æ³•ä¼šè¿”å› trueã€‚è‡³äºæˆ‘ä»¬åº”è¯¥è°ƒç”¨å“ªä¸€ç§æ–¹æ³•æ¥å…³é—­çº¿ç¨‹æ± ï¼Œåº”è¯¥ç”±æäº¤åˆ°çº¿ç¨‹æ± çš„ä»»åŠ¡ç‰¹æ€§å†³å®šï¼Œé€šå¸¸è°ƒç”¨ shutdown æ¥å…³é—­çº¿ç¨‹æ± ï¼Œå¦‚æœä»»åŠ¡ä¸ä¸€å®šè¦æ‰§è¡Œå®Œï¼Œåˆ™å¯ä»¥è°ƒç”¨ shutdownNowã€‚&lt;/p&gt;

&lt;h3 id=&quot;çº¿ç¨‹æ± çš„åˆ†æ&quot;&gt;çº¿ç¨‹æ± çš„åˆ†æ&lt;/h3&gt;

&lt;p&gt;åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± éœ€è¦è¾“å…¥å‡ ä¸ªå‚æ•°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;corePoolSize&lt;/strong&gt;ï¼ˆçº¿ç¨‹æ± çš„åŸºæœ¬å¤§å°ï¼‰ï¼šå½“æäº¤ä¸€ä¸ªä»»åŠ¡åˆ°çº¿ç¨‹æ± æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå³ä½¿å…¶ä»–ç©ºé—²çš„åŸºæœ¬çº¿ç¨‹èƒ½å¤Ÿæ‰§è¡Œæ–°ä»»åŠ¡ä¹Ÿä¼šåˆ›å»ºçº¿ç¨‹ï¼Œç­‰åˆ°éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æ•°å¤§äºçº¿ç¨‹æ± åŸºæœ¬å¤§å°æ—¶å°±ä¸å†åˆ›å»ºã€‚å¦‚æœè°ƒç”¨äº†çº¿ç¨‹æ± çš„ prestartAllCoreThreads æ–¹æ³•ï¼Œçº¿ç¨‹æ± ä¼šæå‰åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰åŸºæœ¬çº¿ç¨‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨åˆ›å»ºäº†çº¿ç¨‹æ± åï¼Œçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ä¸º 0ï¼Œå½“æœ‰ä»»åŠ¡æ¥ä¹‹åï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œå½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®è¾¾åˆ° corePoolSize åï¼Œå°±ä¼šæŠŠåˆ°è¾¾çš„ä»»åŠ¡æ”¾åˆ°ç¼“å­˜é˜Ÿåˆ—å½“ä¸­ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;runnableTaskQueue&lt;/strong&gt;ï¼ˆä»»åŠ¡é˜Ÿåˆ—ï¼‰ï¼šç”¨äºä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ã€‚å¯ä»¥é€‰æ‹©ä»¥ä¸‹å‡ ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;ol&gt;
  &lt;li&gt;ArrayBlockingQueueï¼šæ˜¯ä¸€ä¸ªåŸºäºæ•°ç»„ç»“æ„çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œæ­¤é˜Ÿåˆ—æŒ‰ FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰åŸåˆ™å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚&lt;/li&gt;
  &lt;li&gt;LinkedBlockingQueueï¼šä¸€ä¸ªåŸºäºé“¾è¡¨ç»“æ„çš„é˜»å¡é˜Ÿåˆ—ï¼Œæ­¤é˜Ÿåˆ—æŒ‰ FIFO ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ æ’åºå…ƒç´ ï¼Œååé‡é€šå¸¸è¦é«˜äº ArrayBlockingQueueã€‚é™æ€å·¥å‚æ–¹æ³• Executors.newFixedThreadPool()ä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚&lt;/li&gt;
  &lt;li&gt;SynchronousQueueï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚æ¯ä¸ªæ’å…¥æ“ä½œå¿…é¡»ç­‰åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ç§»é™¤æ“ä½œï¼Œå¦åˆ™æ’å…¥æ“ä½œä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ï¼Œååé‡é€šå¸¸è¦é«˜äº LinkedBlockingQueueï¼Œé™æ€å·¥å‚æ–¹æ³• Executors.newCachedThreadPool ä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚&lt;/li&gt;
  &lt;li&gt;PriorityBlockingQueueï¼šä¸€ä¸ªå…·æœ‰ä¼˜å…ˆçº§å¾—æ— é™é˜»å¡é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;ul&gt;
  &lt;li&gt;maximumPoolSizeï¼ˆçº¿ç¨‹æ± æœ€å¤§å¤§å°ï¼‰ï¼šçº¿ç¨‹æ± å…è®¸åˆ›å»ºçš„æœ€å¤§çº¿ç¨‹æ•°ã€‚å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œå¹¶ä¸”å·²åˆ›å»ºçš„çº¿ç¨‹æ•°å°äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œåˆ™çº¿ç¨‹æ± ä¼šå†åˆ›å»ºæ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯å¦‚æœä½¿ç”¨äº†æ— ç•Œçš„ä»»åŠ¡é˜Ÿåˆ—è¿™ä¸ªå‚æ•°å°±æ²¡ä»€ä¹ˆæ•ˆæœã€‚ä¹Ÿå°±æ˜¯è¯´ corePoolSize å°±æ˜¯çº¿ç¨‹æ± å¤§å°ï¼ŒmaximumPoolSize åœ¨æˆ‘çœ‹æ¥æ˜¯çº¿ç¨‹æ± çš„ä¸€ç§è¡¥æ•‘æªæ–½ï¼Œå³ä»»åŠ¡é‡çªç„¶è¿‡å¤§æ—¶çš„ä¸€ç§è¡¥æ•‘æªæ–½ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ThreadFactory&lt;/strong&gt;ï¼šç”¨äºè®¾ç½®åˆ›å»ºçº¿ç¨‹çš„å·¥å‚ï¼Œå¯ä»¥é€šè¿‡çº¿ç¨‹å·¥å‚ç»™æ¯ä¸ªåˆ›å»ºå‡ºæ¥çš„çº¿ç¨‹è®¾ç½®æ›´æœ‰æ„ä¹‰çš„åå­—ï¼ŒDebug å’Œå®šä½é—®é¢˜æ—¶éå¸¸åˆå¸®åŠ©ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;RejectedExecutionHandler&lt;/strong&gt;ï¼ˆé¥±å’Œç­–ç•¥ï¼‰ï¼šå½“é˜Ÿåˆ—å’Œçº¿ç¨‹æ± éƒ½æ»¡äº†ï¼Œè¯´æ˜çº¿ç¨‹æ± å¤„äºé¥±å’ŒçŠ¶æ€ï¼Œé‚£ä¹ˆå¿…é¡»é‡‡å–ä¸€ç§ç­–ç•¥å¤„ç†æäº¤çš„æ–°ä»»åŠ¡ã€‚è¿™ä¸ªç­–ç•¥é»˜è®¤æƒ…å†µä¸‹æ˜¯ AbortPolicyï¼Œè¡¨ç¤ºæ— æ³•å¤„ç†æ–°ä»»åŠ¡æ—¶æŠ›å‡ºå¼‚å¸¸ã€‚ä»¥ä¸‹æ˜¯ JDK1.5 æä¾›çš„å››ç§ç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;ol&gt;
  &lt;li&gt;AbortPolicyï¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸&lt;/li&gt;
  &lt;li&gt;CallerRunsPolicyï¼šåªç”¨è°ƒç”¨è€…æ‰€åœ¨çº¿ç¨‹æ¥è¿è¡Œä»»åŠ¡ã€‚&lt;/li&gt;
  &lt;li&gt;DiscardOldestPolicyï¼šä¸¢å¼ƒé˜Ÿåˆ—é‡Œæœ€è¿‘çš„ä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡ã€‚&lt;/li&gt;
  &lt;li&gt;DiscardPolicyï¼šä¸å¤„ç†ï¼Œä¸¢å¼ƒæ‰ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å½“ç„¶ä¹Ÿå¯ä»¥æ ¹æ®åº”ç”¨åœºæ™¯éœ€è¦æ¥å®ç° RejectedExecutionHandler æ¥å£è‡ªå®šä¹‰ç­–ç•¥ã€‚å¦‚è®°å½•æ—¥å¿—æˆ–æŒä¹…åŒ–ä¸èƒ½å¤„ç†çš„ä»»åŠ¡ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;keepAliveTimeï¼ˆçº¿ç¨‹æ´»åŠ¨ä¿æŒæ—¶é—´ï¼‰ï¼šçº¿ç¨‹æ± çš„å·¥ä½œçº¿ç¨‹ç©ºé—²åï¼Œä¿æŒå­˜æ´»çš„æ—¶é—´ã€‚æ‰€ä»¥å¦‚æœä»»åŠ¡å¾ˆå¤šï¼Œå¹¶ä¸”æ¯ä¸ªä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´æ¯”è¾ƒçŸ­ï¼Œå¯ä»¥è°ƒå¤§è¿™ä¸ªæ—¶é—´ï¼Œæé«˜çº¿ç¨‹çš„åˆ©ç”¨ç‡ã€‚&lt;/li&gt;
  &lt;li&gt;TimeUnitï¼ˆçº¿ç¨‹æ´»åŠ¨ä¿æŒæ—¶é—´çš„å•ä½ï¼‰ï¼šå¯é€‰çš„å•ä½æœ‰å¤©ï¼ˆDAYSï¼‰ï¼Œå°æ—¶ï¼ˆHOURSï¼‰ï¼Œåˆ†é’Ÿï¼ˆMINUTESï¼‰ï¼Œæ¯«ç§’(MILLISECONDS)ï¼Œå¾®ç§’(MICROSECONDS, åƒåˆ†ä¹‹ä¸€æ¯«ç§’)å’Œæ¯«å¾®ç§’(NANOSECONDS, åƒåˆ†ä¹‹ä¸€å¾®ç§’)ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv6/v6/202505041121762.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå½“æäº¤ä¸€ä¸ªæ–°ä»»åŠ¡åˆ°çº¿ç¨‹æ± æ—¶ï¼Œçº¿ç¨‹æ± çš„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®å°äº corePoolSizeï¼Œåˆ™æ¯æ¥ä¸€ä¸ªä»»åŠ¡ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼›&lt;/li&gt;
  &lt;li&gt;å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®&amp;gt;=corePoolSizeï¼Œåˆ™æ¯æ¥ä¸€ä¸ªä»»åŠ¡ï¼Œä¼šå°è¯•å°†å…¶æ·»åŠ åˆ°ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—å½“ä¸­ï¼Œè‹¥æ·»åŠ æˆåŠŸï¼Œåˆ™è¯¥ä»»åŠ¡ä¼šç­‰å¾…ç©ºé—²çº¿ç¨‹å°†å…¶å–å‡ºå»æ‰§è¡Œï¼›è‹¥æ·»åŠ å¤±è´¥ï¼ˆä¸€èˆ¬æ¥è¯´æ˜¯ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—å·²æ»¡ï¼‰ï¼Œåˆ™ä¼šå°è¯•åˆ›å»ºæ–°çš„çº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼›&lt;/li&gt;
  &lt;li&gt;å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®è¾¾åˆ° maximumPoolSizeï¼Œåˆ™ä¼šé‡‡å–ä»»åŠ¡æ‹’ç»ç­–ç•¥è¿›è¡Œå¤„ç†ï¼›&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äº corePoolSize æ—¶ï¼Œå¦‚æœæŸçº¿ç¨‹ç©ºé—²æ—¶é—´è¶…è¿‡ keepAliveTimeï¼Œçº¿ç¨‹å°†è¢«ç»ˆæ­¢ï¼Œç›´è‡³çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®ä¸å¤§äº corePoolSizeï¼›å¦‚æœå…è®¸ä¸ºæ ¸å¿ƒæ± ä¸­çš„çº¿ç¨‹è®¾ç½®å­˜æ´»æ—¶é—´ï¼Œé‚£ä¹ˆæ ¸å¿ƒæ± ä¸­çš„çº¿ç¨‹ç©ºé—²æ—¶é—´è¶…è¿‡ keepAliveTimeï¼Œçº¿ç¨‹ä¹Ÿä¼šè¢«ç»ˆæ­¢&lt;/p&gt;

&lt;p&gt;ä»å®ƒä»¬çš„å…·ä½“å®ç°æ¥çœ‹ï¼Œå®ƒä»¬å®é™…ä¸Šä¹Ÿæ˜¯è°ƒç”¨äº† ThreadPoolExecutorï¼Œåªä¸è¿‡å‚æ•°éƒ½å·²é…ç½®å¥½äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;newFixedThreadPool&lt;/strong&gt; åˆ›å»ºçš„çº¿ç¨‹æ±  corePoolSize å’Œ maximumPoolSize å€¼æ˜¯ç›¸ç­‰çš„ï¼Œå®ƒä½¿ç”¨çš„ LinkedBlockingQueueï¼›&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;newSingleThreadExecutor&lt;/strong&gt; å°† corePoolSize å’Œ maximumPoolSize éƒ½è®¾ç½®ä¸º 1ï¼Œä¹Ÿä½¿ç”¨çš„ LinkedBlockingQueueï¼›&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;newCachedThreadPool&lt;/strong&gt; å°† corePoolSize è®¾ç½®ä¸º 0ï¼Œå°† maximumPoolSize è®¾ç½®ä¸º Integer.MAX_VALUEï¼Œä½¿ç”¨çš„ SynchronousQueueï¼Œä¹Ÿå°±æ˜¯è¯´æ¥äº†ä»»åŠ¡å°±åˆ›å»ºçº¿ç¨‹è¿è¡Œï¼Œå½“çº¿ç¨‹ç©ºé—²è¶…è¿‡ 60 ç§’ï¼Œå°±é”€æ¯çº¿ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;å®é™…ä¸­ï¼Œå¦‚æœ Executors æä¾›çš„ä¸‰ä¸ªé™æ€æ–¹æ³•èƒ½æ»¡è¶³è¦æ±‚ï¼Œå°±å°½é‡ä½¿ç”¨å®ƒæä¾›çš„ä¸‰ä¸ªæ–¹æ³•ï¼Œå› ä¸ºè‡ªå·±å»æ‰‹åŠ¨é…ç½® ThreadPoolExecutor çš„å‚æ•°æœ‰ç‚¹éº»çƒ¦ï¼Œè¦æ ¹æ®å®é™…ä»»åŠ¡çš„ç±»å‹å’Œæ•°é‡æ¥è¿›è¡Œé…ç½®ã€‚å¦å¤–ï¼Œå¦‚æœ ThreadPoolExecutor è¾¾ä¸åˆ°è¦æ±‚ï¼Œå¯ä»¥è‡ªå·±ç»§æ‰¿ ThreadPoolExecutor ç±»è¿›è¡Œé‡å†™ã€‚&lt;/p&gt;</content><author><name>Fulong Ma</name></author><category term="Java" /><category term="Java" /><summary type="html">Javaå¹¶å‘åŒ…å’Œçº¿ç¨‹æ± </summary></entry><entry><title type="html">javaå¤šçº¿ç¨‹åº”ç”¨é—®é¢˜</title><link href="https://mafulong.github.io/2025/05/04/java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%A2%98%E7%9B%AE/" rel="alternate" type="text/html" title="javaå¤šçº¿ç¨‹åº”ç”¨é—®é¢˜" /><published>2025-05-04T00:00:00+08:00</published><updated>2025-05-04T00:00:00+08:00</updated><id>https://mafulong.github.io/2025/05/04/java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%A2%98%E7%9B%AE</id><content type="html" xml:base="https://mafulong.github.io/2025/05/04/java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%A2%98%E7%9B%AE/">&lt;h1 id=&quot;å¾ªç¯æ‰“å°abcé—®é¢˜&quot;&gt;å¾ªç¯æ‰“å°ABCé—®é¢˜&lt;/h1&gt;
&lt;p&gt;é¢˜ç›®:æœ‰ä¸‰ä¸ªçº¿ç¨‹åˆ†åˆ«æ‰“å°Aã€Bã€Cï¼Œè¯·ç”¨å¤šçº¿ç¨‹ç¼–ç¨‹å®ç°ï¼Œåœ¨å±å¹•æ‰“å°10æ¬¡ABC&lt;/p&gt;

&lt;p&gt;æ•´ä½“æ€è·¯ï¼šè¯¥é—®é¢˜ä¸ºä¸‰ä¸ªçº¿ç¨‹çš„åŒæ­¥å”¤é†’æœºåˆ¶å³ThreadA-&amp;gt;ThreadB-&amp;gt;ThreadC-&amp;gt;ThreadAå¾ªç¯æ‰§è¡Œä¸‰ä¸ªçº¿ç¨‹ã€‚&lt;/p&gt;

&lt;h2 id=&quot;synchronizedwaitnotify&quot;&gt;&lt;strong&gt;synchronized+wait/notify&lt;/strong&gt;&lt;/h2&gt;

&lt;p&gt;åŸºæœ¬æ€è·¯å°±æ˜¯çº¿ç¨‹Aã€çº¿ç¨‹Bã€çº¿ç¨‹Cä¸‰ä¸ªçº¿ç¨‹åŒæ—¶å¯åŠ¨ï¼Œå› ä¸ºå˜é‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;num&lt;/code&gt;çš„åˆå§‹å€¼ä¸º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0&lt;/code&gt;ï¼Œæ‰€ä»¥çº¿ç¨‹Bæˆ–çº¿ç¨‹Cæ‹¿åˆ°é”åï¼Œè¿›å…¥&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;while()&lt;/code&gt;å¾ªç¯ï¼Œç„¶åæ‰§è¡Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;wait()&lt;/code&gt;æ–¹æ³•ï¼Œçº¿ç¨‹çº¿ç¨‹é˜»å¡ï¼Œé‡Šæ”¾é”ã€‚åªæœ‰çº¿ç¨‹Aæ‹¿åˆ°é”åï¼Œä¸è¿›å…¥&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;while()&lt;/code&gt;å¾ªç¯ï¼Œæ‰§è¡Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;num++&lt;/code&gt;ï¼Œæ‰“å°å­—ç¬¦&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A&lt;/code&gt;ï¼Œæœ€åå”¤é†’çº¿ç¨‹Bå’Œçº¿ç¨‹Cã€‚æ­¤æ—¶&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;num&lt;/code&gt;å€¼ä¸º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1&lt;/code&gt;ï¼Œåªæœ‰çº¿ç¨‹Bæ‹¿åˆ°é”åï¼Œä¸è¢«é˜»å¡ï¼Œæ‰§è¡Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;num++&lt;/code&gt;ï¼Œæ‰“å°å­—ç¬¦&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;B&lt;/code&gt;ï¼Œæœ€åå”¤é†’çº¿ç¨‹Aå’Œçº¿ç¨‹Cï¼Œåé¢ä»¥æ­¤ç±»æ¨ã€‚&lt;/p&gt;

&lt;p&gt;wait,notifyéƒ½ç±»ä¼¼condition,ä¸ç¬¦åˆå°±ä¸€ç›´wait,ç„¶åè¦notifyAllï¼Œå› ä¸ºå¯èƒ½å¤šä¸ªç­‰ï¼Œä¸€ä¸ªçº¿ç¨‹å¯èƒ½æŒç»­ç­‰å¤šæ¬¡ï¼Œç„¶åæ²¡notifyã€‚&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Wait_Notify_ACB&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LOCK&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetNum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nf&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LOCK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetNum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;nv&quot;&gt;LOCK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;nv&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++;&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;LOCK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;notifyAll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Wait_Notify_ACB&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wait_notify_acb&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Wait_Notify_ACB&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;wait_notify_acb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;wait_notify_acb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;wait_notify_acb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;semaphore&quot;&gt;Semaphore&lt;/h2&gt;

&lt;p&gt;ä¿¡å·é‡ï¼Œç±»ä¼¼golangçš„channelæ¥å®ç°ã€‚0é•¿åº¦çš„é˜»å¡é˜Ÿåˆ—&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SemaphoreABC&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//å› ä¸ºå…ˆæ‰§è¡Œçº¿ç¨‹Aï¼Œæ‰€ä»¥è¿™é‡Œè®¾s1çš„è®¡æ•°å™¨ä¸º1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;


    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Semaphore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nextThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;acquire&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;//é˜»å¡å½“å‰çº¿ç¨‹ï¼Œå³ä¿¡å·é‡çš„è®¡æ•°å™¨å‡1ä¸º0&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;nextThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;          &lt;span class=&quot;c1&quot;&gt;//å”¤é†’ä¸‹ä¸€ä¸ªçº¿ç¨‹ï¼Œå³ä¿¡å·é‡çš„è®¡æ•°å™¨åŠ 1&lt;/span&gt;

            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;SemaphoreABC&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SemaphoreABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;printer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;printer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;printer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reentrantlock&quot;&gt;ReentrantLock&lt;/h2&gt;

&lt;p&gt;é‡å…¥é”ã€‚ä¸€ä¸ªcondition. conditionçš„signalAllå”¤é†’äº†æ‰€æœ‰çš„ï¼Œä½†å…¶å®ä¸æ˜¯æ‰€æœ‰çš„éƒ½éœ€è¦å”¤é†’ï¼Œå¯ä»¥æ‹†æˆ3ä¸ªï¼Œåœ¨åç»­&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Wait_Notify_ACB&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Lock&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReentrantLock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Condition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;condition&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newCondition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetNum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetNum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++;&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;signalAll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;unlock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Wait_Notify_ACB&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wait_notify_acb&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Wait_Notify_ACB&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;wait_notify_acb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;wait_notify_acb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;wait_notify_acb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;printABC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reentrantlock--3ä¸ªcondition&quot;&gt;Reentrantlock + 3ä¸ªcondition&lt;/h2&gt;

&lt;p&gt;è¿™é‡Œæ²¡ç»´æŠ¤å˜é‡ï¼Œå› æ­¤3ä¸ªconditionæ˜¯åˆ†å¼€çš„ã€‚ä¹Ÿå¯ä»¥ç»´æŠ¤å˜é‡æ¥åˆ¤æ–­ã€‚å”¤é†’åªç”¨signalæ˜¯å› ä¸ºç­‰å¾…çš„çº¿ç¨‹ä¸ä¼šè¶…è¿‡1ä¸ªã€‚&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Lock&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReentrantLock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Condition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Condition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Condition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;pre&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;nxt&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;pre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;nxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;signal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;unlock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Condition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newCondition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Condition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newCondition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Condition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newCondition&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;signal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;unlock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;cyclicbarrier&quot;&gt;CyclicBarrier&lt;/h2&gt;

&lt;p&gt;æ¯æ¬¡åˆ°è¾¾ä¸€ä¸ªç‚¹ï¼Œå°±å¼€å§‹åˆ¤æ–­æ‰“å°å“ªä¸ªå­—æ¯ï¼Œç„¶åæ¥ç€å¾€åç§»åŠ¨ã€‚æ¨è&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;CyclicBarrier&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;barrier&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CyclicBarrier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Runnable&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;runnable&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;barrier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runnable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runnable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runnable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Option2. çº¿ç¨‹1 æœ‰3ä¸ªcyclicBarrier, çº¿ç¨‹2æœ‰ä¸¤ä¸ªï¼Œçº¿ç¨‹3æœ‰3ä¸ªã€‚&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;CyclicBarrier&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CyclicBarrier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;CyclicBarrier&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CyclicBarrier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;CyclicBarrier&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b3&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CyclicBarrier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;b1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;b2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;b3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;b2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;b3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;b3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;é˜»å¡é˜Ÿåˆ—&quot;&gt;é˜»å¡é˜Ÿåˆ—&lt;/h2&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Handler&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Runnable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;Handler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;pre&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;nxt&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;last&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;pre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;take&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nf&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;last&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;nxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;offer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SynchronousQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Handler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Handler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Handler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;ç”Ÿäº§è€…æ¶ˆè´¹è€…&quot;&gt;ç”Ÿäº§è€…æ¶ˆè´¹è€…&lt;/h1&gt;

&lt;p&gt;æ¨¡æ‹Ÿé¡¾å®¢ï¼Œå¨å¸ˆï¼ŒæœåŠ¡å‘˜ã€‚é¡¾å®¢ä¸‹å•ç»™å¨å¸ˆï¼Œå¨å¸ˆåšå¥½èœç»™æœåŠ¡å‘˜ï¼ŒæœåŠ¡å‘˜æ¥ä¸Šèœã€‚&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Person&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;customer&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Customer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Person&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Customer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;customer&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Cook&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Person&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Waiter&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Person&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Menu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Customer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;customer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foodNames&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;Menu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Customer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;customer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foodNames&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;customer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;customer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;foodNames&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foodNames&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Food&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Menu&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;Food&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Menu&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;menu&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Customer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;customers&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Cook&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cook&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Cook&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Waiter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;waiters&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;BlockingQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Menu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LinkedBlockingQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;BlockingQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Food&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foods&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LinkedBlockingQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;customers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Customer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;waiters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Waiter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Customer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;customer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;customers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Menu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;customer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;()));&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Waiter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;waiter&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;waiters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;nc&quot;&gt;Food&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;food&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;foods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;take&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                        &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;waiter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; ä¸Šèœ &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;food&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; ç»™é¡¾å®¢ &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;menu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;customer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nf&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nc&quot;&gt;Menu&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menu&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;take&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;nc&quot;&gt;Food&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;food&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Food&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;menu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cook&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; å¤„ç†é£Ÿç‰©&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;nv&quot;&gt;foods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;done&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Fulong Ma</name></author><category term="Java" /><category term="Java" /><summary type="html">å¾ªç¯æ‰“å°ABCé—®é¢˜ é¢˜ç›®:æœ‰ä¸‰ä¸ªçº¿ç¨‹åˆ†åˆ«æ‰“å°Aã€Bã€Cï¼Œè¯·ç”¨å¤šçº¿ç¨‹ç¼–ç¨‹å®ç°ï¼Œåœ¨å±å¹•æ‰“å°10æ¬¡ABC</summary></entry></feed>