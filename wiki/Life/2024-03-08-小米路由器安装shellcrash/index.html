<!DOCTYPE html><html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="wVZecs0Awis41AZhX45RBAUlyk3nnpoOkebdIemwhxQ" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /><title>小米路由器安装shellcrash和uu加速器 &mdash; Fulongのblog</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/vendor/primer-css/css/primer.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/css/components/collection.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/css/components/repo-card.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/css/sections/repo-list.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/css/components/boxed-group.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/css/globals/common.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/css/globals/responsive.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/css/posts/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mzlogin/rouge-themes@master/dist/github.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/vendor/share.js/dist/css/share.min.css"><link rel="canonical" href="https://mafulong.github.io/wiki/Life/2024-03-08-%E5%B0%8F%E7%B1%B3%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AE%89%E8%A3%85shellcrash/"><link rel="alternate" type="application/atom+xml" title="Fulongのblog" href="https://mafulong.github.io"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/favicon.ico"><meta property="og:title" content="小米路由器安装shellcrash和uu加速器"><meta name="keywords" content="logbook, mafulong"><meta name="og:keywords" content="logbook, mafulong"><meta name="description" content="小米路由器安装shellcrash"><meta name="og:description" content="小米路由器安装shellcrash"><meta property="og:url" content="https://mafulong.github.io/wiki/Life/2024-03-08-%E5%B0%8F%E7%B1%B3%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AE%89%E8%A3%85shellcrash/"><meta property="og:site_name" content="Fulongのblog"><meta property="og:type" content="article"><meta property="og:locale" content="zh_CN" /><meta property="article:published_time" content="2024-03-08"> <script src="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/js/jquery-ui.js"></script> <script src="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/js/main.js"></script></head><body class="" data-mz=""><header class="site-header"><div class="container"><h1><a href="https://mafulong.github.io/" title="Fulongのblog"><span class="octicon octicon-mark-github"></span> Fulongのblog</a></h1><button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><nav class="site-header-nav" role="navigation"> <a href="https://mafulong.github.io/" class=" site-header-nav-item" target="" title="Home">Home</a> <a href="https://mafulong.github.io/categories/" class=" site-header-nav-item" target="" title="Categories">Categories</a> <a href="https://mafulong.github.io/archives/" class=" site-header-nav-item" target="" title="Achieves">Achieves</a> <a href="https://mafulong.github.io/open-source" class=" site-header-nav-item" target="" title="Open-Source">Open-Source</a> <a href="https://mafulong.github.io/bookmark" class=" site-header-nav-item" target="" title="Bookmark">Bookmark</a> <a href="https://mafulong.github.io/about" class=" site-header-nav-item" target="" title="About">About</a></nav></div></header><section class="collection-head small geopattern" data-pattern-id="小米路由器安装shellcra"><div class="container"><div class="columns"><div class="column three-fourths"><div class="collection-title"><h1 class="collection-header">DailyLife - 小米路由器安装shellcrash和uu加速器</h1><div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="https://mafulong.github.io/wiki/" title="Wiki">Wiki</a> </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="https://mafulong.github.io/wiki/#dailylife" title="DailyLife">DailyLife</a> </span></div></div></div><div class="column one-fourth mobile-hidden"> <img style="height:72px;width:72px" src="https://fastly.jsdelivr.net/gh/mafulong/mafulong.github.io@master/assets/images/qrcode.jpg" alt="傻了吧" /></div></div></div></section><section class="container content"><div class="columns"><div class="column three-fourths" ><article class="article-content markdown-body"><h1 id="小米路由器安装shellcrash">小米路由器安装shellcrash</h1><p>路由器安装了shellcrash后就自带梯子了。然后就可以通过http://192.168.31.1:9999/ui/#/proxies 管理节点切换等。</p><ul><li><a href="https://github.com/2375399351/ShellCrash/blob/master/README_CN.md">shellcrash介绍</a></li><li><a href="http://192.168.31.1/cgi-bin/luci/web">小米路由器后台</a></li><li><a href="https://www.gaicas.com/redmi-ax6000.html">安装shellcrash参考</a></li><li><a href="https://beyondkmp.com/2023/03/05/ax6000-ssh/">参考2</a></li><li><a href="http://www1.miwifi.com/miwifi_download.html">小米最新稳定版固件</a></li></ul><p>你设备的 SSH 密码设置为<strong>admin</strong>，用户名为<strong>root</strong>，并永久开启 SSH；</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ssh</span> <span class="o">-</span><span class="n">oHostKeyAlgorithms</span><span class="o">=+</span><span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span>  <span class="n">root</span><span class="k">@</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">31.1</span>
</code></pre></div></div><h1 id="ssh解锁">ssh解锁</h1><p>当路由器开启SSH时，可以通过SSH协议连接到路由器并执行一系列的操作，包括但不限于：</p><ol><li>远程管理：可以通过SSH连接到路由器并对其进行管理，就像通过Web界面或命令行一样。</li><li>文件传输：可以通过SCP或SFTP等协议，在计算机和路由器之间传输文件。</li><li>调试和故障排除：通过SSH连接到路由器并查看系统日志、配置文件和其他信息，以帮助调试和解决问题。</li><li>安全管理：使用SSH协议进行加密连接，可以更加安全地管理路由器，防止被黑客入侵或监听。</li></ol><p>总的来说，开启SSH可以使你更加方便地管理和维护路由器，同时也可以提高安全性。需要注意的是，开启SSH也可能会增加路由器被攻击的风险，因此应该采取一些安全措施，如设置强密码、限制SSH访问等。</p><h2 id="固件降级">固件降级</h2><p>首先，登陆小米路由器的后台。依次点击<strong>常用设置</strong>-<strong>系统状态</strong>，检查路由器的系统版本</p><p>若路由器当前版本为其他版本，请先点击<strong>手动升级</strong>，并将路由器 💾 <strong><a href="https://www.icloud.com/iclouddrive/006hgOdY5pn3MJ1czZViTDPBA#redmi-ax6000-1.2.8">稳定版固件</a></strong> 上传至设备，进行手动升级/降级操作。</p><p>需要利用老版本的漏洞才能开启ssh, 所以需要手动降级。</p><p>如果显示“不允许降级”，就把网址最后面数字改成0或者2试试。</p><p>其他降级版本</p><ul><li>固件：<a href="https://beyondkmp.com/image/ax6000_ssh/miwifi_rb06_firmware_7ddeb_1.0.60.bin">Redmi AX6000 1.0.60</a></li><li>1.0.67的也可以降级的。 不要用1.2.128版本，那个没有5g wifi，固件问题。</li></ul><h2 id="获取token">获取token</h2><p>登陆小米路由器admin，浏览器地址栏<code class="language-plaintext highlighter-rouge">stok=</code>后面部分就是token, 这个token是每次登录都会变化，后面都会用到这个token。如果重新登录后，都要重新复制这个token.</p><p><img src="https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv8/v8/202403081125383.png" alt="获取token" /></p><h2 id="开启开发者模式">开启开发者模式</h2><p><strong>更改路由器的crash分区，使其进入到开发者模式</strong></p><p>将下面的URL里面的stok=token的token替换成上面获取路由器的token值，然后复制到到浏览器并且按enter打开</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">http</span><span class="o">://</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">31.1</span><span class="o">/</span><span class="n">cgi</span><span class="o">-</span><span class="n">bin</span><span class="o">/</span><span class="n">luci</span><span class="o">/;</span><span class="n">stok</span><span class="k">=</span><span class="n">token</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">misystem</span><span class="o">/</span><span class="n">set_sys_time</span><span class="o">?</span><span class="n">timezone</span><span class="o">=%</span><span class="mi">20</span><span class="o">%</span><span class="mi">27</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">B</span><span class="o">%</span><span class="mi">20</span><span class="n">zz</span><span class="o">%</span><span class="mf">3D</span><span class="o">%</span><span class="mi">24</span><span class="o">%</span><span class="mf">28d</span><span class="n">d</span><span class="o">%</span><span class="mi">20</span><span class="k">if</span><span class="o">%</span><span class="mf">3D</span><span class="o">%</span><span class="mf">2F</span><span class="n">dev</span><span class="o">%</span><span class="mf">2F</span><span class="n">zero</span><span class="o">%</span><span class="mi">20</span><span class="n">bs</span><span class="o">%</span><span class="mf">3D</span><span class="mi">1</span><span class="o">%</span><span class="mi">20</span><span class="n">count</span><span class="o">%</span><span class="mf">3D</span><span class="mi">2</span><span class="o">%</span><span class="mi">202</span><span class="o">%</span><span class="mi">3</span><span class="n">E</span><span class="o">%</span><span class="mf">2F</span><span class="n">dev</span><span class="o">%</span><span class="mf">2F</span><span class="kc">null</span><span class="o">%</span><span class="mi">29</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">B</span><span class="o">%</span><span class="mi">20</span><span class="n">printf</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">27</span><span class="o">%</span><span class="n">A5</span><span class="o">%</span><span class="mi">5</span><span class="n">A</span><span class="o">%</span><span class="mi">25</span><span class="n">c</span><span class="o">%</span><span class="mi">25</span><span class="n">c</span><span class="o">%</span><span class="mi">27</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">24</span><span class="n">zz</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">24</span><span class="n">zz</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">7</span><span class="n">C</span><span class="o">%</span><span class="mi">20</span><span class="n">mtd</span><span class="o">%</span><span class="mi">20</span><span class="n">write</span><span class="o">%</span><span class="mi">20</span><span class="o">-%</span><span class="mi">20</span><span class="n">crash</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">B</span><span class="o">%</span><span class="mi">20</span>
</code></pre></div></div><p>浏览器返回{“code”:0}，表示成功。</p><p><strong>通过浏览器重启路由器</strong></p><p>在浏览器地址栏输入下面的url, 和上面的做法一样，将stok=token的token替换成上面获取路由器的token值</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">http</span><span class="o">://</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">31.1</span><span class="o">/</span><span class="n">cgi</span><span class="o">-</span><span class="n">bin</span><span class="o">/</span><span class="n">luci</span><span class="o">/;</span><span class="n">stok</span><span class="k">=</span><span class="n">token</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">misystem</span><span class="o">/</span><span class="n">set_sys_time</span><span class="o">?</span><span class="n">timezone</span><span class="o">=%</span><span class="mi">20</span><span class="o">%</span><span class="mi">27</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">b</span><span class="o">%</span><span class="mi">20</span><span class="n">reboot</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">b</span><span class="o">%</span><span class="mi">20</span>
</code></pre></div></div><h2 id="设置bdata参数">设置Bdata参数</h2><p><strong>设置参数telnet_en、 ssh_en、uart_en</strong></p><p>重启后，要重新获取token, 然后在浏览器地址栏输入下面的url, 将stok=token的token替换成上面获取路由器的token值</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">http</span><span class="o">://</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">31.1</span><span class="o">/</span><span class="n">cgi</span><span class="o">-</span><span class="n">bin</span><span class="o">/</span><span class="n">luci</span><span class="o">/;</span><span class="n">stok</span><span class="k">=</span><span class="n">token</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">misystem</span><span class="o">/</span><span class="n">set_sys_time</span><span class="o">?</span><span class="n">timezone</span><span class="o">=%</span><span class="mi">20</span><span class="o">%</span><span class="mi">27</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">B</span><span class="o">%</span><span class="mi">20</span><span class="n">bdata</span><span class="o">%</span><span class="mi">20</span><span class="n">set</span><span class="o">%</span><span class="mi">20</span><span class="n">telnet_en</span><span class="o">%</span><span class="mf">3D</span><span class="mi">1</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">B</span><span class="o">%</span><span class="mi">20</span><span class="n">bdata</span><span class="o">%</span><span class="mi">20</span><span class="n">set</span><span class="o">%</span><span class="mi">20</span><span class="n">ssh_en</span><span class="o">%</span><span class="mf">3D</span><span class="mi">1</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">B</span><span class="o">%</span><span class="mi">20</span><span class="n">bdata</span><span class="o">%</span><span class="mi">20</span><span class="n">set</span><span class="o">%</span><span class="mi">20</span><span class="n">uart_en</span><span class="o">%</span><span class="mf">3D</span><span class="mi">1</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">B</span><span class="o">%</span><span class="mi">20</span><span class="n">bdata</span><span class="o">%</span><span class="mi">20</span><span class="n">commit</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">B</span><span class="o">%</span><span class="mi">20</span>
</code></pre></div></div><p><strong>重启路由器</strong></p><p>在浏览器地址栏输入下面的url, 和上面的做法一样，将stok=token的token替换成上面获取路由器的token值</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">http</span><span class="o">://</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">31.1</span><span class="o">/</span><span class="n">cgi</span><span class="o">-</span><span class="n">bin</span><span class="o">/</span><span class="n">luci</span><span class="o">/;</span><span class="n">stok</span><span class="k">=</span><span class="n">token</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">misystem</span><span class="o">/</span><span class="n">set_sys_time</span><span class="o">?</span><span class="n">timezone</span><span class="o">=%</span><span class="mi">20</span><span class="o">%</span>
</code></pre></div></div><h2 id="通过telnet开启ssh">通过telnet开启ssh</h2><p>在终端输入<code class="language-plaintext highlighter-rouge">telnet 192.168.31.1</code>, 可以看到Are you ok的界面，就证明telnet成功了。</p><h2 id="永久开启并固化-ssh">永久开启并固化 ssh</h2><p>Telnet 登录成功后，将代码复制粘贴并运行。</p><p>这将会为你设备的 SSH 密码设置为<strong>admin</strong>，用户名为<strong>root</strong>，并永久开启 SSH；</p><p>这一步还会将您的设备从开发模式切换成常规模式，<strong>待最后一个命令reboot即设备重启完成后</strong>，你就可以使用该用户名密码连接设备的 SSH 了。</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nt">-e</span> <span class="s1">'admin\nadmin'</span> | passwd root
nvram <span class="nb">set </span><span class="nv">ssh_en</span><span class="o">=</span>1
nvram <span class="nb">set </span><span class="nv">telnet_en</span><span class="o">=</span>1
nvram <span class="nb">set </span><span class="nv">uart_en</span><span class="o">=</span>1
nvram <span class="nb">set </span><span class="nv">boot_wait</span><span class="o">=</span>on
nvram commit
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/channel=.*/channel="debug"/g'</span> /etc/init.d/dropbear
/etc/init.d/dropbear restart
<span class="nb">mkdir</span> /data/auto_ssh
<span class="nb">cd</span> /data/auto_ssh
curl <span class="nt">-O</span> https://fastly.jsdelivr.net/gh/lemoeo/AX6S@main/auto_ssh.sh
<span class="nb">chmod</span> +x auto_ssh.sh
uci <span class="nb">set </span>firewall.auto_ssh<span class="o">=</span>include
uci <span class="nb">set </span>firewall.auto_ssh.type<span class="o">=</span><span class="s1">'script'</span>
uci <span class="nb">set </span>firewall.auto_ssh.path<span class="o">=</span><span class="s1">'/data/auto_ssh/auto_ssh.sh'</span>
uci <span class="nb">set </span>firewall.auto_ssh.enabled<span class="o">=</span><span class="s1">'1'</span>
uci commit firewall
uci <span class="nb">set </span>system.@system[0].timezone<span class="o">=</span><span class="s1">'CST-8'</span>
uci <span class="nb">set </span>system.@system[0].webtimezone<span class="o">=</span><span class="s1">'CST-8'</span>
uci <span class="nb">set </span>system.@system[0].timezoneindex<span class="o">=</span><span class="s1">'2.84'</span>
uci commit
mtd erase crash
reboot

</code></pre></div></div><h2 id="ssh-登录">ssh 登录</h2><p>你设备的 SSH 密码设置为<strong>admin</strong>，用户名为<strong>root</strong>，并永久开启 SSH；</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ssh</span> <span class="o">-</span><span class="n">oHostKeyAlgorithms</span><span class="o">=+</span><span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span>  <span class="n">root</span><span class="k">@</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">31.1</span>
</code></pre></div></div><h1 id="shellcrash安装">shellcrash安装</h1><p>ssh后，在路由器主机里。运行如下代码，如不行，可尝试其它方式见shellcrash主页</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">export</span> <span class="n">url</span><span class="o">='</span><span class="n">https</span><span class="o">://</span><span class="nv">fastly</span><span class="o">.</span><span class="py">jsdelivr</span><span class="o">.</span><span class="py">net</span><span class="o">/</span><span class="n">gh</span><span class="o">/</span><span class="n">juewuy</span><span class="o">/</span><span class="nc">ShellClash</span><span class="nd">@master</span><span class="o">'</span> <span class="o">&amp;&amp;</span> <span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="s">"$(curl -kfsSl $url/install.sh)"</span> <span class="o">&amp;&amp;</span> <span class="n">source</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span> <span class="o">&amp;&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="kc">null</span>

</code></pre></div></div><ul><li><p>安装推荐的公测版。</p></li><li><p>安装后运行clash/crash打开软件。</p></li><li><p>路由器安装在/data目录下，另一个可选项是/usrdisk</p></li><li><p>选择 “路由设备配置局域网透明代理”</p></li><li><p>安装yard面板</p></li><li><p>若你的订阅链接为 SS/SSR/VMESS 格式，可以点击下面链接，进行订阅链接转换。<a href="https://acl4ssr-sub.github.io/">订阅链接转换</a>。 最好直接用clash的订阅链接。</p></li><li><p>如果订阅链接的文件下不下来，就vim创建编辑个yaml文件在tmp目录下，然后手动复制进去。或者curl下载订阅链接的文件放到/tmp下，然后/tmp运行crash, 自动检测导入。推荐用后者。clash打开后会自动识别当前目录的yaml文件，进而使用这个配置文件。</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">curl</span> <span class="o">-</span><span class="n">o</span> <span class="nv">a</span><span class="o">.</span><span class="py">yaml</span> <span class="s">"clash订阅链接"</span>
  
</code></pre></div></div></li><li><p>CLASH面板管理地址：<strong>http://192.168.31.1:9999/ui</strong></p></li><li><p>crash启动服务，会自动下载clash核心。</p></li></ul><h1 id="uu加速器安装">uu加速器安装</h1><p>可以在shellcrash安装后再进行，不冲突。</p><h2 id="步骤">步骤</h2><p><a href="https://www.right.com.cn/forum/thread-8276125-1-1.html">参考1</a></p><p>dist源备份。 /etc/opkg/distfeeds.conf</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">src</span><span class="o">/</span><span class="n">gz</span> <span class="n">openwrt_core</span> <span class="n">http</span><span class="o">://</span><span class="nv">downloads</span><span class="o">.</span><span class="py">openwrt</span><span class="o">.</span><span class="py">org</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="mf">18.06</span><span class="o">-</span><span class="nc">SNAPSHOT</span><span class="o">/</span><span class="n">targets</span><span class="o">/</span><span class="n">mediatek</span><span class="o">/</span><span class="n">mt7986</span><span class="o">/</span><span class="n">packages</span>
<span class="n">src</span><span class="o">/</span><span class="n">gz</span> <span class="n">openwrt_base</span> <span class="n">http</span><span class="o">://</span><span class="nv">downloads</span><span class="o">.</span><span class="py">openwrt</span><span class="o">.</span><span class="py">org</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="mf">18.06</span><span class="o">-</span><span class="nc">SNAPSHOT</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">aarch64_cortex</span><span class="o">-</span><span class="n">a53</span><span class="o">/</span><span class="n">base</span>
</code></pre></div></div><h2 id="挂载overlay使用opkg安装openwrt软件包"><strong>挂载overlay使用opkg安装openwrt软件包</strong></h2><p>https://www.right.com.cn/forum/thread-8274490-1-4.html</p><p>在SSH脚本/data/auto_ssh/auto_ssh.sh最后一行添加如下内容：</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">#</span><span class="nc">Mount</span> <span class="n">overlay</span>
<span class="o">[</span> <span class="kt">-e</span> <span class="kt">/data/overlay</span> <span class="o">]</span> <span class="o">||</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">overlay</span>
<span class="o">[</span> <span class="kt">-e</span> <span class="kt">/data/overlay/upper</span> <span class="o">]</span> <span class="o">||</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">overlay</span><span class="o">/</span><span class="n">upper</span>
<span class="o">[</span> <span class="kt">-e</span> <span class="kt">/data/overlay/work</span> <span class="o">]</span> <span class="o">||</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">overlay</span><span class="o">/</span><span class="n">work</span>
<span class="n">mount</span> <span class="o">--</span><span class="n">bind</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">overlay</span> <span class="o">/</span><span class="n">overlay</span>
<span class="o">.</span> <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">functions</span><span class="o">/</span><span class="nv">preinit</span><span class="o">.</span><span class="py">sh</span>
<span class="n">fopivot</span> <span class="o">/</span><span class="n">overlay</span><span class="o">/</span><span class="n">upper</span> <span class="o">/</span><span class="n">overlay</span><span class="o">/</span><span class="n">work</span> <span class="o">/</span><span class="n">rom</span> <span class="mi">1</span>

<span class="k">#</span><span class="nc">Fixup</span> <span class="n">miwifi</span> <span class="n">misc</span><span class="o">,</span> <span class="n">and</span> <span class="nc">DO</span> <span class="nc">NOT</span> <span class="n">use</span> <span class="o">/</span><span class="n">overlay</span><span class="o">/</span><span class="n">upper</span><span class="o">/</span><span class="n">etc</span> <span class="n">instead</span><span class="o">,</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">uci</span><span class="o">-</span><span class="n">defaults</span><span class="cm">/* may be already removed
/bin/mount -o noatime,move /rom/data /data 2&gt;&amp;-
/bin/mount -o noatime,move /rom/etc /etc 2&gt;&amp;-
/bin/mount -o noatime,move /rom/ini /ini 2&gt;&amp;-
/bin/mount -o noatime,move /rom/userdisk /userdisk 2&gt;&amp;-


</span></code></pre></div></div><p>编辑/etc/opkg/distfeeds.conf，替换为下列内容：</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">src</span><span class="o">/</span><span class="n">gz</span> <span class="n">openwrt_base</span> <span class="n">http</span><span class="o">://</span><span class="nv">downloads</span><span class="o">.</span><span class="py">openwrt</span><span class="o">.</span><span class="py">org</span><span class="o">/</span><span class="n">snapshots</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">aarch64_cortex</span><span class="o">-</span><span class="n">a53</span><span class="o">/</span><span class="n">base</span>
<span class="n">src</span><span class="o">/</span><span class="n">gz</span> <span class="n">openwrt_luci</span> <span class="n">http</span><span class="o">://</span><span class="nv">downloads</span><span class="o">.</span><span class="py">openwrt</span><span class="o">.</span><span class="py">org</span><span class="o">/</span><span class="n">snapshots</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">aarch64_cortex</span><span class="o">-</span><span class="n">a53</span><span class="o">/</span><span class="n">luci</span>
<span class="n">src</span><span class="o">/</span><span class="n">gz</span> <span class="n">openwrt_packages</span> <span class="n">http</span><span class="o">://</span><span class="nv">downloads</span><span class="o">.</span><span class="py">openwrt</span><span class="o">.</span><span class="py">org</span><span class="o">/</span><span class="n">snapshots</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">aarch64_cortex</span><span class="o">-</span><span class="n">a53</span><span class="o">/</span><span class="n">packages</span>
<span class="n">src</span><span class="o">/</span><span class="n">gz</span> <span class="n">openwrt_routing</span> <span class="n">http</span><span class="o">://</span><span class="nv">downloads</span><span class="o">.</span><span class="py">openwrt</span><span class="o">.</span><span class="py">org</span><span class="o">/</span><span class="n">snapshots</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">aarch64_cortex</span><span class="o">-</span><span class="n">a53</span><span class="o">/</span><span class="n">routing</span>
</code></pre></div></div><p>然后更新软件包列表</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">opkg</span> <span class="n">update</span>
</code></pre></div></div><p>添加挂载脚本后重启路由器，opkg就可以正常使用了。</p><p>重启</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">reboot</span>
</code></pre></div></div><h2 id="安装uu"><strong>安装UU</strong></h2><p><strong>SSH连接后，按顺序输入</strong> wget http://uu.gdl.netease.com/uuplugin-script/202012111056/install.sh -O install.sh /bin/sh install.sh openwrt $(uname -m)</p><h2 id="设定开机自启"><strong>设定开机自启</strong></h2><p><strong>先给执行权限，一定要给不然不能启动脚本</strong> 键入</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">uu</span><span class="o">/</span><span class="nv">uuplugin_monitor</span><span class="o">.</span><span class="py">sh</span>
</code></pre></div></div><p>然后在/data/auto_ssh/auto_ssh.sh最后一行添加如下内容：</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sleep</span> <span class="mi">50</span> <span class="o">&amp;&amp;</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">uu</span><span class="o">/</span><span class="nv">uuplugin_monitor</span><span class="o">.</span><span class="py">sh</span> <span class="o">&amp;</span>
</code></pre></div></div><p><strong>这一步sleep是让系统组件加载完成后再启动UU，否则可能连不上网。</strong></p><p><strong>完成后就可以用UU主机加速app绑定了，如果不放心可以多重启几次试一下开机自启是否正常使用。</strong></p><p><strong>重启连ssh，输ps看看有没有uu或者sleep 50，有就是可以了。</strong></p><h1 id="工具">工具</h1><h2 id="路由器文件上传和下载">路由器文件上传和下载</h2><p>文件传输：可以通过SCP或SFTP等协议，在计算机和路由器之间传输文件。scp 是 ssh copy 的缩写。</p><p>上传文件到指定目录：</p><blockquote><p>scp myfile.tar.gz root@192.168.1.1:/tmp/temp</p></blockquote><p>下载文件到指定目录：</p><blockquote><p>scp root@192.168.1.1:/tmp/file.tar.gz ./</p></blockquote><p>把这个文件拷贝进路由器，格式<code class="language-plaintext highlighter-rouge"> scp &lt;local file&gt; &lt;remote user&gt;@&lt;remote machine&gt;:&lt;/usr/lib/lua/luci/controller/admin/&gt;</code></p><p>我路由后台管理地址192.168.3.1为例设置 <code class="language-plaintext highlighter-rouge">scp /Users/jesse/Desktop/xqsystem.lua root@192.168.3.1:/usr/lib/lua/luci/controller/admin/</code></p><p>测试文件传输效果，直接在路由器ip后面加 /cgi-bin/luci/api/xqsystem/token 如果文件传进去了会这样显示则代表成功。 <strong>试了会404，还是scp吧</strong></p><p><img src="https://cdn.jsdelivr.net/gh/mafulong/mdPic@vv8/v8/202403081148181.jpg" alt="顺序可能不同，大概内容相似就行" /></p><p>大文件上传下载： https://taoshu.in/transfer-big-file.html</p><div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scp</span> <span class="o">-</span><span class="n">oHostKeyAlgorithms</span><span class="o">=+</span><span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span> <span class="n">root</span><span class="k">@</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">31.1</span><span class="o">:/</span><span class="n">data</span><span class="o">/</span><span class="n">auto_ssh</span><span class="o">/</span><span class="nv">auto_ssh</span><span class="o">.</span><span class="py">sh</span> <span class="o">./</span>
</code></pre></div></div><h2 id="auto-ssh">auto ssh</h2><p>https://fastly.jsdelivr.net/gh/lemoeo/AX6S@main/auto_ssh.sh</p><div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"><h3>文档信息</h3><ul><li>本文作者：<a href="https://mafulong.github.io" target="_blank">Fulong Ma</a></li><li>本文链接：<a href="https://mafulong.github.io/wiki/Life/2024-03-08-%E5%B0%8F%E7%B1%B3%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AE%89%E8%A3%85shellcrash/" target="_blank">https://mafulong.github.io/wiki/Life/2024-03-08-%E5%B0%8F%E7%B1%B3%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AE%89%E8%A3%85shellcrash/</a></li><li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">创意共享3.0许可证</a>）</li></ul></div></article><div class="share"><div class="share-component"></div></div><div class="comment"></div></div><div class="column one-fourth"><h3>Search</h3><div id="site_search"> <input style="width: 96%" type="text" id="search_box" placeholder="Search" /></div><ul id="search_results" style=" font-size: 14px; list-style-type: none; padding-top: 10px; padding-left: 10px; " ></ul><script src="https://fastly.jsdelivr.net/gh/mafulong/mafulong.github.io@master/assets/js/simple-jekyll-search.min.js"></script> <script type="text/javascript"> SimpleJekyllSearch({ searchInput: document.getElementById('search_box'), resultsContainer: document.getElementById('search_results'), json: 'https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/search_data.json', searchResultTemplate: '<li><a href="{url}" title="{title}">{title}</a></li>', noResultsText: 'No results found', limit: 20, fuzzy: false, exclude: ['Welcome'] }); window.onload = function(){ var query_text = window.location.search.substring(1); var vars = query_text.split("&"); for (var i=0;i<vars.length;i++) { var pair = vars[i].split("="); if(pair[0] == "search_text"){ var query = pair[1]; query = decodeURI(query); var search = document.getElementById('search_box'); search.value = query; var event = new InputEvent('keyup'); search.dispatchEvent(event); break } } } </script><h3 class="post-directory-title">Table of Contents</h3><div id="post-directory-module"><section class="post-directory"><dl></dl></section></div><script src="https://fastly.jsdelivr.net/gh/mafulong/mafulong.github.io@master/assets/js/jquery.toc.js"></script></div></div></section><footer class="container"><div class="site-footer" role="contentinfo"><div class="copyright left mobile-block"> © 2015 <span title="Fulong Ma">Fulong Ma</span> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a></div><ul class="site-footer-links right mobile-hidden"><li> <a href="https://www.privacypolicygenerator.info/live.php?token=cnfKULv1VpqenfUs021YVA90fPiK75Cw">Privacy Policy</a></li><li> <a href="https://www.termsfeed.com/live/9dccd944-1b18-436d-bd12-3dd799b1282a">Terms </a></li><li> <a href="javascript:window.scrollTo(0,0)">TOP</a></li></ul><a href="https://github.com/mafulong/mafulong.github.io" target="_blank" aria-label="view source code"> <span class="mega-octicon octicon-mark-github" title="GitHub"></span> </a><ul class="site-footer-links mobile-hidden"><li> <a href="https://mafulong.github.io/" title="Home" target="">Home</a></li><li> <a href="https://mafulong.github.io/categories/" title="Categories" target="">Categories</a></li><li> <a href="https://mafulong.github.io/archives/" title="Achieves" target="">Achieves</a></li><li> <a href="https://mafulong.github.io/open-source" title="Open-Source" target="">Open-Source</a></li><li> <a href="https://mafulong.github.io/bookmark" title="Bookmark" target="">Bookmark</a></li><li> <a href="https://mafulong.github.io/about" title="About" target="">About</a></li></ul><script async src="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/vendor/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="mobile-hidden" style="margin-top:8px"> <span id="busuanzi_container_site_pv" style="display:none"> 本站访问量<span id="busuanzi_value_site_pv"></span>次 </span> <span id="busuanzi_container_site_uv" style="display:none"> / 本站访客数<span id="busuanzi_value_site_uv"></span>人 </span></div></div></footer><div class="tools-wrapper"> <a class="gotop" href="#" title="回到顶部"><span class="octicon octicon-arrow-up"></span></a></div><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script> <script> $(document).ready(function() { $("td img").each(function() { var strA = "<a href='" + this.src + "' itemscope=\"\" itemtype=\"http://schema.org/ImageObject\" itemprop=\"url\" data-fancybox=\"default\" rel=\"default\"></a>"; $(this).wrapAll(strA); }); $("p img").each(function() { var strA = "<a href='" + this.src + "' itemscope=\"\" itemtype=\"http://schema.org/ImageObject\" itemprop=\"url\" data-fancybox=\"default\" rel=\"default\"></a>"; $(this).wrapAll(strA); }); }); </script> <script src="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/vendor/share.js/dist/js/share.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/mafulong/mafulong.github.io@built/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function ($) { $('.geopattern').each(function () { $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script><div style="display:none"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-SS4VDLWLNC"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() {dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-SS4VDLWLNC'); </script></div></body></html>
