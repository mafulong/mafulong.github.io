---
layout: post
category: Algorithms
title: 倍增法
tags: Algorithms
---

## 倍增法

> [oi wiki](https://oi-wiki.org/basic/binary-lifting/)

倍增法（英语：binary lifting），顾名思义就是翻倍。它能够使线性的处理转化为对数级的处理，大大地优化时间复杂度。

这个方法在很多算法中均有应用，其中最常用的是 RMQ 问题和求 [LCA（最近公共祖先）](https://oi-wiki.org/graph/lca/) 。



ST(Sparse Table)表，中文名稀疏表，是一种数据结构。

ST表常用于解决**可重复贡献问题**。其实就是倍增法的cache版本。

什么是可重复贡献问题？

**常见的可重复贡献问题有：**区间最值、区间按位和、区间按位或、区间GCD等。二而像区间和这样的问题就不是可重复贡献问题。

## 模板 树上倍增算法（以及最近公共祖先）



## 使用ST表处理问题

需要对区间最值ST表略作修改即可。

比如区间按位与，则只需修改以下代码：

```cpp
f[i][j]=f[i][j-1]&f[i+(1<<(j-1))][j-1];//倍增的处理
ans=f[l][lg]&f[r-(1<<lg)+1][lg];//区间重叠运算
```

再比如区间GCD：

```cpp
f[i][j]=gcd(f[i][j-1],f[i+(1<<(j-1))][j-1]);//倍增的处理
ans=gcd(f[l][lg],f[r-(1<<lg)+1][lg]);//区间重叠运算
```

值得一提的是，处理区间GCD时，ST表与线段树的时间复杂度基本相近，但前者却显然要好写得多。

ST表的缺点在于其只能处理可重复贡献问题，以及其不支持区间修改罢了。



