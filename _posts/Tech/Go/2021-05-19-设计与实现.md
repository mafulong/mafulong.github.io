---
layout: post
category: Go
title: Go设计与实现
tags: Go
---

## 设计与实现

## 基础知识

### 切片

```
make([]int64, 0, 10) // cap10, len0
make([]int64, 10) // cap10, len 10, 少用
```

结构:

```go
type SliceHeader struct {
	Data uintptr
	Len  int
	Cap  int
}
```

扩容策略

- cap<1024，每次*2
- cap>1024，每次*1.25
- 然后会字节对齐。
- 如果没发生扩容，修改在原来内存，
- 发生了扩容，修改在新内存，尤其注意当slice作为函数参会后，函数内部发生扩容并不会影响之前的了。

### map

[直接看另一篇文档](https://mafulong.top/2019/09/11/golang%E7%9A%84map%E7%9A%84%E5%AE%9E%E7%8E%B0/)

- map存的是指针，不可以取址，扩容时会发生变化。
- 不会缩容。

### String

```go
type StringHeader struct {
	Data uintptr
	Len  int
}
```

- string不能修改
- `+`号拼接不再具有优势，因为`string`是不可变的，每次拼接都会生成一个新的`string`,也就是会进行一次内存分配

### 接口

接口也是 Go 语言中的一种类型，它能够出现在变量的定义、函数的入参和返回值中并对它们进行约束，不过 Go 语言中有两种略微不同的接口，一种是带有一组方法的接口，另一种是不带任何方法的 `interface{}`：

![golang-different-interface](https://img.draveness.me/golang-different-interface.png)

需要注意的是，与 C 语言中的 `void *` 不同，`interface{}` 类型**不是任意类型**。如果我们将类型转换成了 `interface{}` 类型，变量在运行期间的类型也会发生变化，获取变量类型时会得到 `interface{}`。

